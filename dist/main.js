/*! For license information please see main.js.LICENSE.txt */
(()=>{var e,t,r,i,n,o,s={3093:(e,t,r)=>{"use strict";r.a(e,(async(e,i)=>{try{function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function u(){u=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof l?t:l,s=Object.create(o.prototype),a=new E(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var v={};function l(){}function f(){}function g(){}var m={};c(m,o,(function(){return this}));var y=Object.getPrototypeOf,S=y&&y(y(A([])));S&&S!==t&&r.call(S,o)&&(m=S);var C=g.prototype=l.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,o,s,a){var c=d(e[i],e,o);if("throw"!==c.type){var p=c.arg,u=p.value;return u&&"object"==h(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===v)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=d(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var n=d(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=g,i(C,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:f,configurable:!0}),f.displayName=c(g,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},w(R.prototype),c(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new R(p(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(C),c(C,a,"Generator"),c(C,o,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),v}},e}function d(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(e){d(o,i,n,s,a,"next",e)}function a(e){d(o,i,n,s,a,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,"symbol"===h(n=g(i.key,"string"))?n:String(n)),i)}var n}function g(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==h(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}function y(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){var t="function"==typeof Map?new Map:void 0;return C=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return w(e,arguments,I(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),P(i,e)},C(e)}function w(e,t,r){return w=R()?Reflect.construct.bind():function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&P(n,r.prototype),n},w.apply(null,arguments)}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}r.d(t,{Z:()=>b});var n=await r.e(537).then(r.bind(r,7537)),o=await n.default,s=(new DOMParser).parseFromString(o,"text/html").querySelector("body").innerHTML,a=document.createElement("template");a.innerHTML=s;var c=a.content,p=function(e){m(s,e);var t,r,i,n,o=(t=s,r=R(),function(){var e,i=I(t);if(r){var n=I(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return y(this,e)});function s(e,t,r){var i;function n(e){return a.apply(this,arguments)}function a(){return(a=v(u().mark((function e(t){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new File([t],"temp.wav"),e.next=3,r.recognize(i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return l(this,s),(i=o.call(this)).root=i.attachShadow({mode:"open"}),i.root.appendChild(c.cloneNode(!0)),i.audio=i.root.querySelector("audio"),i.button=i.root.querySelector("button"),i.p=i.root.querySelector("p"),e&&(i.src=e),t&&(i.script=t),i.getAttribute("src")&&(i.src=i.getAttribute("src")),i.getAttribute("script")&&(i.script=i.getAttribute("script")),i.button.dataset.open="false",i.button.dataset.lock="false",i.button.onclick=v(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("true"!=i.button.dataset.lock){e.next=2;break}return e.abrupt("return");case 2:if("true"!=i.button.dataset.open){e.next=7;break}i.p.classList.remove("open"),i.button.dataset.open="false",e.next=21;break;case 7:if(i.button.dataset.lock="true",i.p.textContent){e.next=18;break}return e.next=11,fetch(i.src);case 11:return t=e.sent,e.next=14,t.blob();case 14:return r=e.sent,e.next=17,n(r);case 17:i.p.textContent=e.sent;case 18:i.button.dataset.lock="false",i.p.classList.add("open"),i.button.dataset.open="true";case 21:case"end":return e.stop()}}),e)}))),i}return i=s,(n=[{key:"src",get:function(){return this.audio.src},set:function(e){this.audio.src=e}},{key:"script",get:function(){return this.p.textContent},set:function(e){this.p.textContent=e}}])&&f(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),s}(C(HTMLElement));customElements.define("audio-post",p);const b=p;i()}catch(T){i(T)}}),1)},1045:(e,t,r)=>{"use strict";r.a(e,(async(e,t)=>{try{var i=r(6190),n=r(9681),o=r(5655),s=r(3093),a=r(2175),c=r(7927),p=e([s]);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function S(){S=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),a=new E(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var u={};function d(){}function v(){}function l(){}var f={};c(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(A([])));m&&m!==t&&r.call(m,o)&&(f=m);var C=l.prototype=d.prototype=Object.create(f);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var p=c.arg,u=p.value;return u&&"object"==y(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=h(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=h(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return v.prototype=l,i(C,"constructor",{value:l,configurable:!0}),i(l,"constructor",{value:v,configurable:!0}),v.displayName=c(l,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},w(R.prototype),c(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new R(p(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(C),c(C,a,"Generator"),c(C,o,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function C(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function w(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(e){C(o,i,n,s,a,"next",e)}function a(e){C(o,i,n,s,a,"throw",e)}s(void 0)}))}}s=(p.then?(await p)():p)[0];var h=new c.Z;function R(e){var t=URL.createObjectURL(e.blob),r=document.querySelector("main ul"),i=document.createElement("li"),n=new s.Z(t,e.script,h);i.appendChild(n),r.appendChild(i)}function P(){return I.apply(this,arguments)}function I(){return(I=w(S().mark((function e(){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new a.Z,e.next=3,t.connect();case 3:return e.next=5,t.list();case 5:e.sent.forEach(R);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return T.apply(this,arguments)}function T(){return(T=w(S().mark((function e(t){var r,i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={blob:t,script:null},i=new a.Z,e.next=4,i.connect();case 4:return e.next=6,i.save(r);case 6:R(r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){var t=new window.MediaRecorder(e),r=[],s=!1;t.ondataavailable=function(e){e.data.size>0&&r.push(e.data)},t.onstop=w(S().mark((function e(){var t;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.getWaveBlob)(new Blob(r));case 2:t=e.sent,r=[],b(t);case 5:case"end":return e.stop()}}),e)})));var a=document.querySelector("button#record");new o.Z(a,(function(){switch(c.state){case"init":c.toTrans();break;case"rec":break;default:alert("error")}}),(function(){switch(c.state){case"trans":c.toShot();break;case"rec":break;default:alert("error")}}),(function(){switch(c.state){case"trans":c.toRec();break;case"rec":case"shot":c.toInit();break;default:alert("error")}}));var c=new n.Z((function(){return!s&&(s=!0,a.classList.add("on"),t.start(),!0)}),(function(){return!!s&&(s=!1,t.stop(),a.classList.remove("on"),!0)}))}navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(E);var u=document.querySelector("section#speech_account"),d=document.querySelectorAll(".speech_signup"),v=document.querySelectorAll(".speech_login"),l=document.querySelector("#login"),f=document.querySelector("#logout"),g=document.querySelector("#register"),m=document.querySelector("form");h.loggedin()||(u.classList.add("open"),h.exists()?v.forEach((function(e){return e.classList.add("open")})):d.forEach((function(e){return e.classList.add("open")}))),m.onsubmit=function(e){return e.preventDefault()},l.onclick=function(e){var t=new FormData(m).get("speech_passwd");h.login(t)?(v.forEach((function(e){return e.classList.remove("open")})),u.classList.remove("open")):alert("Failed to login.")},g.onclick=function(e){var t=new FormData(m),r=t.get("speech_key"),i=t.get("speech_region"),n=t.get("speech_passwd");h.signup(r,i,n),u.classList.remove("open")},f.onclick=function(e){h.logout(),v.forEach((function(e){return e.classList.remove("open")})),d.forEach((function(e){return e.classList.add("open")}))},P(),t()}catch(A){t(A)}}))},8125:(e,t,r)=>{"use strict";const i=r(72);class n extends Error{constructor(e,...t){let r;super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e),Object.defineProperty(this,"responseBody",{get:()=>(r||(r=this.arrayBuffer()),r)}),this.headers={};for(const[t,r]of e.headers.entries())this.headers[t.toLowerCase()]=r}}e.exports=i(((e,t,r,i,o)=>async(s,a,c={})=>{s=o+(s||"");let p=new URL(s);if(i||(i={}),p.username&&(i.Authorization="Basic "+btoa(p.username+":"+p.password),p=new URL(p.protocol+"//"+p.host+p.pathname+p.search)),"https:"!==p.protocol&&"http:"!==p.protocol)throw new Error(`Unknown protocol, ${p.protocol}`);if(a)if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||"string"==typeof a);else{if("object"!=typeof a)throw new Error("Unknown body type.");a=JSON.stringify(a),i["Content-Type"]="application/json"}c=new Headers({...i||{},...c});const h=await fetch(p,{method:t,headers:c,body:a});if(h.statusCode=h.status,!e.has(h.status))throw new n(h);return"json"===r?h.json():"buffer"===r?h.arrayBuffer():"string"===r?h.text():h}))},72:e=>{"use strict";const t=new Set(["json","buffer","string"]);e.exports=e=>(...r)=>{const i=new Set;let n,o,s,a="";return r.forEach((e=>{if("string"==typeof e)if(e.toUpperCase()===e){if(n)throw new Error(`Can't set method to ${e}, already set to ${n}.`);n=e}else if(e.startsWith("http:")||e.startsWith("https:"))a=e;else{if(!t.has(e))throw new Error(`Unknown encoding, ${e}`);o=e}else if("number"==typeof e)i.add(e);else{if("object"!=typeof e)throw new Error("Unknown type: "+typeof e);if(Array.isArray(e)||e instanceof Set)e.forEach((e=>i.add(e)));else{if(s)throw new Error("Cannot set headers twice.");s=e}}})),n||(n="GET"),0===i.size&&i.add(200),e(i,n,o,s,a)}},3192:function(e,t,r){var i;e.exports=(i=r(2751),r(20),r(4716),r(6147),r(1575),function(){var e=i,t=e.lib.BlockCipher,r=e.algo,n=[],o=[],s=[],a=[],c=[],p=[],h=[],u=[],d=[],v=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,i=0;for(t=0;t<256;t++){var l=i^i<<1^i<<2^i<<3^i<<4;l=l>>>8^255&l^99,n[r]=l,o[l]=r;var f=e[r],g=e[f],m=e[g],y=257*e[l]^16843008*l;s[r]=y<<24|y>>>8,a[r]=y<<16|y>>>16,c[r]=y<<8|y>>>24,p[r]=y,y=16843009*m^65537*g^257*f^16843008*r,h[l]=y<<24|y>>>8,u[l]=y<<16|y>>>16,d[l]=y<<8|y>>>24,v[l]=y,r?(r=f^e[e[e[m^f]]],i^=e[e[i]]):r=i=1}}();var l=[0,1,2,4,8,16,32,64,128,27,54],f=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,i=4*((this._nRounds=r+6)+1),o=this._keySchedule=[],s=0;s<i;s++)s<r?o[s]=t[s]:(p=o[s-1],s%r?r>6&&s%r==4&&(p=n[p>>>24]<<24|n[p>>>16&255]<<16|n[p>>>8&255]<<8|n[255&p]):(p=n[(p=p<<8|p>>>24)>>>24]<<24|n[p>>>16&255]<<16|n[p>>>8&255]<<8|n[255&p],p^=l[s/r|0]<<24),o[s]=o[s-r]^p);for(var a=this._invKeySchedule=[],c=0;c<i;c++){if(s=i-c,c%4)var p=o[s];else p=o[s-4];a[c]=c<4||s<=4?p:h[n[p>>>24]]^u[n[p>>>16&255]]^d[n[p>>>8&255]]^v[n[255&p]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,c,p,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,h,u,d,v,o),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,i,n,o,s,a){for(var c=this._nRounds,p=e[t]^r[0],h=e[t+1]^r[1],u=e[t+2]^r[2],d=e[t+3]^r[3],v=4,l=1;l<c;l++){var f=i[p>>>24]^n[h>>>16&255]^o[u>>>8&255]^s[255&d]^r[v++],g=i[h>>>24]^n[u>>>16&255]^o[d>>>8&255]^s[255&p]^r[v++],m=i[u>>>24]^n[d>>>16&255]^o[p>>>8&255]^s[255&h]^r[v++],y=i[d>>>24]^n[p>>>16&255]^o[h>>>8&255]^s[255&u]^r[v++];p=f,h=g,u=m,d=y}f=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[u>>>8&255]<<8|a[255&d])^r[v++],g=(a[h>>>24]<<24|a[u>>>16&255]<<16|a[d>>>8&255]<<8|a[255&p])^r[v++],m=(a[u>>>24]<<24|a[d>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^r[v++],y=(a[d>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&u])^r[v++],e[t]=f,e[t+1]=g,e[t+2]=m,e[t+3]=y},keySize:8});e.AES=t._createHelper(f)}(),i.AES)},1575:function(e,t,r){var i,n,o,s,a,c,p,h,u,d,v,l,f,g,m,y,S,C,w;e.exports=(i=r(2751),r(6147),void(i.lib.Cipher||(n=i,o=n.lib,s=o.Base,a=o.WordArray,c=o.BufferedBlockAlgorithm,p=n.enc,p.Utf8,h=p.Base64,u=n.algo.EvpKDF,d=o.Cipher=c.extend({cfg:s.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:S}return function(t){return{encrypt:function(r,i,n){return e(i).encrypt(t,r,i,n)},decrypt:function(r,i,n){return e(i).decrypt(t,r,i,n)}}}}()}),o.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),v=n.mode={},l=o.BlockCipherMode=s.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=v.CBC=function(){var e=l.extend();function t(e,t,r){var i,n=this._iv;n?(i=n,this._iv=void 0):i=this._prevBlock;for(var o=0;o<r;o++)e[t+o]^=i[o]}return e.Encryptor=e.extend({processBlock:function(e,r){var i=this._cipher,n=i.blockSize;t.call(this,e,r,n),i.encryptBlock(e,r),this._prevBlock=e.slice(r,r+n)}}),e.Decryptor=e.extend({processBlock:function(e,r){var i=this._cipher,n=i.blockSize,o=e.slice(r,r+n);i.decryptBlock(e,r),t.call(this,e,r,n),this._prevBlock=o}}),e}(),g=(n.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,i=r-e.sigBytes%r,n=i<<24|i<<16|i<<8|i,o=[],s=0;s<i;s+=4)o.push(n);var c=a.create(o,i);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.BlockCipher=d.extend({cfg:d.cfg.extend({mode:f,padding:g}),reset:function(){var e;d.reset.call(this);var t=this.cfg,r=t.iv,i=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=i.createEncryptor:(e=i.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,r&&r.words):(this._mode=e.call(i,this,r&&r.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),m=o.CipherParams=s.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=(n.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?a.create([1398893684,1701076831]).concat(r).concat(t):t).toString(h)},parse:function(e){var t,r=h.parse(e),i=r.words;return 1398893684==i[0]&&1701076831==i[1]&&(t=a.create(i.slice(2,4)),i.splice(0,4),r.sigBytes-=16),m.create({ciphertext:r,salt:t})}},S=o.SerializableCipher=s.extend({cfg:s.extend({format:y}),encrypt:function(e,t,r,i){i=this.cfg.extend(i);var n=e.createEncryptor(r,i),o=n.finalize(t),s=n.cfg;return m.create({ciphertext:o,key:r,iv:s.iv,algorithm:e,mode:s.mode,padding:s.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,r,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(r,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),C=(n.kdf={}).OpenSSL={execute:function(e,t,r,i){i||(i=a.random(8));var n=u.create({keySize:t+r}).compute(e,i),o=a.create(n.words.slice(t),4*r);return n.sigBytes=4*t,m.create({key:n,iv:o,salt:i})}},w=o.PasswordBasedCipher=S.extend({cfg:S.cfg.extend({kdf:C}),encrypt:function(e,t,r,i){var n=(i=this.cfg.extend(i)).kdf.execute(r,e.keySize,e.ivSize);i.iv=n.iv;var o=S.encrypt.call(this,e,t,n.key,i);return o.mixIn(n),o},decrypt:function(e,t,r,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var n=i.kdf.execute(r,e.keySize,e.ivSize,t.salt);return i.iv=n.iv,S.decrypt.call(this,e,t,n.key,i)}}))))},2751:function(e,t,r){var i;e.exports=(i=i||function(e,t){var i;if("undefined"!=typeof window&&window.crypto&&(i=window.crypto),"undefined"!=typeof self&&self.crypto&&(i=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(i=globalThis.crypto),!i&&"undefined"!=typeof window&&window.msCrypto&&(i=window.msCrypto),!i&&void 0!==r.g&&r.g.crypto&&(i=r.g.crypto),!i)try{i=r(2480)}catch(e){}var n=function(){if(i){if("function"==typeof i.getRandomValues)try{return i.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof i.randomBytes)try{return i.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},a=s.lib={},c=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},p=a.WordArray=c.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,r=e.words,i=this.sigBytes,n=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<n;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<n;a+=4)t[i+a>>>2]=r[a>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=c.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new p.init(t,e)}}),h=s.enc={},u=h.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i+=2)r[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new p.init(r,t/2)}},d=h.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n++){var o=t[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new p.init(r,t)}},v=h.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},l=a.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=v.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,i=this._data,n=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,h=e.min(4*c,o);if(c){for(var u=0;u<c;u+=s)this._doProcessBlock(n,u);r=n.splice(0,c),i.sigBytes-=h}return new p.init(r,h)},clone:function(){var e=c.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(a.Hasher=l.extend({cfg:c.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new f.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math),i)},20:function(e,t,r){var i,n,o;e.exports=(i=r(2751),o=(n=i).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,i=this._map;e.clamp();for(var n=[],o=0;o<r;o+=3)for(var s=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<r;a++)n.push(i.charAt(s>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;n.length%4;)n.push(c);return n.join("")},parse:function(e){var t=e.length,r=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var n=0;n<r.length;n++)i[r.charCodeAt(n)]=n}var s=r.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(t=a)}return function(e,t,r){for(var i=[],n=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[n>>>2]|=a<<24-n%4*8,n++}return o.create(i,n)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)},320:function(e,t,r){var i,n,o;e.exports=(i=r(2751),o=(n=i).lib.WordArray,n.enc.Base64url={stringify:function(e,t=!0){var r=e.words,i=e.sigBytes,n=t?this._safe_map:this._map;e.clamp();for(var o=[],s=0;s<i;s+=3)for(var a=(r[s>>>2]>>>24-s%4*8&255)<<16|(r[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|r[s+2>>>2]>>>24-(s+2)%4*8&255,c=0;c<4&&s+.75*c<i;c++)o.push(n.charAt(a>>>6*(3-c)&63));var p=n.charAt(64);if(p)for(;o.length%4;)o.push(p);return o.join("")},parse:function(e,t=!0){var r=e.length,i=t?this._safe_map:this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var s=0;s<i.length;s++)n[i.charCodeAt(s)]=s}var a=i.charAt(64);if(a){var c=e.indexOf(a);-1!==c&&(r=c)}return function(e,t,r){for(var i=[],n=0,s=0;s<t;s++)if(s%4){var a=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;i[n>>>2]|=a<<24-n%4*8,n++}return o.create(i,n)}(e,r,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},i.enc.Base64url)},4814:function(e,t,r){var i;e.exports=(i=r(2751),function(){var e=i,t=e.lib.WordArray,r=e.enc;function n(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],n=0;n<r;n+=2){var o=t[n>>>2]>>>16-n%4*8&65535;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var r=e.length,i=[],n=0;n<r;n++)i[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return t.create(i,2*r)}},r.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,i=[],o=0;o<r;o+=2){var s=n(t[o>>>2]>>>16-o%4*8&65535);i.push(String.fromCharCode(s))}return i.join("")},parse:function(e){for(var r=e.length,i=[],o=0;o<r;o++)i[o>>>1]|=n(e.charCodeAt(o)<<16-o%2*16);return t.create(i,2*r)}}}(),i.enc.Utf16)},6147:function(e,t,r){var i,n,o,s,a,c,p,h;e.exports=(h=r(2751),r(3653),r(5498),o=(n=(i=h).lib).Base,s=n.WordArray,c=(a=i.algo).MD5,p=a.EvpKDF=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,i=this.cfg,n=i.hasher.create(),o=s.create(),a=o.words,c=i.keySize,p=i.iterations;a.length<c;){r&&n.update(r),r=n.update(e).finalize(t),n.reset();for(var h=1;h<p;h++)r=n.finalize(r),n.reset();o.concat(r)}return o.sigBytes=4*c,o}}),i.EvpKDF=function(e,t,r){return p.create(r).compute(e,t)},h.EvpKDF)},8573:function(e,t,r){var i,n,o,s;e.exports=(s=r(2751),r(1575),n=(i=s).lib.CipherParams,o=i.enc.Hex,i.format.Hex={stringify:function(e){return e.ciphertext.toString(o)},parse:function(e){var t=o.parse(e);return n.create({ciphertext:t})}},s.format.Hex)},5498:function(e,t,r){var i,n,o;e.exports=(n=(i=r(2751)).lib.Base,o=i.enc.Utf8,void(i.algo.HMAC=n.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var n=this._oKey=t.clone(),s=this._iKey=t.clone(),a=n.words,c=s.words,p=0;p<r;p++)a[p]^=1549556828,c[p]^=909522486;n.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},1406:function(e,t,r){var i;e.exports=(i=r(2751),r(4235),r(6654),r(4814),r(20),r(320),r(4716),r(3653),r(6846),r(3438),r(4028),r(7450),r(9159),r(6945),r(5498),r(7121),r(6147),r(1575),r(3081),r(6107),r(1769),r(1191),r(4946),r(2969),r(5311),r(8970),r(8243),r(239),r(8573),r(3192),r(5627),r(5579),r(8339),r(3251),i)},6654:function(e,t,r){var i;e.exports=(i=r(2751),function(){if("function"==typeof ArrayBuffer){var e=i.lib.WordArray,t=e.init,r=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,i=[],n=0;n<r;n++)i[n>>>2]|=e[n]<<24-n%4*8;t.call(this,i,r)}else t.apply(this,arguments)};r.prototype=e}}(),i.lib.WordArray)},4716:function(e,t,r){var i;e.exports=(i=r(2751),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=s.MD5=o.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var i=t+r,n=e[i];e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var o=this._hash.words,s=e[t+0],c=e[t+1],v=e[t+2],l=e[t+3],f=e[t+4],g=e[t+5],m=e[t+6],y=e[t+7],S=e[t+8],C=e[t+9],w=e[t+10],R=e[t+11],P=e[t+12],I=e[t+13],b=e[t+14],T=e[t+15],E=o[0],A=o[1],k=o[2],x=o[3];E=p(E,A,k,x,s,7,a[0]),x=p(x,E,A,k,c,12,a[1]),k=p(k,x,E,A,v,17,a[2]),A=p(A,k,x,E,l,22,a[3]),E=p(E,A,k,x,f,7,a[4]),x=p(x,E,A,k,g,12,a[5]),k=p(k,x,E,A,m,17,a[6]),A=p(A,k,x,E,y,22,a[7]),E=p(E,A,k,x,S,7,a[8]),x=p(x,E,A,k,C,12,a[9]),k=p(k,x,E,A,w,17,a[10]),A=p(A,k,x,E,R,22,a[11]),E=p(E,A,k,x,P,7,a[12]),x=p(x,E,A,k,I,12,a[13]),k=p(k,x,E,A,b,17,a[14]),E=h(E,A=p(A,k,x,E,T,22,a[15]),k,x,c,5,a[16]),x=h(x,E,A,k,m,9,a[17]),k=h(k,x,E,A,R,14,a[18]),A=h(A,k,x,E,s,20,a[19]),E=h(E,A,k,x,g,5,a[20]),x=h(x,E,A,k,w,9,a[21]),k=h(k,x,E,A,T,14,a[22]),A=h(A,k,x,E,f,20,a[23]),E=h(E,A,k,x,C,5,a[24]),x=h(x,E,A,k,b,9,a[25]),k=h(k,x,E,A,l,14,a[26]),A=h(A,k,x,E,S,20,a[27]),E=h(E,A,k,x,I,5,a[28]),x=h(x,E,A,k,v,9,a[29]),k=h(k,x,E,A,y,14,a[30]),E=u(E,A=h(A,k,x,E,P,20,a[31]),k,x,g,4,a[32]),x=u(x,E,A,k,S,11,a[33]),k=u(k,x,E,A,R,16,a[34]),A=u(A,k,x,E,b,23,a[35]),E=u(E,A,k,x,c,4,a[36]),x=u(x,E,A,k,f,11,a[37]),k=u(k,x,E,A,y,16,a[38]),A=u(A,k,x,E,w,23,a[39]),E=u(E,A,k,x,I,4,a[40]),x=u(x,E,A,k,s,11,a[41]),k=u(k,x,E,A,l,16,a[42]),A=u(A,k,x,E,m,23,a[43]),E=u(E,A,k,x,C,4,a[44]),x=u(x,E,A,k,P,11,a[45]),k=u(k,x,E,A,T,16,a[46]),E=d(E,A=u(A,k,x,E,v,23,a[47]),k,x,s,6,a[48]),x=d(x,E,A,k,y,10,a[49]),k=d(k,x,E,A,b,15,a[50]),A=d(A,k,x,E,g,21,a[51]),E=d(E,A,k,x,P,6,a[52]),x=d(x,E,A,k,l,10,a[53]),k=d(k,x,E,A,w,15,a[54]),A=d(A,k,x,E,c,21,a[55]),E=d(E,A,k,x,S,6,a[56]),x=d(x,E,A,k,T,10,a[57]),k=d(k,x,E,A,m,15,a[58]),A=d(A,k,x,E,I,21,a[59]),E=d(E,A,k,x,f,6,a[60]),x=d(x,E,A,k,R,10,a[61]),k=d(k,x,E,A,v,15,a[62]),A=d(A,k,x,E,C,21,a[63]),o[0]=o[0]+E|0,o[1]=o[1]+A|0,o[2]=o[2]+k|0,o[3]=o[3]+x|0},_doFinalize:function(){var t=this._data,r=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;r[n>>>5]|=128<<24-n%32;var o=e.floor(i/4294967296),s=i;r[15+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(r.length+1),this._process();for(var a=this._hash,c=a.words,p=0;p<4;p++){var h=c[p];c[p]=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function p(e,t,r,i,n,o,s){var a=e+(t&r|~t&i)+n+s;return(a<<o|a>>>32-o)+t}function h(e,t,r,i,n,o,s){var a=e+(t&i|r&~i)+n+s;return(a<<o|a>>>32-o)+t}function u(e,t,r,i,n,o,s){var a=e+(t^r^i)+n+s;return(a<<o|a>>>32-o)+t}function d(e,t,r,i,n,o,s){var a=e+(r^(t|~i))+n+s;return(a<<o|a>>>32-o)+t}t.MD5=o._createHelper(c),t.HmacMD5=o._createHmacHelper(c)}(Math),i.MD5)},3081:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.mode.CFB=function(){var e=i.lib.BlockCipherMode.extend();function t(e,t,r,i){var n,o=this._iv;o?(n=o.slice(0),this._iv=void 0):n=this._prevBlock,i.encryptBlock(n,0);for(var s=0;s<r;s++)e[t+s]^=n[s]}return e.Encryptor=e.extend({processBlock:function(e,r){var i=this._cipher,n=i.blockSize;t.call(this,e,r,n,i),this._prevBlock=e.slice(r,r+n)}}),e.Decryptor=e.extend({processBlock:function(e,r){var i=this._cipher,n=i.blockSize,o=e.slice(r,r+n);t.call(this,e,r,n,i),this._prevBlock=o}}),e}(),i.mode.CFB)},1769:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.mode.CTRGladman=function(){var e=i.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,r=e>>8&255,i=255&e;255===t?(t=0,255===r?(r=0,255===i?i=0:++i):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=i}else e+=1<<24;return e}var r=e.Encryptor=e.extend({processBlock:function(e,r){var i=this._cipher,n=i.blockSize,o=this._iv,s=this._counter;o&&(s=this._counter=o.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(s);var a=s.slice(0);i.encryptBlock(a,0);for(var c=0;c<n;c++)e[r+c]^=a[c]}});return e.Decryptor=r,e}(),i.mode.CTRGladman)},6107:function(e,t,r){var i,n,o;e.exports=(o=r(2751),r(1575),o.mode.CTR=(n=(i=o.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,n=this._iv,o=this._counter;n&&(o=this._counter=n.slice(0),this._iv=void 0);var s=o.slice(0);r.encryptBlock(s,0),o[i-1]=o[i-1]+1|0;for(var a=0;a<i;a++)e[t+a]^=s[a]}}),i.Decryptor=n,i),o.mode.CTR)},4946:function(e,t,r){var i,n;e.exports=(n=r(2751),r(1575),n.mode.ECB=((i=n.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),i.Decryptor=i.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),i),n.mode.ECB)},1191:function(e,t,r){var i,n,o;e.exports=(o=r(2751),r(1575),o.mode.OFB=(n=(i=o.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){var r=this._cipher,i=r.blockSize,n=this._iv,o=this._keystream;n&&(o=this._keystream=n.slice(0),this._iv=void 0),r.encryptBlock(o,0);for(var s=0;s<i;s++)e[t+s]^=o[s]}}),i.Decryptor=n,i),o.mode.OFB)},2969:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,i=4*t,n=i-r%i,o=r+n-1;e.clamp(),e.words[o>>>2]|=n<<24-o%4*8,e.sigBytes+=n},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.pad.Ansix923)},5311:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.pad.Iso10126={pad:function(e,t){var r=4*t,n=r-e.sigBytes%r;e.concat(i.lib.WordArray.random(n-1)).concat(i.lib.WordArray.create([n<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.pad.Iso10126)},8970:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.pad.Iso97971={pad:function(e,t){e.concat(i.lib.WordArray.create([2147483648],1)),i.pad.ZeroPadding.pad(e,t)},unpad:function(e){i.pad.ZeroPadding.unpad(e),e.sigBytes--}},i.pad.Iso97971)},239:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding)},8243:function(e,t,r){var i;e.exports=(i=r(2751),r(1575),i.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){var t=e.words,r=e.sigBytes-1;for(r=e.sigBytes-1;r>=0;r--)if(t[r>>>2]>>>24-r%4*8&255){e.sigBytes=r+1;break}}},i.pad.ZeroPadding)},7121:function(e,t,r){var i,n,o,s,a,c,p,h,u;e.exports=(u=r(2751),r(3653),r(5498),o=(n=(i=u).lib).Base,s=n.WordArray,c=(a=i.algo).SHA1,p=a.HMAC,h=a.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,i=p.create(r.hasher,e),n=s.create(),o=s.create([1]),a=n.words,c=o.words,h=r.keySize,u=r.iterations;a.length<h;){var d=i.update(t).finalize(o);i.reset();for(var v=d.words,l=v.length,f=d,g=1;g<u;g++){f=i.finalize(f),i.reset();for(var m=f.words,y=0;y<l;y++)v[y]^=m[y]}n.concat(d),c[0]++}return n.sigBytes=4*h,n}}),i.PBKDF2=function(e,t,r){return h.create(r).compute(e,t)},u.PBKDF2)},3251:function(e,t,r){var i;e.exports=(i=r(2751),r(20),r(4716),r(6147),r(1575),function(){var e=i,t=e.lib.StreamCipher,r=e.algo,n=[],o=[],s=[],a=r.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var n=0;n<4;n++)c.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var o=t.words,s=o[0],a=o[1],p=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),h=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=p>>>16|4294901760&h,d=h<<16|65535&p;for(i[0]^=p,i[1]^=u,i[2]^=h,i[3]^=d,i[4]^=p,i[5]^=u,i[6]^=h,i[7]^=d,n=0;n<4;n++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)o[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,r=0;r<8;r++){var i=e[r]+t[r],n=65535&i,a=i>>>16,c=((n*n>>>17)+n*a>>>15)+a*a,p=((4294901760&i)*i|0)+((65535&i)*i|0);s[r]=c^p}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.RabbitLegacy=t._createHelper(a)}(),i.RabbitLegacy)},8339:function(e,t,r){var i;e.exports=(i=r(2751),r(20),r(4716),r(6147),r(1575),function(){var e=i,t=e.lib.StreamCipher,r=e.algo,n=[],o=[],s=[],a=r.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)c.call(this);for(r=0;r<8;r++)n[r]^=i[r+4&7];if(t){var o=t.words,s=o[0],a=o[1],p=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),h=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),u=p>>>16|4294901760&h,d=h<<16|65535&p;for(n[0]^=p,n[1]^=u,n[2]^=h,n[3]^=d,n[4]^=p,n[5]^=u,n[6]^=h,n[7]^=d,r=0;r<4;r++)c.call(this)}},_doProcessBlock:function(e,t){var r=this._X;c.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var i=0;i<4;i++)n[i]=16711935&(n[i]<<8|n[i]>>>24)|4278255360&(n[i]<<24|n[i]>>>8),e[t+i]^=n[i]},blockSize:4,ivSize:2});function c(){for(var e=this._X,t=this._C,r=0;r<8;r++)o[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,r=0;r<8;r++){var i=e[r]+t[r],n=65535&i,a=i>>>16,c=((n*n>>>17)+n*a>>>15)+a*a,p=((4294901760&i)*i|0)+((65535&i)*i|0);s[r]=c^p}e[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,e[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,e[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,e[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,e[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,e[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,e[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,e[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}e.Rabbit=t._createHelper(a)}(),i.Rabbit)},5579:function(e,t,r){var i;e.exports=(i=r(2751),r(20),r(4716),r(6147),r(1575),function(){var e=i,t=e.lib.StreamCipher,r=e.algo,n=r.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,i=this._S=[],n=0;n<256;n++)i[n]=n;n=0;for(var o=0;n<256;n++){var s=n%r,a=t[s>>>2]>>>24-s%4*8&255;o=(o+i[n]+a)%256;var c=i[n];i[n]=i[o],i[o]=c}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,r=this._j,i=0,n=0;n<4;n++){r=(r+e[t=(t+1)%256])%256;var o=e[t];e[t]=e[r],e[r]=o,i|=e[(e[t]+e[r])%256]<<24-8*n}return this._i=t,this._j=r,i}e.RC4=t._createHelper(n);var s=r.RC4Drop=n.extend({cfg:n.cfg.extend({drop:192}),_doReset:function(){n._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(s)}(),i.RC4)},6945:function(e,t,r){var i;e.exports=(i=r(2751),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),p=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=n.create([0,1518500249,1859775393,2400959708,2840853838]),d=n.create([1352829926,1548603684,1836072691,2053994217,0]),v=s.RIPEMD160=o.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var i=t+r,n=e[i];e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var o,s,v,C,w,R,P,I,b,T,E,A=this._hash.words,k=u.words,x=d.words,O=a.words,D=c.words,_=p.words,z=h.words;for(R=o=A[0],P=s=A[1],I=v=A[2],b=C=A[3],T=w=A[4],r=0;r<80;r+=1)E=o+e[t+O[r]]|0,E+=r<16?l(s,v,C)+k[0]:r<32?f(s,v,C)+k[1]:r<48?g(s,v,C)+k[2]:r<64?m(s,v,C)+k[3]:y(s,v,C)+k[4],E=(E=S(E|=0,_[r]))+w|0,o=w,w=C,C=S(v,10),v=s,s=E,E=R+e[t+D[r]]|0,E+=r<16?y(P,I,b)+x[0]:r<32?m(P,I,b)+x[1]:r<48?g(P,I,b)+x[2]:r<64?f(P,I,b)+x[3]:l(P,I,b)+x[4],E=(E=S(E|=0,z[r]))+T|0,R=T,T=b,b=S(I,10),I=P,P=E;E=A[1]+v+b|0,A[1]=A[2]+C+T|0,A[2]=A[3]+w+R|0,A[3]=A[4]+o+P|0,A[4]=A[0]+s+I|0,A[0]=E},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var n=this._hash,o=n.words,s=0;s<5;s++){var a=o[s];o[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return n},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function l(e,t,r){return e^t^r}function f(e,t,r){return e&t|~e&r}function g(e,t,r){return(e|~t)^r}function m(e,t,r){return e&r|t&~r}function y(e,t,r){return e^(t|~r)}function S(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(v),t.HmacRIPEMD160=o._createHmacHelper(v)}(Math),i.RIPEMD160)},3653:function(e,t,r){var i,n,o,s,a,c,p,h;e.exports=(n=(i=h=r(2751)).lib,o=n.WordArray,s=n.Hasher,a=i.algo,c=[],p=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],p=0;p<80;p++){if(p<16)c[p]=0|e[t+p];else{var h=c[p-3]^c[p-8]^c[p-14]^c[p-16];c[p]=h<<1|h>>>31}var u=(i<<5|i>>>27)+a+c[p];u+=p<20?1518500249+(n&o|~n&s):p<40?1859775393+(n^o^s):p<60?(n&o|n&s|o&s)-1894007588:(n^o^s)-899497514,a=s,s=o,o=n<<30|n>>>2,n=i,i=u}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(i+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),i.SHA1=s._createHelper(p),i.HmacSHA1=s._createHmacHelper(p),h.SHA1)},3438:function(e,t,r){var i,n,o,s,a,c;e.exports=(c=r(2751),r(6846),n=(i=c).lib.WordArray,o=i.algo,s=o.SHA256,a=o.SHA224=s.extend({_doReset:function(){this._hash=new n.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=s._doFinalize.call(this);return e.sigBytes-=4,e}}),i.SHA224=s._createHelper(a),i.HmacSHA224=s._createHmacHelper(a),c.SHA224)},6846:function(e,t,r){var i;e.exports=(i=r(2751),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.algo,a=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),i=2;i<=r;i++)if(!(t%i))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var i=2,n=0;n<64;)t(i)&&(n<8&&(a[n]=r(e.pow(i,.5))),c[n]=r(e.pow(i,1/3)),n++),i++}();var p=[],h=s.SHA256=o.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],h=r[5],u=r[6],d=r[7],v=0;v<64;v++){if(v<16)p[v]=0|e[t+v];else{var l=p[v-15],f=(l<<25|l>>>7)^(l<<14|l>>>18)^l>>>3,g=p[v-2],m=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;p[v]=f+p[v-7]+m+p[v-16]}var y=i&n^i&o^n&o,S=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),C=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&u)+c[v]+p[v];d=u,u=h,h=a,a=s+C|0,s=o,o=n,n=i,i=C+(S+y)|0}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+o|0,r[3]=r[3]+s|0,r[4]=r[4]+a|0,r[5]=r[5]+h|0,r[6]=r[6]+u|0,r[7]=r[7]+d|0},_doFinalize:function(){var t=this._data,r=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return r[n>>>5]|=128<<24-n%32,r[14+(n+64>>>9<<4)]=e.floor(i/4294967296),r[15+(n+64>>>9<<4)]=i,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(h),t.HmacSHA256=o._createHmacHelper(h)}(Math),i.SHA256)},9159:function(e,t,r){var i;e.exports=(i=r(2751),r(4235),function(e){var t=i,r=t.lib,n=r.WordArray,o=r.Hasher,s=t.x64.Word,a=t.algo,c=[],p=[],h=[];!function(){for(var e=1,t=0,r=0;r<24;r++){c[e+5*t]=(r+1)*(r+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)p[e+5*t]=t+(2*e+3*t)%5*5;for(var n=1,o=0;o<24;o++){for(var a=0,u=0,d=0;d<7;d++){if(1&n){var v=(1<<d)-1;v<32?u^=1<<v:a^=1<<v-32}128&n?n=n<<1^113:n<<=1}h[o]=s.create(a,u)}}();var u=[];!function(){for(var e=0;e<25;e++)u[e]=s.create()}();var d=a.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,i=this.blockSize/2,n=0;n<i;n++){var o=e[t+2*n],s=e[t+2*n+1];o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),(A=r[n]).high^=s,A.low^=o}for(var a=0;a<24;a++){for(var d=0;d<5;d++){for(var v=0,l=0,f=0;f<5;f++)v^=(A=r[d+5*f]).high,l^=A.low;var g=u[d];g.high=v,g.low=l}for(d=0;d<5;d++){var m=u[(d+4)%5],y=u[(d+1)%5],S=y.high,C=y.low;for(v=m.high^(S<<1|C>>>31),l=m.low^(C<<1|S>>>31),f=0;f<5;f++)(A=r[d+5*f]).high^=v,A.low^=l}for(var w=1;w<25;w++){var R=(A=r[w]).high,P=A.low,I=c[w];I<32?(v=R<<I|P>>>32-I,l=P<<I|R>>>32-I):(v=P<<I-32|R>>>64-I,l=R<<I-32|P>>>64-I);var b=u[p[w]];b.high=v,b.low=l}var T=u[0],E=r[0];for(T.high=E.high,T.low=E.low,d=0;d<5;d++)for(f=0;f<5;f++){var A=r[w=d+5*f],k=u[w],x=u[(d+1)%5+5*f],O=u[(d+2)%5+5*f];A.high=k.high^~x.high&O.high,A.low=k.low^~x.low&O.low}A=r[0];var D=h[a];A.high^=D.high,A.low^=D.low}},_doFinalize:function(){var t=this._data,r=t.words,i=(this._nDataBytes,8*t.sigBytes),o=32*this.blockSize;r[i>>>5]|=1<<24-i%32,r[(e.ceil((i+1)/o)*o>>>5)-1]|=128,t.sigBytes=4*r.length,this._process();for(var s=this._state,a=this.cfg.outputLength/8,c=a/8,p=[],h=0;h<c;h++){var u=s[h],d=u.high,v=u.low;d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),v=16711935&(v<<8|v>>>24)|4278255360&(v<<24|v>>>8),p.push(v),p.push(d)}return new n.init(p,a)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});t.SHA3=o._createHelper(d),t.HmacSHA3=o._createHmacHelper(d)}(Math),i.SHA3)},7450:function(e,t,r){var i,n,o,s,a,c,p,h;e.exports=(h=r(2751),r(4235),r(4028),n=(i=h).x64,o=n.Word,s=n.WordArray,a=i.algo,c=a.SHA512,p=a.SHA384=c.extend({_doReset:function(){this._hash=new s.init([new o.init(3418070365,3238371032),new o.init(1654270250,914150663),new o.init(2438529370,812702999),new o.init(355462360,4144912697),new o.init(1731405415,4290775857),new o.init(2394180231,1750603025),new o.init(3675008525,1694076839),new o.init(1203062813,3204075428)])},_doFinalize:function(){var e=c._doFinalize.call(this);return e.sigBytes-=16,e}}),i.SHA384=c._createHelper(p),i.HmacSHA384=c._createHmacHelper(p),h.SHA384)},4028:function(e,t,r){var i;e.exports=(i=r(2751),r(4235),function(){var e=i,t=e.lib.Hasher,r=e.x64,n=r.Word,o=r.WordArray,s=e.algo;function a(){return n.create.apply(n,arguments)}var c=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],p=[];!function(){for(var e=0;e<80;e++)p[e]=a()}();var h=s.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,i=r[0],n=r[1],o=r[2],s=r[3],a=r[4],h=r[5],u=r[6],d=r[7],v=i.high,l=i.low,f=n.high,g=n.low,m=o.high,y=o.low,S=s.high,C=s.low,w=a.high,R=a.low,P=h.high,I=h.low,b=u.high,T=u.low,E=d.high,A=d.low,k=v,x=l,O=f,D=g,_=m,z=y,L=S,N=C,M=w,B=R,F=P,q=I,U=b,H=T,W=E,j=A,K=0;K<80;K++){var J,V,G=p[K];if(K<16)V=G.high=0|e[t+2*K],J=G.low=0|e[t+2*K+1];else{var $=p[K-15],Y=$.high,Q=$.low,X=(Y>>>1|Q<<31)^(Y>>>8|Q<<24)^Y>>>7,Z=(Q>>>1|Y<<31)^(Q>>>8|Y<<24)^(Q>>>7|Y<<25),ee=p[K-2],te=ee.high,re=ee.low,ie=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ne=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),oe=p[K-7],se=oe.high,ae=oe.low,ce=p[K-16],pe=ce.high,he=ce.low;V=(V=(V=X+se+((J=Z+ae)>>>0<Z>>>0?1:0))+ie+((J+=ne)>>>0<ne>>>0?1:0))+pe+((J+=he)>>>0<he>>>0?1:0),G.high=V,G.low=J}var ue,de=M&F^~M&U,ve=B&q^~B&H,le=k&O^k&_^O&_,fe=x&D^x&z^D&z,ge=(k>>>28|x<<4)^(k<<30|x>>>2)^(k<<25|x>>>7),me=(x>>>28|k<<4)^(x<<30|k>>>2)^(x<<25|k>>>7),ye=(M>>>14|B<<18)^(M>>>18|B<<14)^(M<<23|B>>>9),Se=(B>>>14|M<<18)^(B>>>18|M<<14)^(B<<23|M>>>9),Ce=c[K],we=Ce.high,Re=Ce.low,Pe=W+ye+((ue=j+Se)>>>0<j>>>0?1:0),Ie=me+fe;W=U,j=H,U=F,H=q,F=M,q=B,M=L+(Pe=(Pe=(Pe=Pe+de+((ue+=ve)>>>0<ve>>>0?1:0))+we+((ue+=Re)>>>0<Re>>>0?1:0))+V+((ue+=J)>>>0<J>>>0?1:0))+((B=N+ue|0)>>>0<N>>>0?1:0)|0,L=_,N=z,_=O,z=D,O=k,D=x,k=Pe+(ge+le+(Ie>>>0<me>>>0?1:0))+((x=ue+Ie|0)>>>0<ue>>>0?1:0)|0}l=i.low=l+x,i.high=v+k+(l>>>0<x>>>0?1:0),g=n.low=g+D,n.high=f+O+(g>>>0<D>>>0?1:0),y=o.low=y+z,o.high=m+_+(y>>>0<z>>>0?1:0),C=s.low=C+N,s.high=S+L+(C>>>0<N>>>0?1:0),R=a.low=R+B,a.high=w+M+(R>>>0<B>>>0?1:0),I=h.low=I+q,h.high=P+F+(I>>>0<q>>>0?1:0),T=u.low=T+H,u.high=b+U+(T>>>0<H>>>0?1:0),A=d.low=A+j,d.high=E+W+(A>>>0<j>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(i+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(h),e.HmacSHA512=t._createHmacHelper(h)}(),i.SHA512)},5627:function(e,t,r){var i;e.exports=(i=r(2751),r(20),r(4716),r(6147),r(1575),function(){var e=i,t=e.lib,r=t.WordArray,n=t.BlockCipher,o=e.algo,s=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],p=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=o.DES=n.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var i=s[r]-1;t[r]=e[i>>>5]>>>31-i%32&1}for(var n=this._subKeys=[],o=0;o<16;o++){var p=n[o]=[],h=c[o];for(r=0;r<24;r++)p[r/6|0]|=t[(a[r]-1+h)%28]<<31-r%6,p[4+(r/6|0)]|=t[28+(a[r+24]-1+h)%28]<<31-r%6;for(p[0]=p[0]<<1|p[0]>>>31,r=1;r<7;r++)p[r]=p[r]>>>4*(r-1)+3;p[7]=p[7]<<5|p[7]>>>27}var u=this._invSubKeys=[];for(r=0;r<16;r++)u[r]=n[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],d.call(this,4,252645135),d.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),d.call(this,1,1431655765);for(var i=0;i<16;i++){for(var n=r[i],o=this._lBlock,s=this._rBlock,a=0,c=0;c<8;c++)a|=p[c][((s^n[c])&h[c])>>>0];this._lBlock=s,this._rBlock=o^a}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,d.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),d.call(this,16,65535),d.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function d(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function v(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}e.DES=n._createHelper(u);var l=o.TripleDES=n.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),i=e.length<4?e.slice(0,2):e.slice(2,4),n=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=u.createEncryptor(r.create(t)),this._des2=u.createEncryptor(r.create(i)),this._des3=u.createEncryptor(r.create(n))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=n._createHelper(l)}(),i.TripleDES)},4235:function(e,t,r){var i,n,o,s,a,c;e.exports=(i=r(2751),o=(n=i).lib,s=o.Base,a=o.WordArray,(c=n.x64={}).Word=s.extend({init:function(e,t){this.high=e,this.low=t}}),c.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],i=0;i<t;i++){var n=e[i];r.push(n.high),r.push(n.low)}return a.create(r,this.sigBytes)},clone:function(){for(var e=s.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}}),i)},1682:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActivityReceivedEventArgs:()=>Ye,AudioConfig:()=>c.rU,AudioFormatTag:()=>p.WY,AudioInputStream:()=>h.yk,AudioOutputStream:()=>u.J4,AudioStreamFormat:()=>p.HT,AutoDetectSourceLanguageConfig:()=>Mt,AutoDetectSourceLanguageResult:()=>Bt,BaseAudioPlayer:()=>dt,BotFrameworkConfig:()=>Fe,CancellationDetails:()=>Le,CancellationDetailsBase:()=>ze,CancellationErrorCode:()=>X.E,CancellationReason:()=>d._,Connection:()=>ke,ConnectionEventArgs:()=>Te,ConnectionMessage:()=>Ie,ConnectionMessageEventArgs:()=>Ee,Conversation:()=>Mr,ConversationExpirationEventArgs:()=>ur,ConversationParticipantsChangedEventArgs:()=>Dr,ConversationTranscriber:()=>Zr,ConversationTranscriptionCanceledEventArgs:()=>Jr,ConversationTranscriptionEventArgs:()=>b.d,ConversationTranslationCanceledEventArgs:()=>hr,ConversationTranslationEventArgs:()=>_r,ConversationTranslationResult:()=>dr,ConversationTranslator:()=>Kr,CustomCommandsConfig:()=>qe,Diagnostics:()=>bi,DialogServiceConfig:()=>Me,DialogServiceConnector:()=>ut,IntentRecognitionCanceledEventArgs:()=>Z,IntentRecognitionEventArgs:()=>S,IntentRecognitionResult:()=>R,IntentRecognizer:()=>ae,KeywordRecognitionModel:()=>f,LanguageIdMode:()=>Dt,LanguageUnderstandingModel:()=>P,LogLevel:()=>n.t,NoMatchDetails:()=>_e,NoMatchReason:()=>xe,OutputFormat:()=>y.W,Participant:()=>Lr,ParticipantChangedReason:()=>Ar,PhraseListGrammar:()=>Ne,ProfanityOption:()=>N.P,PronunciationAssessmentConfig:()=>Pi,PronunciationAssessmentGradingSystem:()=>Ci,PronunciationAssessmentGranularity:()=>wi,PronunciationAssessmentResult:()=>Ii,PropertyCollection:()=>L.O,PropertyId:()=>z.o,PullAudioInputStream:()=>h.kv,PullAudioInputStreamCallback:()=>v.W,PullAudioOutputStream:()=>u.Ao,PushAudioInputStream:()=>h.ZT,PushAudioOutputStream:()=>u.XO,PushAudioOutputStreamCallback:()=>l.y,RecognitionEventArgs:()=>m.J,RecognitionResult:()=>C.p,Recognizer:()=>q.c,ResultReason:()=>O.s,ServiceEventArgs:()=>Ae,ServicePropertyChannel:()=>pt,SessionEventArgs:()=>g.$,SourceLanguageConfig:()=>Ft,SpeakerAudioDestination:()=>Ri.K,SpeakerIdentificationModel:()=>Lt,SpeakerRecognitionCancellationDetails:()=>kt,SpeakerRecognitionResult:()=>At,SpeakerRecognitionResultType:()=>bt,SpeakerRecognizer:()=>zt,SpeakerVerificationModel:()=>Nt,SpeechConfig:()=>D.c,SpeechConfigImpl:()=>D.z,SpeechRecognitionCanceledEventArgs:()=>T.n,SpeechRecognitionEventArgs:()=>b.m,SpeechRecognitionResult:()=>w.b,SpeechRecognizer:()=>U.F,SpeechSynthesisBookmarkEventArgs:()=>yi.i,SpeechSynthesisBoundaryType:()=>li,SpeechSynthesisEventArgs:()=>gi.c,SpeechSynthesisOutputFormat:()=>M.Y,SpeechSynthesisResult:()=>fi.P,SpeechSynthesisVisemeEventArgs:()=>Si.w,SpeechSynthesisWordBoundaryEventArgs:()=>mi.G,SpeechSynthesizer:()=>di,SpeechTranslationConfig:()=>B,SpeechTranslationConfigImpl:()=>F,SynthesisResult:()=>ci.A,SynthesisVoicesResult:()=>hi,TranslationRecognitionCanceledEventArgs:()=>de,TranslationRecognitionEventArgs:()=>E,TranslationRecognitionResult:()=>k,TranslationRecognizer:()=>De,TranslationSynthesisEventArgs:()=>A,TranslationSynthesisResult:()=>x,Translations:()=>ve,TurnStatusReceivedEventArgs:()=>Xe,User:()=>zr,VoiceInfo:()=>pi,VoiceProfile:()=>vt,VoiceProfileCancellationDetails:()=>mt,VoiceProfileClient:()=>Et,VoiceProfileEnrollmentCancellationDetails:()=>ft,VoiceProfileEnrollmentResult:()=>lt,VoiceProfilePhraseResult:()=>yt,VoiceProfileResult:()=>gt,VoiceProfileType:()=>se});var i=r(3034),n=r(7552),o=r(5282);class s{constructor(e=n.t.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){o.a.throwIfNullOrUndefined(i.openSync,"\nFile System access not available"),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){const t=this.toString(e);if(this.privLogPath&&i.writeFileSync(this.privLogPath,t+"\n",{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case n.t.Debug:console.debug(t);break;case n.t.Info:console.info(t);break;case n.t.Warning:console.warn(t);break;case n.t.Error:console.error(t);break;default:console.log(t)}}}toString(e){const t=[`${e.eventTime}`,`${e.name}`],r=e;for(const i in r)if(i&&e.hasOwnProperty(i)&&"eventTime"!==i&&"eventType"!==i&&"eventId"!==i&&"name"!==i&&"constructor"!==i){const e=r[i];let n="<NULL>";null!=e&&(n="number"==typeof e||"string"==typeof e?e.toString():JSON.stringify(e)),t.push(`${i}: ${n}`)}return t.join(" | ")}}var a=r(3114),c=r(6402),p=r(4746),h=r(1389),u=r(5857),d=r(8328),v=r(8857),l=r(9542);class f{constructor(){this.privDisposed=!1}static fromFile(e){throw o.a.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw o.a.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}var g=r(1610),m=r(7602),y=r(1002);class S extends m.J{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}var C=r(1984),w=r(7263);class R extends w.b{constructor(e,t,r,i,n,o,s,a,c,p,h){super(t,r,i,n,o,s,a,void 0,c,p,h),this.privIntentId=e}get intentId(){return this.privIntentId}}class P{constructor(){}static fromEndpoint(e){o.a.throwIfNull(e,"uri"),o.a.throwIfNullOrWhitespace(e.hostname,"uri");const t=new I,r=e.host.indexOf(".");if(-1===r)throw new Error("Could not determine region from endpoint");t.region=e.host.substr(0,r);const i=e.pathname.lastIndexOf("/")+1;if(-1===i)throw new Error("Could not determine appId from endpoint");if(t.appId=e.pathname.substr(i),t.subscriptionKey=e.searchParams.get("subscription-key"),void 0===t.subscriptionKey)throw new Error("Could not determine subscription key from endpoint");return t}static fromAppId(e){o.a.throwIfNullOrWhitespace(e,"appId");const t=new I;return t.appId=e,t}static fromSubscription(e,t,r){o.a.throwIfNullOrWhitespace(e,"subscriptionKey"),o.a.throwIfNullOrWhitespace(t,"appId"),o.a.throwIfNullOrWhitespace(r,"region");const i=new I;return i.appId=t,i.region=r,i.subscriptionKey=e,i}}class I extends P{}var b=r(2855),T=r(5809);class E extends m.J{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class A extends g.${constructor(e,t){super(t),this.privResult=e}get result(){return this.privResult}}class k extends w.b{constructor(e,t,r,i,n,o,s,a,c,p,h){super(t,r,i,n,o,s,a,void 0,c,p,h),this.privTranslations=e}static fromSpeechRecognitionResult(e){return new k(void 0,e.resultId,e.reason,e.text,e.duration,e.offset,e.language,e.languageDetectionConfidence,e.errorDetails,e.json,e.properties)}get translations(){return this.privTranslations}}class x{constructor(e,t){this.privReason=e,this.privAudio=t}get audio(){return this.privAudio}get reason(){return this.privReason}}var O=r(2543),D=r(7395),_=r(4484),z=r(6845),L=r(2935),N=r(4122),M=r(8735);class B extends D.c{constructor(){super()}static fromSubscription(e,t){o.a.throwIfNullOrWhitespace(e,"subscriptionKey"),o.a.throwIfNullOrWhitespace(t,"region");const r=new F;return r.properties.setProperty(z.o.SpeechServiceConnection_Key,e),r.properties.setProperty(z.o.SpeechServiceConnection_Region,t),r}static fromAuthorizationToken(e,t){o.a.throwIfNullOrWhitespace(e,"authorizationToken"),o.a.throwIfNullOrWhitespace(t,"region");const r=new F;return r.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e),r.properties.setProperty(z.o.SpeechServiceConnection_Region,t),r}static fromHost(e,t){o.a.throwIfNull(e,"hostName");const r=new F;return r.setProperty(z.o.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(z.o.SpeechServiceConnection_Key,t),r}static fromEndpoint(e,t){o.a.throwIfNull(e,"endpoint"),o.a.throwIfNull(t,"subscriptionKey");const r=new F;return r.properties.setProperty(z.o.SpeechServiceConnection_Endpoint,e.href),r.properties.setProperty(z.o.SpeechServiceConnection_Key,t),r}}class F extends B{constructor(){super(),this.privSpeechProperties=new L.O,this.outputFormat=y.W.Simple}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}set speechRecognitionLanguage(e){o.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_RecoLanguage,e)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(z.o[z.o.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(z.o[z.o.SpeechServiceConnection_Key])}get outputFormat(){return y.W[this.privSpeechProperties.getProperty(_.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privSpeechProperties.setProperty(_.OutputFormatPropertyName,y.W[e])}get endpointId(){return this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_EndpointId,e)}addTargetLanguage(e){o.a.throwIfNullOrWhitespace(e,"value");const t=this.targetLanguages;t.push(e),this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_TranslationToLanguages,t.join(","))}get targetLanguages(){return void 0!==this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages,void 0)?this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(z.o[z.o.SpeechServiceConnection_TranslationVoice])}set voiceName(e){o.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_TranslationVoice,e)}get region(){return this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_Region)}setProxy(e,t,r,i){this.setProperty(z.o[z.o.SpeechServiceConnection_ProxyHostName],e),this.setProperty(z.o[z.o.SpeechServiceConnection_ProxyPort],t),this.setProperty(z.o[z.o.SpeechServiceConnection_ProxyUserName],r),this.setProperty(z.o[z.o.SpeechServiceConnection_ProxyPassword],i)}getProperty(e,t){return this.privSpeechProperties.getProperty(e,t)}setProperty(e,t){this.privSpeechProperties.setProperty(e,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(e,t){const r=JSON.parse(this.privSpeechProperties.getProperty(_.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privSpeechProperties.setProperty(_.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privSpeechProperties.setProperty(z.o.SpeechServiceResponse_ProfanityOption,N.P[e])}enableAudioLogging(){this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(z.o.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(_.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return M.Y[this.privSpeechProperties.getProperty(z.o.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privSpeechProperties.setProperty(z.o.SpeechServiceConnection_SynthOutputFormat,M.Y[e])}}var q=r(8123),U=r(1277),H=r(6081),W=r(6976),j=r(872),K=r(9957),J=r(4004);class V extends j._{create(e,t,r){let i=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint);if(!i){const t=e.parameters.getProperty(z.o.SpeechServiceConnection_IntentRegion),r=j._.getHostSuffix(t);i=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,"wss://"+t+".sr.speech"+r)+"/speech/recognition/interactive/cognitiveservices/v1"}const n={format:"simple",language:e.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,n,i);const o={};void 0!==t.token&&""!==t.token&&(o[t.headerName]=t.token),o[J.S.ConnectionId]=r,e.parameters.setProperty(z.o.SpeechServiceConnection_Url,i);const s="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(i,n,o,new K.D,W.i.fromRecognizerConfig(e),s,r)}getSpeechRegionFromIntentRegion(e){switch(e){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return e}}}var G=r(4435);class ${constructor(e,t){this.modelImpl=e,this.intentName=t}}var Y=r(4438),Q=r(4588),X=r(3198);class Z extends S{constructor(e,t,r,i,n,o){super(i,n,o),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}var ee=r(149),te=r(1089),re=r(2642),ie=r(7569);class ne{constructor(e){this.privIntentResponse=""===e?{}:JSON.parse(e)}static fromJSON(e){return new ne(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}class oe extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privIntentRecognizer=n,this.privIntentDataSent=!1}setIntents(e,t){this.privAddedLmIntents=e,this.privUmbrellaIntent=t,this.privIntentDataSent=!0}processTypeSpecificMessages(e){let t,r,i=!1;const n=new L.O;switch(e.messageType===Y.C.Text&&n.setProperty(z.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.hypothesis":const o=te.r.fromJSON(e.textBody);if(t=new R(void 0,this.privRequestSession.requestId,O.s.RecognizingIntent,o.Text,o.Duration,o.Offset+this.privRequestSession.currentTurnAudioOffset,o.Language,o.LanguageDetectionConfidence,void 0,e.textBody,n),this.privRequestSession.onHypothesis(t.offset),r=new S(t,o.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,r)}catch(e){}i=!0;break;case"speech.phrase":const s=re.n.fromJSON(e.textBody);t=new R(void 0,this.privRequestSession.requestId,ie.o.implTranslateRecognitionResult(s.RecognitionStatus),s.DisplayText,s.Duration,s.Offset+this.privRequestSession.currentTurnAudioOffset,s.Language,s.LanguageDetectionConfidence,void 0,e.textBody,n),r=new S(t,t.offset,this.privRequestSession.sessionId);const a=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};!1===this.privIntentDataSent||O.s.NoMatch===r.result.reason?(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),a()):this.privPendingIntentArgs=r,i=!0;break;case"response":if(r=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,void 0===r){if(""===e.textBody)return;r=new S(new R,0,this.privRequestSession.sessionId)}const c=ne.fromJSON(e.textBody);if(null!==c&&c.topScoringIntent&&c.topScoringIntent.intent){let t=this.privAddedLmIntents[c.topScoringIntent.intent];if(void 0!==this.privUmbrellaIntent&&(t=this.privUmbrellaIntent),t){const i=void 0===t||void 0===t.intentName?c.topScoringIntent.intent:t.intentName;let n=r.result.reason;void 0!==i&&(n=O.s.RecognizedIntent);const o=void 0!==r.result.properties?r.result.properties:new L.O;o.setProperty(z.o.LanguageUnderstandingServiceResponse_JsonResult,e.textBody),r=new S(new R(i,r.result.resultId,n,r.result.text,r.result.duration,r.result.offset,void 0,void 0,r.result.errorDetails,r.result.json,o),r.offset,r.sessionId)}}if(this.privRequestSession.onPhraseRecognized(r.offset+r.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,r)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(r.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}i=!0}const o=new Q.BH;return o.resolve(i),o.promise}cancelRecognition(e,t,r,i,n){const o=new L.O;if(o.setProperty(_.CancellationErrorCodePropertyName,X.E[i]),this.privIntentRecognizer.canceled){const t=new Z(r,n,i,void 0,void 0,e);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new R(void 0,t,O.s.Canceled,void 0,void 0,void 0,void 0,void 0,n,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}var se;class ae extends q.c{constructor(e,t){o.a.throwIfNullOrUndefined(e,"speechConfig");const r=e;o.a.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new V),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=r.properties,o.a.throwIfNullOrWhitespace(this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage),z.o[z.o.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return o.a.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e,t){if(o.a.throwIfDisposed(this.privDisposedIntentRecognizer),0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,Q.Kb)(this.recognizeOnceAsyncImpl(G.jf.Interactive),e,t)}startContinuousRecognitionAsync(e,t){if(0!==Object.keys(this.privAddedLmIntents).length||void 0!==this.privUmbrellaIntent){const e=this.buildSpeechContext();this.privReco.speechContext.setSection("intent",e.Intent),this.privReco.dynamicGrammar.addReferenceGrammar(e.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,Q.Kb)(this.startContinuousRecognitionAsyncImpl(G.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,Q.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){o.a.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e,t){if(e)try{e()}catch(e){t&&t(e)}}addIntent(e,t){o.a.throwIfDisposed(this.privDisposedIntentRecognizer),o.a.throwIfNullOrWhitespace(t,"intentId"),o.a.throwIfNullOrWhitespace(e,"simplePhrase"),this.privAddedIntents.push([t,e])}addIntentWithLanguageModel(e,t,r){o.a.throwIfDisposed(this.privDisposedIntentRecognizer),o.a.throwIfNullOrWhitespace(e,"intentId"),o.a.throwIfNull(t,"model");const i=t;o.a.throwIfNullOrWhitespace(i.appId,"model.appId"),this.privAddedLmIntents[e]=new $(i,r)}addAllIntents(e,t){o.a.throwIfNull(e,"model");const r=e;o.a.throwIfNullOrWhitespace(r.appId,"model.appId"),this.privUmbrellaIntent=new $(r,t)}close(e,t){o.a.throwIfDisposed(this.privDisposedIntentRecognizer),(0,Q.Kb)(this.dispose(!0),e,t)}createRecognizerConfig(e){return new G.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new oe(e,t,r,i,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return r=this,i=void 0,o=function*(){this.privDisposedIntentRecognizer||e&&(this.privDisposedIntentRecognizer=!0,yield t.dispose.call(this,e))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,a)}c((o=o.apply(r,i||[])).next())}));var r,i,n,o}buildSpeechContext(){let e,t,r;const i=[];void 0!==this.privUmbrellaIntent&&(e=this.privUmbrellaIntent.modelImpl.appId,t=this.privUmbrellaIntent.modelImpl.region,r=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const n of Object.keys(this.privAddedLmIntents)){const o=this.privAddedLmIntents[n];if(void 0===e)e=o.modelImpl.appId;else if(e!==o.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(void 0===t)t=o.modelImpl.region;else if(t!==o.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(void 0===r)r=o.modelImpl.subscriptionKey;else if(r!==o.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const s="luis/"+e+"-PRODUCTION#"+n;i.push(s)}return{Intent:{id:e,key:void 0===r?this.privProperties.getProperty(z.o[z.o.SpeechServiceConnection_Key]):r,provider:"LUIS"},ReferenceGrammars:void 0===this.privUmbrellaIntent?i:["luis/"+e+"-PRODUCTION"]}}}!function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(se||(se={}));class ce{static formatString(e,t){if(!e)return"";if(!t)return e;let r="",i="";const n=e=>{r+=e},o=e=>{i+=e};let s=n;for(let a=0;a<e.length;a++){const c=e[a],p=a+1<e.length?e[a+1]:"";switch(c){case"{":"{"===p?(s("{"),a++):s=o;break;case"}":"}"===p?(s("}"),a++):(t.hasOwnProperty(i)&&(r+=t[i]),s=n,i="");break;default:s(c)}}return r}}var pe,he=r(5587);class ue extends j._{create(e,t,r){const i=this.getEndpointUrl(e),n={};void 0!==e.autoDetectSourceLanguages&&(n[he.o.EnableLanguageId]="true"),this.setQueryParams(n,e,i);const o={};void 0!==t.token&&""!==t.token&&(o[t.headerName]=t.token),o[J.S.ConnectionId]=r,e.parameters.setProperty(z.o.SpeechServiceConnection_Url,i);const s="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(i,n,o,new K.D,W.i.fromRecognizerConfig(e),s,r)}getEndpointUrl(e,t){const r=e.parameters.getProperty(z.o.SpeechServiceConnection_Region),i=j._.getHostSuffix(r);let n=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint,void 0);return n||(n=void 0!==e.autoDetectSourceLanguages?e.parameters.getProperty(z.o.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+i)+"/speech/universal/v2":e.parameters.getProperty(z.o.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+i)+"/speech/translation/cognitiveservices/v1"),!0===t?n:ce.formatString(n,{region:r})}setQueryParams(e,t,r){e.from=t.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage),e.to=t.parameters.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages),this.setCommonUrlParams(t,e,r),this.setUrlParameter(z.o.SpeechServiceResponse_TranslationRequestStablePartialResult,he.o.StableTranslation,t,e,r);const i=t.parameters.getProperty(z.o.SpeechServiceConnection_TranslationVoice,void 0);void 0!==i&&(e.voice=i,e.features="texttospeech")}}!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(pe||(pe={}));class de{constructor(e,t,r,i,n){this.privCancelReason=t,this.privErrorDetails=r,this.privResult=n,this.privSessionId=e,this.privErrorCode=i}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class ve{constructor(){this.privMap=new L.O}get languages(){return this.privMap.keys}get(e,t){return this.privMap.getProperty(e,t)}set(e,t){this.privMap.setProperty(e,t)}}var le=r(1508),fe=r(414),ge=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class me extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.handleSpeechPhraseMessage=e=>ge(this,void 0,void 0,(function*(){return this.handleSpeechPhrase(e)})),this.handleSpeechHypothesisMessage=e=>this.handleSpeechHypothesis(e)}processTypeSpecificMessages(e){}handleRecognizedCallback(e,t,r){}handleRecognizingCallback(e,t,r){}processSpeechMessages(e){return ge(this,void 0,void 0,(function*(){let t=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(e.textBody),t=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&(yield this.handleSpeechPhraseMessage(e.textBody)),t=!0}return t}))}cancelRecognition(e,t,r,i,n){}handleSpeechPhrase(e){return ge(this,void 0,void 0,(function*(){const t=re.n.fromJSON(e),r=ie.o.implTranslateRecognitionResult(t.RecognitionStatus);let i;const n=new L.O;n.setProperty(z.o.SpeechServiceResponse_JsonResult,e);const o=t.Offset+this.privRequestSession.currentTurnAudioOffset;let s=o;if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+t.Offset+t.Duration),O.s.Canceled===r){const e=ie.o.implTranslateCancelResult(t.RecognitionStatus),r=ie.o.implTranslateCancelErrorCode(t.RecognitionStatus);yield this.cancelRecognitionLocal(e,r,ie.o.implTranslateErrorDetails(r))}else if(!this.privRequestSession.isSpeechEnded||r!==O.s.NoMatch||t.RecognitionStatus===le.T.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(_.OutputFormatPropertyName)===y.W[y.W.Simple])i=new w.b(this.privRequestSession.requestId,r,t.DisplayText,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,n);else{const t=fe.u.fromJSON(e),o=t.Offset+this.privRequestSession.currentTurnAudioOffset,a=t.getJsonWithCorrectedOffsets(o);i=new w.b(this.privRequestSession.requestId,r,t.Text,t.Duration,o,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,a,n),s=i.offset}this.handleRecognizedCallback(i,s,this.privRequestSession.sessionId)}}))}handleSpeechHypothesis(e){const t=te.r.fromJSON(e),r=t.Offset+this.privRequestSession.currentTurnAudioOffset,i=new L.O;i.setProperty(z.o.SpeechServiceResponse_JsonResult,e);const n=new w.b(this.privRequestSession.requestId,O.s.RecognizingSpeech,t.Text,t.Duration,r,t.Language,t.LanguageDetectionConfidence,t.SpeakerId,void 0,e,i);this.privRequestSession.onHypothesis(r),this.handleRecognizingCallback(n,t.Duration,this.privRequestSession.sessionId)}}class ye{constructor(e){this.privTranslationHypothesis=JSON.parse(e),this.privTranslationHypothesis.Translation.TranslationStatus=pe[this.privTranslationHypothesis.Translation.TranslationStatus]}static fromJSON(e){return new ye(e)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}}class Se{constructor(e){this.privTranslationPhrase=e,this.privTranslationPhrase.RecognitionStatus=le.T[this.privTranslationPhrase.RecognitionStatus],void 0!==this.privTranslationPhrase.Translation&&(this.privTranslationPhrase.Translation.TranslationStatus=pe[this.privTranslationPhrase.Translation.TranslationStatus])}static fromJSON(e){return new Se(JSON.parse(e))}static fromTranslationResponse(e){o.a.throwIfNullOrUndefined(e,"translationResponse");const t=e.SpeechPhrase;return e.SpeechPhrase=void 0,t.Translation=e,t.Text=t.DisplayText,new Se(t)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Language}get Confidence(){var e;return null===(e=this.privTranslationPhrase.PrimaryLanguage)||void 0===e?void 0:e.Confidence}get Translation(){return this.privTranslationPhrase.Translation}}class Ce{constructor(e){this.privSynthesisEnd=JSON.parse(e),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=le.g[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=le.g[this.privSynthesisEnd.Status])}static fromJSON(e){return new Ce(e)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}}var we=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Re extends me{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privTranslationRecognizer=n,this.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name?this.privTranslationRecognizer.onConnection():"ConnectionClosedEvent"===e.name&&this.privTranslationRecognizer.onDisconnection()}))}processTypeSpecificMessages(e){return we(this,void 0,void 0,(function*(){const t=new L.O;let r=yield this.processSpeechMessages(e);if(r)return!0;const i=i=>we(this,void 0,void 0,(function*(){if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+i.Offset+i.Duration),i.RecognitionStatus===le.T.Success){const e=this.fireEventForResult(i,t);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}if(this.privSuccessCallback){try{this.privSuccessCallback(e.result)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const n=ie.o.implTranslateRecognitionResult(i.RecognitionStatus),o=new k(void 0,this.privRequestSession.requestId,n,i.Text,i.Duration,this.privRequestSession.currentTurnAudioOffset+i.Offset,i.Language,i.Confidence,void 0,e.textBody,t);if(n===O.s.Canceled){const e=ie.o.implTranslateCancelResult(i.RecognitionStatus),t=ie.o.implTranslateCancelErrorCode(i.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,ie.o.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||n!==O.s.NoMatch||i.RecognitionStatus===le.T.InitialSilenceTimeout){const e=new E(o,o.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,e)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(o)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}r=!0}}));switch(e.messageType===Y.C.Text&&t.setProperty(z.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"translation.hypothesis":const n=this.fireEventForResult(ye.fromJSON(e.textBody),t);if(this.privRequestSession.onHypothesis(this.privRequestSession.currentTurnAudioOffset+n.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,n)}catch(e){}r=!0;break;case"translation.response":const o=JSON.parse(e.textBody);o.SpeechPhrase&&(yield i(Se.fromTranslationResponse(o)));break;case"translation.phrase":yield i(Se.fromJSON(e.textBody));break;case"translation.synthesis":this.sendSynthesisAudio(e.binaryBody,this.privRequestSession.sessionId),r=!0;break;case"audio.end":case"translation.synthesis.end":const s=Ce.fromJSON(e.textBody);switch(s.SynthesisStatus){case le.g.Error:if(this.privTranslationRecognizer.synthesizing){const e=new x(O.s.Canceled,void 0),t=new A(e,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,t)}catch(e){}}if(this.privTranslationRecognizer.canceled){const e=new de(this.privRequestSession.sessionId,d._.Error,s.FailureReason,X.E.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,e)}catch(e){}}break;case le.g.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId)}r=!0}return r}))}cancelRecognition(e,t,r,i,n){const o=new L.O;if(o.setProperty(_.CancellationErrorCodePropertyName,X.E[i]),this.privTranslationRecognizer.canceled){const t=new de(e,r,n,i,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new k(void 0,t,O.s.Canceled,void 0,void 0,void 0,void 0,void 0,n,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}handleRecognizingCallback(e,t,r){try{const i=new E(k.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,i)}catch(e){}}handleRecognizedCallback(e,t,r){try{const i=new E(k.fromSpeechRecognitionResult(e),t,r);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,i)}catch(e){}}fireEventForResult(e,t){let r,i,n,o;if(void 0!==e.Translation.Translations){r=new ve;for(const t of e.Translation.Translations)r.set(t.Language,t.Text||t.DisplayText)}e instanceof Se?(i=e.Translation&&e.Translation.TranslationStatus===pe.Success?O.s.TranslatedSpeech:O.s.RecognizedSpeech,n=e.Language,o=e.Confidence):i=O.s.TranslatingSpeech;const s=e.Offset+this.privRequestSession.currentTurnAudioOffset,a=new k(r,this.privRequestSession.requestId,i,e.Text,e.Duration,s,n,o,e.Translation.FailureReason,JSON.stringify(e),t);return new E(a,s,this.privRequestSession.sessionId)}sendSynthesisAudio(e,t){const r=void 0===e?O.s.SynthesizingAudioCompleted:O.s.SynthesizingAudio,i=new x(r,e),n=new A(i,t);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,n)}catch(e){}}}var Pe=r(8985);class Ie{}class be{constructor(e){this.privConnectionMessage=e,this.privProperties=new L.O,this.privConnectionMessage.headers[J.S.ConnectionId]&&this.privProperties.setProperty(z.o.Speech_SessionId,this.privConnectionMessage.headers[J.S.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach((e=>{this.privProperties.setProperty(e,this.privConnectionMessage.headers[e])}))}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find((e=>e.toLowerCase()==="path".toLowerCase()))]}get isTextMessage(){return this.privConnectionMessage.messageType===Y.C.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===Y.C.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}class Te extends g.${}class Ee{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}class Ae extends g.${constructor(e,t,r){super(r),this.privJsonResult=e,this.privEventName=t}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}}class ke{static fromRecognizer(e){const t=e.internalData,r=new ke;return r.privInternalData=t,r.setupEvents(),r}static fromSynthesizer(e){const t=e.internalData,r=new ke;return r.privInternalData=t,r.setupEvents(),r}openConnection(e,t){(0,Q.Kb)(this.privInternalData.connect(),e,t)}closeConnection(e,t){if(this.privInternalData instanceof Pe.E)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,Q.Kb)(this.privInternalData.disconnect(),e,t)}setMessageProperty(e,t,r){if(o.a.throwIfNullOrWhitespace(t,"propertyName"),this.privInternalData instanceof ee.q){if("speech.context"!==e.toLowerCase())throw new Error("Only speech.context message property sets are currently supported for recognizer");this.privInternalData.speechContext.setSection(t,r)}else if(this.privInternalData instanceof Pe.E){if("synthesis.context"!==e.toLowerCase())throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(t,r)}}sendMessageAsync(e,t,r,i){(0,Q.Kb)(this.privInternalData.sendNetworkMessage(e,t),r,i)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach((e=>{"ConnectionEstablishedEvent"===e.name?this.connected&&this.connected(new Te(e.connectionId)):"ConnectionClosedEvent"===e.name?this.disconnected&&this.disconnected(new Te(e.connectionId)):"ConnectionMessageSentEvent"===e.name?this.messageSent&&this.messageSent(new Ee(new be(e.message))):"ConnectionMessageReceivedEvent"===e.name&&this.messageReceived&&this.messageReceived(new Ee(new be(e.message)))})),this.privServiceEventListener=this.privInternalData.serviceEvents.attach((e=>{this.receivedServiceMessage&&this.receivedServiceMessage(new Ae(e.jsonString,e.name))}))}}var xe,Oe=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class De extends q.c{constructor(e,t,r){const i=e;o.a.throwIfNull(i,"speechConfig"),super(t,i.properties,r||new ue),this.privDisposedTranslationRecognizer=!1,void 0!==this.properties.getProperty(z.o.SpeechServiceConnection_TranslationVoice,void 0)&&o.a.throwIfNullOrWhitespace(this.properties.getProperty(z.o.SpeechServiceConnection_TranslationVoice),z.o[z.o.SpeechServiceConnection_TranslationVoice]),o.a.throwIfNullOrWhitespace(this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages),z.o[z.o.SpeechServiceConnection_TranslationToLanguages]),o.a.throwIfNullOrWhitespace(this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage),z.o[z.o.SpeechServiceConnection_RecoLanguage])}static FromConfig(e,t,r){const i=e;return t.properties.mergeTo(i.properties),new De(e,r)}get speechRecognitionLanguage(){return o.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return o.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return o.a.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}recognizeOnceAsync(e,t){o.a.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,Q.Kb)(this.recognizeOnceAsyncImpl(G.jf.Conversation),e,t)}startContinuousRecognitionAsync(e,t){(0,Q.Kb)(this.startContinuousRecognitionAsyncImpl(G.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,Q.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}removeTargetLanguage(e){if(o.a.throwIfNullOrUndefined(e,"language to be removed"),void 0!==this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages,void 0)){const t=this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages).split(","),r=t.indexOf(e);r>-1&&(t.splice(r,1),this.properties.setProperty(z.o.SpeechServiceConnection_TranslationToLanguages,t.join(",")),this.updateLanguages(t))}}addTargetLanguage(e){o.a.throwIfNullOrUndefined(e,"language to be added");let t=[];void 0!==this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages,void 0)?(t=this.properties.getProperty(z.o.SpeechServiceConnection_TranslationToLanguages).split(","),t.includes(e)||(t.push(e),this.properties.setProperty(z.o.SpeechServiceConnection_TranslationToLanguages,t.join(",")))):(this.properties.setProperty(z.o.SpeechServiceConnection_TranslationToLanguages,e),t=[e]),this.updateLanguages(t)}close(e,t){o.a.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,Q.Kb)(this.dispose(!0),e,t)}onConnection(){}onDisconnection(){return Oe(this,void 0,void 0,(function*(){}))}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Oe(this,void 0,void 0,(function*(){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,e&&(yield this.implRecognizerStop(),yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new G.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new Re(e,t,r,i,this)}updateLanguages(e){const t=ke.fromRecognizer(this);t&&(t.setMessageProperty("speech.context","translationcontext",{to:e}),t.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:e})))}}!function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(xe||(xe={}));class _e{constructor(e){this.privReason=e}static fromResult(e){const t=re.n.fromJSON(e.json);let r=xe.NotRecognized;switch(t.RecognitionStatus){case le.T.BabbleTimeout:r=xe.InitialBabbleTimeout;break;case le.T.InitialSilenceTimeout:r=xe.InitialSilenceTimeout;break;default:r=xe.NotRecognized}return new _e(r)}get reason(){return this.privReason}}class ze{constructor(e,t,r){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}class Le extends ze{constructor(e,t,r){super(e,t,r)}static fromResult(e){let t=d._.Error,r=X.E.NoError;if(e instanceof C.p&&e.json){const r=re.n.fromJSON(e.json);t=ie.o.implTranslateCancelResult(r.RecognitionStatus)}return e.properties&&(r=X.E[e.properties.getProperty(_.CancellationErrorCodePropertyName,X.E[X.E.NoError])]),new Le(t,e.errorDetails||ie.o.implTranslateErrorDetails(r),r)}}class Ne{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const t=e.internalData;return new Ne(t)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}class Me{constructor(){}set applicationId(e){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}}class Be extends Me{constructor(){super(),this.privSpeechConfig=new D.z}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(e){o.a.throwIfNullOrWhitespace(e,"value"),this.privSpeechConfig.speechRecognitionLanguage=e}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(e){this.privSpeechConfig.outputFormat=e}setProperty(e,t){this.privSpeechConfig.setProperty(e,t)}getProperty(e,t){return this.privSpeechConfig.getProperty(e)}setProxy(e,t,r,i){this.setProperty(z.o.SpeechServiceConnection_ProxyHostName,e),this.setProperty(z.o.SpeechServiceConnection_ProxyPort,`${t}`),r&&this.setProperty(z.o.SpeechServiceConnection_ProxyUserName,r),i&&this.setProperty(z.o.SpeechServiceConnection_ProxyPassword,i)}setServiceProperty(e,t,r){this.privSpeechConfig.setServiceProperty(e,t)}close(){}}class Fe extends Be{constructor(){super()}static fromSubscription(e,t,r){o.a.throwIfNullOrWhitespace(e,"subscription"),o.a.throwIfNullOrWhitespace(t,"region");const i=new Be;return i.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.BotFramework),i.setProperty(z.o.SpeechServiceConnection_Key,e),i.setProperty(z.o.SpeechServiceConnection_Region,t),r&&i.setProperty(z.o.Conversation_ApplicationId,r),i}static fromAuthorizationToken(e,t,r){o.a.throwIfNullOrWhitespace(e,"authorizationToken"),o.a.throwIfNullOrWhitespace(t,"region");const i=new Be;return i.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.BotFramework),i.setProperty(z.o.SpeechServiceAuthorization_Token,e),i.setProperty(z.o.SpeechServiceConnection_Region,t),r&&i.setProperty(z.o.Conversation_ApplicationId,r),i}static fromHost(e,t,r){o.a.throwIfNullOrUndefined(e,"host");const i=e instanceof URL?e:new URL(`wss://${e}.convai.speech.azure.us`);o.a.throwIfNullOrUndefined(i,"resolvedHost");const n=new Be;return n.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.BotFramework),n.setProperty(z.o.SpeechServiceConnection_Host,i.toString()),void 0!==t&&n.setProperty(z.o.SpeechServiceConnection_Key,t),n}static fromEndpoint(e,t){o.a.throwIfNull(e,"endpoint");const r=new Be;return r.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.BotFramework),r.setProperty(z.o.SpeechServiceConnection_Endpoint,e.toString()),void 0!==t&&r.setProperty(z.o.SpeechServiceConnection_Key,t),r}}class qe extends Be{constructor(){super()}static fromSubscription(e,t,r){o.a.throwIfNullOrWhitespace(e,"applicationId"),o.a.throwIfNullOrWhitespace(t,"subscription"),o.a.throwIfNullOrWhitespace(r,"region");const i=new Be;return i.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.CustomCommands),i.setProperty(z.o.Conversation_ApplicationId,e),i.setProperty(z.o.SpeechServiceConnection_Key,t),i.setProperty(z.o.SpeechServiceConnection_Region,r),i}static fromAuthorizationToken(e,t,r){o.a.throwIfNullOrWhitespace(e,"applicationId"),o.a.throwIfNullOrWhitespace(t,"authorizationToken"),o.a.throwIfNullOrWhitespace(r,"region");const i=new Be;return i.setProperty(z.o.Conversation_DialogType,Me.DialogTypes.CustomCommands),i.setProperty(z.o.Conversation_ApplicationId,e),i.setProperty(z.o.SpeechServiceAuthorization_Token,t),i.setProperty(z.o.SpeechServiceConnection_Region,r),i}set applicationId(e){o.a.throwIfNullOrWhitespace(e,"value"),this.setProperty(z.o.Conversation_ApplicationId,e)}get applicationId(){return this.getProperty(z.o.Conversation_ApplicationId)}}class Ue extends j._{create(e,t,r){const i=e.parameters.getProperty(z.o.Conversation_ApplicationId,""),n=e.parameters.getProperty(z.o.Conversation_DialogType),o=e.parameters.getProperty(z.o.SpeechServiceConnection_Region),s=e.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage,"en-US"),a=e.parameters.getProperty(z.o.Conversation_Request_Bot_Status_Messages,"true"),c={};c[J.S.ConnectionId]=r,c[he.o.Format]=e.parameters.getProperty(_.OutputFormatPropertyName,y.W[y.W.Simple]).toLowerCase(),c[he.o.Language]=s,c[he.o.RequestBotStatusMessages]=a,i&&(c[he.o.BotId]=i,n===Me.DialogTypes.CustomCommands&&(c[J.S.CustomCommandsAppId]=i));const p=n===Me.DialogTypes.CustomCommands?"commands/":"",h=n===Me.DialogTypes.CustomCommands?"v1":n===Me.DialogTypes.BotFramework?"v3":"v0",u={};null!=t.token&&""!==t.token&&(u[t.headerName]=t.token);let d=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint,"");if(!d){const t=j._.getHostSuffix(o),r=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,`wss://${o}.${Ue.BaseUrl}${t}`);d=`${r.endsWith("/")?r:r+"/"}${p}${Ue.ApiKey}/${h}`}this.setCommonUrlParams(e,c,d);const v="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(d,c,u,new K.D,W.i.fromRecognizerConfig(e),v,r)}}Ue.ApiKey="api",Ue.BaseUrl="convai.speech";var He=r(1569);class We extends n.A{constructor(e,t=n.t.Info){super(e,t)}}class je extends We{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}}var Ke=r(249),Je=r(7626),Ve=r(2919),Ge=r(6898),$e=r(7455);class Ye{constructor(e,t){this.privActivity=e,this.privAudioStream=t}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}class Qe{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new Qe(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}class Xe{constructor(e){this.privTurnStatus=Qe.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}}var Ze,et=r(9233);class tt{constructor(e){this.privActivityResponse=JSON.parse(e)}static fromJSON(e){return new tt(e)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}!function(e){e[e.None=0]="None",e[e.TextToSpeechAudio=1]="TextToSpeechAudio"}(Ze||(Ze={}));class rt{constructor(e,t){this.privRequestId=t,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,t){return e.messageDataStreamType===Ze.TextToSpeechAudio&&(this.privAudioStream=u.J4.createPullStream(),this.privAudioStream.format=void 0!==t?t:$e.d.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){null===this.privAudioStream||this.privAudioStream.isClosed||this.privAudioStream.close()}complete(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){void 0!==this.privTimeoutToken&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout((()=>{this.privTurnManager.CompleteTurn(this.privRequestId)}),2e3)}}class it{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new et.$2("Service error: There is already a turn with id:"+e);const t=new rt(this,e);return this.privTurnMap.set(e,t),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new et.$2("Service error: Received turn end for an unknown turn id:"+e);const t=this.privTurnMap.get(e);return t.complete(),this.privTurnMap.delete(e),t}}class nt{constructor(e){this.privSpeechKeyword=JSON.parse(e)}static fromJSON(e){return new nt(e)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}}var ot=r(8072),st=r(5407),at=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class ct extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privEvents=new Ke.n,this.privDialogServiceConnector=n,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new it,this.recognizeOverride=(e,t,r)=>this.listenOnce(e,t,r),this.postConnectImplOverride=e=>this.dialogConnectImpl(e),this.configConnectionOverride=e=>this.configConnection(e),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=r,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach((e=>{"ConnectionClosedEvent"===e.name&&(this.terminateMessageLoop=!0)}))}sendMessage(e){return at(this,void 0,void 0,(function*(){const t=(0,Je.c)(),r=(0,Je.Q)(),i={context:{interactionId:t},messagePayload:JSON.parse(e),version:.5},n=JSON.stringify(i),o=yield this.fetchConnection();yield o.send(new st.r(Y.C.Text,"agent",r,"application/json",n))}))}privDisconnect(){return at(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}))}processTypeSpecificMessages(e){const t=new L.O;let r,i;switch(e.messageType===Y.C.Text&&t.setProperty(z.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speech.phrase":const n=re.n.fromJSON(e.textBody);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+n.Offset+n.Duration),n.RecognitionStatus!==le.T.TooManyRequests&&n.RecognitionStatus!==le.T.Error){const e=this.fireEventForResult(n,t);if(this.privLastResult=e.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,e)}catch(e){}}i=!0;break;case"speech.hypothesis":const o=te.r.fromJSON(e.textBody),s=o.Offset+this.privRequestSession.currentTurnAudioOffset;r=new w.b(this.privRequestSession.requestId,O.s.RecognizingSpeech,o.Text,o.Duration,s,o.Language,o.LanguageDetectionConfidence,void 0,void 0,e.textBody,t),this.privRequestSession.onHypothesis(s);const a=new b.m(r,o.Duration,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,a)}catch(e){}i=!0;break;case"speech.keyword":const c=nt.fromJSON(e.textBody);r=new w.b(this.privRequestSession.requestId,"Accepted"===c.Status?O.s.RecognizedKeyword:O.s.NoMatch,c.Text,c.Duration,c.Offset,void 0,void 0,void 0,void 0,e.textBody,t),"Accepted"!==c.Status&&(this.privLastResult=r);const p=new b.m(r,r.duration,r.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,p)}catch(e){}i=!0;break;case"audio":{const t=e.requestId.toUpperCase(),r=this.privTurnStateManager.GetTurn(t);try{e.binaryBody?r.audioStream.write(e.binaryBody):r.endAudioStream()}catch(e){}}i=!0;break;case"response":this.handleResponseMessage(e),i=!0}const n=new Q.BH;return n.resolve(i),n.promise}cancelRecognition(e,t,r,i,n){return at(this,void 0,void 0,(function*(){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing()),this.privDialogServiceConnector.canceled){const t=new L.O;t.setProperty(_.CancellationErrorCodePropertyName,X.E[i]);const o=new T.n(r,n,i,void 0,e);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,o)}catch(e){}if(this.privSuccessCallback){const e=new w.b(void 0,O.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,t);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}))}listenOnce(e,t,r){return at(this,void 0,void 0,(function*(){this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(z.o.Speech_SessionId,this.privRequestSession.sessionId);const i=this.connectImpl(),n=this.sendPreAudioMessages(),o=yield this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),s=yield this.privDialogAudioSource.format,a=yield this.privDialogAudioSource.deviceInfo,c=new He.C(o,s.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(c,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:a};try{yield i,yield n}catch(e){return yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.ConnectionFailure,e),Promise.resolve()}const p=new g.$(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,p),this.sendAudio(c).then((()=>{}),(e=>at(this,void 0,void 0,(function*(){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.RuntimeError,e)}))))}))}dialogConnectImpl(e){return this.privConnectionLoop=this.startMessageLoop(),e}receiveDialogMessageOverride(){const e=new Q.BH,t=()=>at(this,void 0,void 0,(function*(){try{const r=this.isDisposed(),i=!this.isDisposed()&&this.terminateMessageLoop;if(r||i)return void e.resolve(void 0);const n=yield this.fetchConnection(),o=yield n.read();if(!o)return t();const s=st.r.fromConnectionMessage(o);switch(s.path.toLowerCase()){case"turn.start":{const e=s.requestId.toUpperCase();e!==this.privRequestSession.requestId.toUpperCase()?this.privTurnStateManager.StartTurn(e):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const e=ot.s.fromJSON(s.textBody),t=new m.J(e.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,t);break;case"speech.enddetected":let r;r=s.textBody.length>0?s.textBody:"{ Offset: 0 }";const i=ot.s.fromJSON(r);this.privRequestSession.onServiceRecognized(i.Offset+this.privRequestSession.currentTurnAudioOffset);const n=new m.J(i.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,n);break;case"turn.end":{const e=s.requestId.toUpperCase();if(e!==this.privRequestSession.requestId.toUpperCase())this.privTurnStateManager.CompleteTurn(e);else{const e=new g.$(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(!1),this.privRecognizerConfig.isContinuousRecognition&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing||this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,e),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{(yield this.processTypeSpecificMessages(s))||this.serviceEvents&&this.serviceEvents.onEvent(new Ve.e2(s.path.toLowerCase(),s.textBody))}catch(e){}}return t()}catch(t){this.terminateMessageLoop=!0,e.resolve()}}));return t().catch((e=>{a.z.instance.onEvent(new Ge.u(e))})),e.promise}startMessageLoop(){return at(this,void 0,void 0,(function*(){this.terminateMessageLoop=!1;try{yield this.receiveDialogMessageOverride()}catch(e){yield this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.RuntimeError,e)}return Promise.resolve()}))}configConnection(e){return at(this,void 0,void 0,(function*(){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendAgentConfig(e),e)}))}sendPreAudioMessages(){return at(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();this.addKeywordContextData(),yield this.sendSpeechContext(e,!0),yield this.sendAgentContext(e),yield this.sendWaveHeader(e)}))}sendAgentConfig(e){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(z.o.Conversation_DialogType)===Me.DialogTypes.CustomCommands){const e=this.agentConfig.get();e.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(e)}this.onEvent(new je(this.agentConfig));const t=this.agentConfig.toJsonString();return this.agentConfigSent=!0,e.send(new st.r(Y.C.Text,"agent.config",this.privRequestSession.requestId,"application/json",t))}}sendAgentContext(e){const t=(0,Je.c)(),r=this.privDialogServiceConnector.properties.getProperty(z.o.Conversation_Speech_Activity_Template),i={channelData:"",context:{interactionId:t},messagePayload:void 0===typeof r?void 0:r,version:.5},n=JSON.stringify(i);return e.send(new st.r(Y.C.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",n))}fireEventForResult(e,t){const r=ie.o.implTranslateRecognitionResult(e.RecognitionStatus),i=e.Offset+this.privRequestSession.currentTurnAudioOffset,n=new w.b(this.privRequestSession.requestId,r,e.DisplayText,e.Duration,i,e.Language,e.LanguageDetectionConfidence,void 0,void 0,JSON.stringify(e),t);return new b.m(n,i,this.privRequestSession.sessionId)}handleResponseMessage(e){const t=JSON.parse(e.textBody);switch(t.messageType.toLowerCase()){case"message":const r=e.requestId.toUpperCase(),i=tt.fromJSON(e.textBody),n=this.privTurnStateManager.GetTurn(r);if(i.conversationId){const e=this.agentConfig.get();e.botInfo.conversationId=i.conversationId,this.agentConfig.set(e)}const o=n.processActivityPayload(i,$e.d.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(z.o.SpeechServiceConnection_SynthOutputFormat,void 0))),s=new Ye(i.messagePayload,o);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,s)}catch(e){}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new Xe(e.textBody))}catch(e){}break;default:a.z.instance.onEvent(new Ge.u(`Unexpected response of type ${t.messageType}. Ignoring.`))}}onEvent(e){this.privEvents.onEvent(e),a.z.instance.onEvent(e)}addKeywordContextData(){const e=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(void 0===e)return;const t=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),r=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),i=e.split(";"),n=void 0===t?[]:t.split(";"),o=void 0===r?[]:r.split(";"),s=[];for(let e=0;e<i.length;e++){const t={};t.text=i[e],e<n.length&&(t.offset=Number(n[e])),e<o.length&&(t.duration=Number(o[e])),s.push(t)}this.speechContext.setSection("invocationSource","VoiceActivationWithKeyword"),this.speechContext.setSection("keywordDetection",[{clientDetectedKeywords:s,onReject:{action:"EndOfTurn"},type:"startTrigger"}])}}var pt,ht=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class ut extends q.c{constructor(e,t){const r=e;o.a.throwIfNull(e,"dialogConfig"),super(t,r.properties,new Ue),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=r.properties.clone();const i=this.buildAgentConfig();this.privReco.agentConfig.set(i)}connect(e,t){(0,Q.Kb)(this.privReco.connect(),e,t)}disconnect(e,t){(0,Q.Kb)(this.privReco.disconnect(),e,t)}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(z.o.Conversation_Speech_Activity_Template)}set speechActivityTemplate(e){this.properties.setProperty(z.o.Conversation_Speech_Activity_Template,e)}listenOnceAsync(e,t){if(this.isTurnComplete){o.a.throwIfDisposed(this.privIsDisposed);const r=(()=>ht(this,void 0,void 0,(function*(){yield this.privReco.connect(),yield this.implRecognizerStop(),this.isTurnComplete=!1;const e=new Q.BH;yield this.privReco.recognize(G.jf.Conversation,e.resolve,e.reject);const t=yield e.promise;return yield this.implRecognizerStop(),t})))();r.catch((()=>{this.dispose(!0).catch((()=>{}))})),(0,Q.Kb)(r.finally((()=>{this.isTurnComplete=!0})),e,t)}}sendActivityAsync(e,t,r){(0,Q.Kb)(this.privReco.sendMessage(e),t,r)}close(e,t){o.a.throwIfDisposed(this.privIsDisposed),(0,Q.Kb)(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return ht(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(this.privIsDisposed=!0,yield this.implRecognizerStop(),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new G.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new ct(e,t,r,i,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(z.o.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(z.o.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(z.o.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(z.o.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}}!function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(pt||(pt={}));class dt{constructor(e){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,void 0===e&&(e=p.HT.getDefaultInputFormat()),this.init(e)}playAudioSample(e,t,r){try{this.ensureInitializedContext();const r=this.formatAudioData(e),i=new Float32Array(this.samples.length+r.length);i.set(this.samples,0),i.set(r,this.samples.length),this.samples=i,t&&t()}catch(e){r&&r(e)}}stopAudio(e,t){null!==this.audioContext&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.audioContext=null)}init(e){this.audioFormat=e,this.samples=new Float32Array}ensureInitializedContext(){if(null===this.audioContext){this.createAudioContext();const e=200;this.autoUpdateBufferTimer=setInterval((()=>{this.updateAudioBuffer()}),e)}}createAudioContext(){this.audioContext=p.Bm.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(e){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(e),128);case 16:return this.formatArrayBuffer(new Int16Array(e),32768);case 32:return this.formatArrayBuffer(new Int32Array(e),2147483648);default:throw new et.$2("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(e,t){const r=new Float32Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]/t;return r}updateAudioBuffer(){if(0===this.samples.length)return;const e=this.audioFormat.channels,t=this.audioContext.createBufferSource(),r=this.samples.length/e,i=this.audioContext.createBuffer(e,r,this.audioFormat.samplesPerSec);for(let t=0;t<e;t++){let r=t;const n=i.getChannelData(t);for(let t=0;t<this.samples.length;t++,r+=e)n[t]=this.samples[r]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),t.buffer=i,t.connect(this.gainNode),t.start(this.startTime),this.startTime+=i.duration,this.samples=new Float32Array}playAudio(e){return t=this,r=void 0,n=function*(){null===this.audioContext&&this.createAudioContext();const t=this.audioContext.createBufferSource(),r=this.audioContext.destination;yield this.audioContext.decodeAudioData(e,(e=>{t.buffer=e,t.connect(r),t.start(0)}))},new((i=void 0)||(i=Promise))((function(e,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}c((n=n.apply(t,r||[])).next())}));var t,r,i,n}}class vt{constructor(e,t){this.privId=e,this.privProfileType=t}get profileId(){return this.privId}get profileType(){return this.privProfileType}}class lt{constructor(e,t,r){this.privReason=e,this.privProperties=new L.O,this.privReason!==O.s.Canceled?t&&(this.privDetails=JSON.parse(t),"enrolling"===this.privDetails.enrollmentStatus.toLowerCase()&&(this.privReason=O.s.EnrollingVoiceProfile)):(this.privErrorDetails=r,this.privProperties.setProperty(_.CancellationErrorCodePropertyName,X.E[X.E.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(e){const t=[];for(const r of e.value){const e="enrolling"===r.enrollmentStatus.toLowerCase()?O.s.EnrollingVoiceProfile:"enrolled"===r.enrollmentStatus.toLowerCase()?O.s.EnrolledVoiceProfile:O.s.Canceled,i=new lt(e,null,null);i.privDetails=this.getIdentificationDetails(r),t.push(i)}return t}static FromVerificationProfileList(e){const t=[];for(const r of e.value){const e="enrolling"===r.enrollmentStatus.toLowerCase()?O.s.EnrollingVoiceProfile:"enrolled"===r.enrollmentStatus.toLowerCase()?O.s.EnrolledVoiceProfile:O.s.Canceled,i=new lt(e,null,null);i.privDetails=this.getVerificationDetails(r),t.push(i)}return t}static getIdentificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount||0,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.identificationProfileId,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(e){return{audioLength:e.audioLength?parseFloat(e.audioLength):0,audioSpeechLength:e.audioSpeechLength?parseFloat(e.audioSpeechLength):0,enrollmentStatus:e.enrollmentStatus,enrollmentsCount:e.enrollmentsCount,enrollmentsLength:e.enrollmentsLength?parseFloat(e.enrollmentsLength):0,enrollmentsSpeechLength:e.enrollmentsSpeechLength?parseFloat(e.enrollmentsSpeechLength):0,profileId:e.profileId||e.verificationProfileId,remainingEnrollmentsCount:e.remainingEnrollments||e.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:e.remainingEnrollmentsSpeechLength?parseFloat(e.remainingEnrollmentsSpeechLength):0}}}class ft extends ze{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=d._.Error;let r=X.E.NoError;return e.properties&&(r=X.E[e.properties.getProperty(_.CancellationErrorCodePropertyName,X.E[X.E.NoError])]),new ft(t,e.errorDetails,r)}}class gt{constructor(e,t){this.privReason=e,this.privProperties=new L.O,e===O.s.Canceled&&(o.a.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(_.CancellationErrorCodePropertyName,X.E[X.E.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}}class mt extends ze{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=d._.Error;let r=X.E.NoError;return e.properties&&(r=X.E[e.properties.getProperty(_.CancellationErrorCodePropertyName,X.E[X.E.NoError])]),new mt(t,e.errorDetails,r)}}class yt extends gt{constructor(e,t,r,i){super(e,t),this.privPhrases=[],o.a.throwIfNullOrUndefined(i,"phrase array"),this.privType=r,i&&i[0]&&(this.privPhrases=i)}get phrases(){return this.privPhrases}get type(){return this.privType}}class St extends j._{create(e,t,r,i){let n=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint);if(!n){const t=e.parameters.getProperty(z.o.SpeechServiceConnection_Region),i=j._.getHostSuffix(t),o=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,`wss://${t}.spr-frontend.speech${i}`),s=e.parameters.getProperty(z.o.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");n=`${o}/speaker/ws/${this.scenarioToPath(s)}/${r}`}const o={format:"simple",language:e.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(e,o,n);const s={};void 0!==t.token&&""!==t.token&&(s[t.headerName]=t.token),s[J.S.ConnectionId]=i,s[J.S.SpIDAuthKey]=e.parameters.getProperty(z.o.SpeechServiceConnection_Key),e.parameters.setProperty(z.o.SpeechServiceConnection_Url,n);const a="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(n,o,s,new K.D,W.i.fromRecognizerConfig(e),a,i)}scenarioToPath(e){switch(e){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}class Ct extends St{create(e,t,r){return super.create(e,t,"recognition",r)}}class wt extends St{create(e,t,r){return super.create(e,t,"profile",r)}}class Rt{constructor(){this.privMap={}}add(e,t){this.privMap[e]=t}getId(e){return this.privMap[e]}complete(e,t){try{this.privMap[e].resolve(t)}catch(t){this.privMap[e].reject(t)}finally{this.privMap[e]=void 0}}}var Pt=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class It extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privDeferralMap=new Rt,this.privSpeakerAudioSource=r,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(e){this.privSpeakerAudioSource=e}processTypeSpecificMessages(e){let t=!1;const r=new L.O;switch(e.messageType===Y.C.Text&&r.setProperty(z.o.SpeechServiceResponse_JsonResult,e.textBody),e.path.toLowerCase()){case"speaker.profiles":const r=JSON.parse(e.textBody);switch(r.operation.toLowerCase()){case"create":this.handleCreateResponse(r,e.requestId);break;case"delete":case"reset":this.handleResultResponse(r,e.requestId);break;case"fetch":const t=JSON.parse(e.textBody);this.handleFetchResponse(t,e.requestId)}t=!0;break;case"speaker.phrases":const i=JSON.parse(e.textBody);this.handlePhrasesResponse(i,e.requestId),t=!0;break;case"speaker.profile.enrollment":const n=JSON.parse(e.textBody),o=new lt(this.enrollmentReasonFrom(n.enrollment?n.enrollment.enrollmentStatus:n.status.statusCode),n.enrollment?JSON.stringify(n.enrollment):void 0,n.status.reason);this.privDeferralMap.getId(e.requestId)&&this.privDeferralMap.complete(e.requestId,o),this.privRequestSession.onSpeechEnded(),t=!0}const i=new Q.BH;return i.resolve(t),i.promise}cancelRecognition(e,t,r,i,n){(new L.O).setProperty(_.CancellationErrorCodePropertyName,X.E[i]);const o=new lt(O.s.Canceled,n,n);this.privDeferralMap.getId(t)&&this.privDeferralMap.complete(t,o)}createProfile(e,t){return Pt(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const r=this.connectImpl();try{const i=new Q.BH;return yield r,yield this.sendCreateProfile(i,e,t),this.receiveMessage(),i.promise}catch(e){throw e}}))}resetProfile(e){return Pt(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("reset",e.profileType,e)}))}deleteProfile(e){return Pt(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.sendCommonRequest("delete",e.profileType,e)}))}retrieveEnrollmentResult(e){return Pt(this,void 0,void 0,(function*(){return this.voiceProfileType=e.profileType.toString(),this.privExpectedProfileId=e.profileId,this.sendCommonRequest("fetch",e.profileType,e)}))}getAllProfiles(e){return Pt(this,void 0,void 0,(function*(){return this.voiceProfileType=e.toString(),this.sendCommonRequest("fetch",e)}))}getActivationPhrases(e,t){return Pt(this,void 0,void 0,(function*(){this.voiceProfileType=e.toString();const r=this.connectImpl();try{const i=new Q.BH;return yield r,yield this.sendPhrasesRequest(i,e,t),this.receiveMessage(),i.promise}catch(e){throw e}}))}enrollProfile(e){return Pt(this,void 0,void 0,(function*(){this.voiceProfileType=e.profileType.toString();const t=new Q.BH;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(z.o.Speech_SessionId,this.privRequestSession.sessionId);const r=this.connectImpl(),i=this.sendPreAudioMessages(e,t),n=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),o=yield this.privSpeakerAudioSource.format,s=yield this.privSpeakerAudioSource.deviceInfo,a=new He.C(n,o.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(a,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:s};try{yield r,yield i}catch(e){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.ConnectionFailure,e)}const c=new g.$(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,c),this.receiveMessage(),this.sendAudio(a).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.RuntimeError,e)})),t.promise}))}sendPreAudioMessages(e,t){return Pt(this,void 0,void 0,(function*(){const r=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t),yield this.sendBaseRequest(r,"enroll",this.scenarioFrom(e.profileType),e)}))}sendPhrasesRequest(e,t,r){return Pt(this,void 0,void 0,(function*(){const i=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const n=this.scenarioFrom(t),o={locale:r,scenario:n};return i.send(new st.r(Y.C.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCreateProfile(e,t,r){return Pt(this,void 0,void 0,(function*(){const i=yield this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,e);const n=t===se.TextIndependentIdentification?"TextIndependentIdentification":t===se.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",o={locale:r,number:"1",scenario:n};return i.send(new st.r(Y.C.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(o)))}))}sendCommonRequest(e,t,r=void 0){return Pt(this,void 0,void 0,(function*(){const i=this.connectImpl();try{const n=new Q.BH;this.privRequestSession.onSpeechContext(),yield i;const o=yield this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,n),yield this.sendBaseRequest(o,e,this.scenarioFrom(t),r),this.receiveMessage(),n.promise}catch(e){throw e}}))}sendBaseRequest(e,t,r,i){return Pt(this,void 0,void 0,(function*(){const n={scenario:r};return i?n.profileIds=[i.profileId]:n.maxPageSize=-1,e.send(new st.r(Y.C.Text,`speaker.profile.${t}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(n)))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}handlePhrasesResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile get activation phrases request for requestID ${t} not found`);if("success"!==e.status.statusCode.toLowerCase()){const r=O.s.Canceled,i=new yt(r,e.status.statusCode,e.passPhraseType,[]);this.privDeferralMap.complete(t,i)}else{if(!(e.phrases&&e.phrases.length>0))throw new Error("Voice Profile get activation phrases failed, no phrases received");{const r=O.s.EnrollingVoiceProfile,i=new yt(r,e.status.statusCode,e.passPhraseType,e.phrases);this.privDeferralMap.complete(t,i)}}}handleCreateResponse(e,t){if(!(e.profiles&&e.profiles.length>0))throw new Error("Voice Profile create failed, no profile id received");if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile create request for requestID ${t} not found`);{const r=e.profiles.map((e=>e.profileId));this.privDeferralMap.complete(t,r)}}handleResultResponse(e,t){if(!this.privDeferralMap.getId(t))throw new Error(`Voice Profile create request for requestID ${t} not found`);{const r="delete"===e.operation.toLowerCase()?O.s.DeletedVoiceProfile:O.s.ResetVoiceProfile,i="success"===e.status.statusCode.toLowerCase()?r:O.s.Canceled,n=new gt(i,`statusCode: ${e.status.statusCode}, errorDetails: ${e.status.reason}`);this.privDeferralMap.complete(t,n)}}handleFetchResponse(e,t){if(!this.privDeferralMap.getId(t)||!e.profiles[0])throw new Error(`Voice Profile fetch request for requestID ${t} not found`);if(this.privExpectedProfileId&&1===e.profiles.length&&e.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const r=e.profiles[0],i=new lt(this.enrollmentReasonFrom(r.enrollmentStatus),JSON.stringify(r),e.status.reason);this.privDeferralMap.complete(t,i)}else if(e.profiles.length>0){const r=e.profiles,i=[];for(const t of r)i.push(new lt(this.enrollmentReasonFrom(t.enrollmentStatus),JSON.stringify(t),e.status.reason));this.privDeferralMap.complete(t,i)}}enrollmentReasonFrom(e){switch(e.toLowerCase()){case"enrolled":return O.s.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return O.s.Canceled;default:return O.s.EnrollingVoiceProfile}}scenarioFrom(e){return e===se.TextIndependentIdentification?"TextIndependentIdentification":e===se.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}}var bt,Tt=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Et extends q.c{constructor(e){o.a.throwIfNullOrUndefined(e,"speechConfig");const t=e;o.a.throwIfNull(t,"speechConfig"),super(c.rU.fromStreamInput(h.yk.createPushStream()),t.properties,new wt),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}createProfileAsync(e,t){return Tt(this,void 0,void 0,(function*(){const r=yield this.privVoiceAdapter.createProfile(e,t);return new vt(r[0],e)}))}retrieveEnrollmentResultAsync(e){return Tt(this,void 0,void 0,(function*(){return this.privVoiceAdapter.retrieveEnrollmentResult(e)}))}getAllProfilesAsync(e){return Tt(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getAllProfiles(e)}))}getActivationPhrasesAsync(e,t){return Tt(this,void 0,void 0,(function*(){return this.privVoiceAdapter.getActivationPhrases(e,t)}))}enrollProfileAsync(e,t){return Tt(this,void 0,void 0,(function*(){const r=t;return o.a.throwIfNullOrUndefined(r,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=r,this.privVoiceAdapter.enrollProfile(e)}))}deleteProfileAsync(e){return Tt(this,void 0,void 0,(function*(){return this.privVoiceAdapter.deleteProfile(e)}))}resetProfileAsync(e){return Tt(this,void 0,void 0,(function*(){return this.privVoiceAdapter.resetProfile(e)}))}close(){return Tt(this,void 0,void 0,(function*(){yield this.dispose(!0)}))}createServiceRecognizer(e,t,r,i){return new It(e,t,r,i,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Tt(this,void 0,void 0,(function*(){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,e&&(yield t.dispose.call(this,e)))}))}createRecognizerConfig(e){return new G.Xj(e,this.properties)}getResult(e,t){return new gt(e.ok?t:O.s.Canceled,e.statusText)}}!function(e){e[e.Verify=0]="Verify",e[e.Identify=1]="Identify"}(bt||(bt={}));class At{constructor(e,t=O.s.RecognizedSpeaker,r=X.E.NoError,i=""){this.privProperties=new L.O;const n="TextIndependentIdentification"===e.scenario?bt.Identify:bt.Verify;this.privReason=t,this.privReason!==O.s.Canceled?n===bt.Identify?(this.privProfileId=e.identificationResult.identifiedProfile.profileId,this.privScore=e.identificationResult.identifiedProfile.score,this.privReason=O.s.RecognizedSpeakers):(this.privScore=e.verificationResult.score,"accept"!==e.verificationResult.recognitionResult.toLowerCase()&&(this.privReason=O.s.NoMatch),void 0!==e.verificationResult.profileId&&""!==e.verificationResult.profileId&&(this.privProfileId=e.verificationResult.profileId)):(this.privErrorDetails=i,this.privProperties.setProperty(_.CancellationErrorCodePropertyName,X.E[r])),this.privProperties.setProperty(z.o.SpeechServiceResponse_JsonResult,JSON.stringify(e))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}class kt extends ze{constructor(e,t,r){super(e,t,r)}static fromResult(e){const t=d._.Error;let r=X.E.NoError;return e.properties&&(r=X.E[e.properties.getProperty(_.CancellationErrorCodePropertyName,X.E[X.E.NoError])]),new kt(t,e.errorDetails,r)}}var xt=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Ot extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privSpeakerRecognizer=n,this.privSpeakerAudioSource=r,this.recognizeSpeaker=e=>this.recognizeSpeakerOnce(e),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(e){let t=!1;const r=new L.O;if(e.messageType===Y.C.Text&&r.setProperty(z.o.SpeechServiceResponse_JsonResult,e.textBody),"speaker.response"===e.path.toLowerCase()){const r=JSON.parse(e.textBody);let i;i="success"!==r.status.statusCode.toLowerCase()?new At(r,O.s.Canceled,X.E.ServiceError,r.status.reason):new At(r,O.s.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(i),t=!0}const i=new Q.BH;return i.resolve(t),i.promise}cancelRecognition(e,t,r,i,n){if((new L.O).setProperty(_.CancellationErrorCodePropertyName,X.E[i]),this.privResultDeferral){const e=new At({scenario:this.privSpeakerModel.scenario,status:{statusCode:n,reason:n}},O.s.Canceled,i,n);try{this.privResultDeferral.resolve(e)}catch(n){this.privResultDeferral.reject(n)}}}recognizeSpeakerOnce(e){return xt(this,void 0,void 0,(function*(){this.privSpeakerModel=e,this.voiceProfileType=e.scenario,this.privResultDeferral||(this.privResultDeferral=new Q.BH),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(z.o.Speech_SessionId,this.privRequestSession.sessionId);const t=this.connectImpl(),r=this.sendPreAudioMessages(this.extractSpeakerContext(e)),i=yield this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),n=yield this.privSpeakerAudioSource.format,o=yield this.privSpeakerAudioSource.deviceInfo,s=new He.C(i,n.avgBytesPerSec);yield this.privRequestSession.onAudioSourceAttachCompleted(s,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:o};try{yield t,yield r}catch(e){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.ConnectionFailure,e)}const a=new g.$(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,a),this.receiveMessage(),this.sendAudio(s).then((()=>{}),(e=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,d._.Error,X.E.RuntimeError,e)})),this.privResultDeferral.promise}))}sendPreAudioMessages(e){return xt(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield this.sendSpeakerRecognition(t,e)}))}sendSpeakerRecognition(e,t){return xt(this,void 0,void 0,(function*(){const r=JSON.stringify(t);return e.send(new st.r(Y.C.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",r))}))}extractSpeakerContext(e){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:e.profileIds,scenario:e.scenario}}}var Dt,_t=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class zt extends q.c{constructor(e,t){o.a.throwIfNullOrUndefined(e,"speechConfig");const r=e;o.a.throwIfNullOrUndefined(r,"speechConfig"),super(t,r.properties,new Ct),this.privAudioConfigImpl=t,o.a.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=r.properties}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}recognizeOnceAsync(e){return _t(this,void 0,void 0,(function*(){return o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(e)}))}close(){return _t(this,void 0,void 0,(function*(){o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.dispose(!0)}))}recognizeSpeakerOnceAsyncImpl(e){return _t(this,void 0,void 0,(function*(){o.a.throwIfDisposed(this.privDisposedSpeakerRecognizer),yield this.implRecognizerStop();const t=yield this.privReco.recognizeSpeaker(e);return yield this.implRecognizerStop(),t}))}implRecognizerStop(){return _t(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}createRecognizerConfig(e){return new G.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new Ot(e,t,r,i,this)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return _t(this,void 0,void 0,(function*(){this.privDisposedSpeakerRecognizer||e&&(this.privDisposedSpeakerRecognizer=!0,yield t.dispose.call(this,e))}))}}class Lt{constructor(e){if(this.privVoiceProfiles=[],this.privProfileIds=[],o.a.throwIfNullOrUndefined(e,"VoiceProfiles"),0===e.length)throw new Error("Empty Voice Profiles array");for(const t of e){if(t.profileType!==se.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+t.profileId);this.privVoiceProfiles.push(t),this.privProfileIds.push(t.profileId)}}static fromProfiles(e){return new Lt(e)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}}class Nt{constructor(e){if(o.a.throwIfNullOrUndefined(e,"VoiceProfile"),e.profileType===se.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=e}static fromProfile(e){return new Nt(e)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===se.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}}!function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"}(Dt||(Dt={}));class Mt{constructor(){this.privProperties=new L.O,this.privProperties.setProperty(z.o.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=Dt.AtStart}static fromOpenRange(){const e=new Mt;return e.properties.setProperty(z.o.SpeechServiceConnection_AutoDetectSourceLanguages,_.AutoDetectSourceLanguagesOpenRangeOptionName),e}static fromLanguages(e){o.a.throwIfArrayEmptyOrWhitespace(e,"languages");const t=new Mt;return t.properties.setProperty(z.o.SpeechServiceConnection_AutoDetectSourceLanguages,e.join()),t}static fromSourceLanguageConfigs(e){if(e.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const t=new Mt,r=[];return e.forEach((e=>{if(r.push(e.language),void 0!==e.endpointId&&""!==e.endpointId){const r=e.language+z.o.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(r,e.endpointId)}})),t.properties.setProperty(z.o.SpeechServiceConnection_AutoDetectSourceLanguages,r.join()),t}get properties(){return this.privProperties}set mode(e){e===Dt.Continuous?(this.privProperties.setProperty(z.o.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(z.o.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(z.o.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(z.o.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=e}}class Bt{constructor(e,t){o.a.throwIfNullOrUndefined(e,"language"),o.a.throwIfNullOrUndefined(t,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=t}static fromResult(e){return new Bt(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}class Ft{constructor(e,t){o.a.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=t}static fromLanguage(e,t){return new Ft(e,t)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}class qt{static get requestOptions(){return qt.privDefaultRequestOptions}static get configParams(){return qt.privDefaultParams}static get restErrors(){return qt.privRestErrors}}qt.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},qt.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},qt.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"};class Ut extends qt{static get host(){return Ut.privHost}static get apiVersion(){return Ut.privApiVersion}static get clientAppId(){return Ut.privClientAppId}static get defaultLanguageCode(){return Ut.privDefaultLanguageCode}static get restPath(){return Ut.privRestPath}static get webSocketPath(){return Ut.privWebSocketPath}static get transcriptionEventKeys(){return Ut.privTranscriptionEventKeys}}Ut.privHost="dev.microsofttranslator.com",Ut.privRestPath="/capito/room",Ut.privApiVersion="2.0",Ut.privDefaultLanguageCode="en-US",Ut.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",Ut.privWebSocketPath="/capito/translate",Ut.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"];class Ht{constructor(e=[],t){this.participants=e,this.meId=t}addOrUpdateParticipant(e){if(void 0===e)return;const t=this.getParticipantIndex(e.id);return t>-1?this.participants.splice(t,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex((t=>t.id===e))}getParticipant(e){return this.participants.find((t=>t.id===e))}deleteParticipant(e){this.participants=this.participants.filter((t=>t.id!==e))}get host(){return this.participants.find((e=>!0===e.isHost))}get me(){return this.getParticipant(this.meId)}}const Wt="final",jt="instant_message",Kt="partial",Jt="participant_command",Vt="ChangeNickname",Gt="SetMute",$t="SetProfanityFiltering",Yt="SetTranslateToLanguages",Qt="SetUseTTS";var Xt,Zt=r(8125),er=r.n(Zt);!function(e){e.Get="GET",e.Post="POST",e.Delete="DELETE",e.File="file"}(Xt||(Xt={}));class tr{constructor(e){if(!e)throw new et.Do("configParams");this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}static extractHeaderValue(e,t){let r="";try{const i=t.trim().split(/[\r\n]+/),n={};i.forEach((e=>{const t=e.split(": "),r=t.shift().toLowerCase(),i=t.join(": ");n[r]=i})),r=n[e.toLowerCase()]}catch(e){}return r}set options(e){this.privHeaders=e.headers,this.privIgnoreCache=e.ignoreCache}setHeaders(e,t){this.privHeaders[e]=t}request(e,t,r={},i=null){const n=new Q.BH,o=e===Xt.File?"POST":e,s=(e,t={})=>{const r=e;return{data:JSON.stringify(t),headers:JSON.stringify(e.headers),json:t,ok:e.statusCode>=200&&e.statusCode<300,status:e.statusCode,statusText:t.error?t.error.message:r.statusText?r.statusText:r.statusMessage}};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),e===Xt.Post&&i&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),(i=>{er()(t,o,this.privHeaders,200,201,202,204,400,401,402,403,404)(""===this.queryParams(r)?"":`?${this.queryParams(r)}`,i).then((t=>{return r=this,i=void 0,a=function*(){if(e===Xt.Delete||204===t.statusCode)n.resolve(s(t));else try{const e=yield t.json();n.resolve(s(t,e))}catch(e){n.resolve(s(t))}},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,s)}c((a=a.apply(r,i||[])).next())}));var r,i,o,a})).catch((e=>{n.reject(e)}))})(i),n.promise}queryParams(e={}){return Object.keys(e).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&")}}class rr{constructor(){this.privRequestParams=Ut.configParams,this.privErrors=Ut.restErrors,this.privHost=Ut.host,this.privApiVersion=Ut.apiVersion,this.privRestPath=Ut.restPath,this.privRestAdapter=new tr({})}createOrJoin(e,t,r,i){try{o.a.throwIfNullOrUndefined(e,"args");const n=e.getProperty(z.o.SpeechServiceConnection_RecoLanguage,Ut.defaultLanguageCode),s=e.getProperty(z.o.ConversationTranslator_Name,"conversation_host"),a=e.getProperty(z.o.ConversationTranslator_Host,this.privHost),c=e.getProperty(z.o.ConversationTranslator_CorrelationId),p=e.getProperty(z.o.SpeechServiceConnection_Key),h=e.getProperty(z.o.SpeechServiceConnection_Region),u=e.getProperty(z.o.SpeechServiceAuthorization_Token);o.a.throwIfNullOrWhitespace(n,"languageCode"),o.a.throwIfNullOrWhitespace(s,"nickname"),o.a.throwIfNullOrWhitespace(a,"endpointHost");const d={};d[this.privRequestParams.apiVersion]=this.privApiVersion,d[this.privRequestParams.languageCode]=n,d[this.privRequestParams.nickname]=s;const v={};c&&(v[this.privRequestParams.correlationId]=c),v[this.privRequestParams.clientAppId]=Ut.clientAppId,void 0!==t?d[this.privRequestParams.roomId]=t:(o.a.throwIfNullOrUndefined(h,this.privErrors.authInvalidSubscriptionRegion),v[this.privRequestParams.subscriptionRegion]=h,p?v[this.privRequestParams.subscriptionKey]=p:u?v[this.privRequestParams.authorization]=`Bearer ${u}`:o.a.throwIfNullOrUndefined(p,this.privErrors.authInvalidSubscriptionKey));const l={};l.headers=v,this.privRestAdapter.options=l;const f=`https://${a}${this.privRestPath}`;this.privRestAdapter.request(Xt.Post,f,d,null).then((e=>{const t=tr.extractHeaderValue(this.privRequestParams.requestId,e.headers);if(!e.ok){if(i){let r,n=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",e.status.toString());try{r=JSON.parse(e.data),n+=` [${r.error.code}: ${r.error.message}]`}catch(t){n+=` [${e.data}]`}t&&(n+=` ${t}`),i(n)}return}const n=JSON.parse(e.data);if(n&&(n.requestId=t),r){try{r(n)}catch(e){i&&i(e)}r=void 0}})).catch((()=>{}))}catch(e){if(i)if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}}leave(e,t){return new Promise(((r,i)=>{try{o.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","config")),o.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));const i=e.getProperty(z.o.ConversationTranslator_Host,this.privHost),n=e.getProperty(z.o.ConversationTranslator_CorrelationId),s={};s[this.privRequestParams.apiVersion]=this.privApiVersion,s[this.privRequestParams.sessionToken]=t;const a={};n&&(a[this.privRequestParams.correlationId]=n);const c={};c.headers=a,this.privRestAdapter.options=c;const p=`https://${i}${this.privRestPath}`;this.privRestAdapter.request(Xt.Delete,p,s,null).then((e=>{e.ok,r()})).catch((()=>{}))}catch(e){if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}}))}}var ir=r(2088),nr=r(6450);class or extends Y.H{constructor(e,t,r,i){super(e,t,r,i);const n=JSON.parse(this.textBody);void 0!==n.type&&(this.privConversationMessageType=n.type)}get conversationMessageType(){return this.privConversationMessageType}}class sr{toConnectionMessage(e){const t=new Q.BH;try{if(e.messageType===Y.C.Text){const r=new or(e.messageType,e.textContent,{},e.id);t.resolve(r)}else e.messageType===Y.C.Binary&&t.resolve(new or(e.messageType,e.binaryContent,void 0,e.id))}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise}fromConnectionMessage(e){const t=new Q.BH;try{if(e.messageType===Y.C.Text){const r=`${e.textBody?e.textBody:""}`;t.resolve(new nr.S(Y.C.Text,r,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise}}class ar extends j._{create(e,t,r){const i=e.parameters.getProperty(z.o.ConversationTranslator_Host,Ut.host),n=e.parameters.getProperty(z.o.ConversationTranslator_CorrelationId,(0,Je.c)()),s=`wss://${i}${Ut.webSocketPath}`,a=e.parameters.getProperty(z.o.ConversationTranslator_Token,void 0);o.a.throwIfNullOrUndefined(a,"token");const c={};c[Ut.configParams.apiVersion]=Ut.apiVersion,c[Ut.configParams.token]=a,c[Ut.configParams.correlationId]=n;const p="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(s,c,{},new sr,W.i.fromRecognizerConfig(e),p,r)}}var cr=r(4260),pr=r(7875);class hr extends pr.w{}class ur extends g.${constructor(e,t){super(t),this.privExpirationTime=e}get expirationTime(){return this.privExpirationTime}}class dr extends k{constructor(e,t,r,i,n,o,s,a,c,p,h){super(t,i,n,o,s,a,void 0,void 0,c,p,h),this.privId=e,this.privOrigLang=r}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}}var vr=r(9228);class lr{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=(0,Je.Q)(),this.privRequestCompletionDeferral=new Q.BH}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,t){this.privSessionId=t}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){200!==e&&403===e&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=(0,Je.Q)():this.onComplete()}dispose(){return e=this,t=void 0,i=function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach()}},new((r=void 0)||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}));var e,t,r,i}onComplete(){}}class fr extends g.${constructor(e,t){super(t),this.privIsMuted=e}get isMuted(){return this.privIsMuted}}class gr extends g.${constructor(e,t){super(t),this.privIsLocked=e}get isMuted(){return this.privIsLocked}}class mr extends g.${constructor(e,t){super(t),this.privParticipant=e}get participant(){return this.privParticipant}}class yr extends g.${constructor(e,t,r,i){super(i),this.privKey=t,this.privValue=r,this.privParticipantId=e}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}class Sr extends g.${constructor(e,t,r,i,n,o,s,a,c){super(c),this.privRoomId=e,this.privSessionToken=t,this.privTranslateTo=r,this.privProfanityFilter=i,this.privRoomProfanityFilter=n,this.privIsRoomLocked=o,this.privIsRoomLocked=s,this.privParticipants=a}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}class Cr{constructor(e,t,r){this.privPayload=t,this.privCommand=e,this.privSessionId=r}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}class wr{constructor(e){this.privCommandResponse=(e=>JSON.parse(e))(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new wr(e)}}class Rr{constructor(e){this.privParticipantsPayloadResponse=(e=>JSON.parse(e))(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new Rr(e)}}class Pr{constructor(e){this.privParticipantPayloadResponse=(e=>JSON.parse(e))(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new Pr(e)}}class Ir{constructor(e){this.privSpeechResponse=(e=>JSON.parse(e))(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return"final"===this.privSpeechResponse.type}static fromJSON(e){return new Ir(e)}}class br{constructor(e){this.privTextResponse=(e=>JSON.parse(e))(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new br(e)}}var Tr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Er extends ee.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=n,this.privConversationAuthentication=e,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=e=>this.conversationConnectImpl(e),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new lr((0,Je.Q)()),this.privConversationConnectionFactory=t,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return Tr(this,void 0,void 0,(function*(){if(this.privConversationIsDisposed=!0,void 0!==this.privConnectionConfigPromise){const t=yield this.privConnectionConfigPromise;yield t.dispose(e)}yield t.dispose.call(this,e)}))}sendMessage(e){return Tr(this,void 0,void 0,(function*(){return(yield this.fetchConnection()).send(new or(Y.C.Text,e))}))}sendMessageAsync(e){return Tr(this,void 0,void 0,(function*(){const t=yield this.fetchConnection();yield t.send(new or(Y.C.Text,e))}))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,d._.Error,X.E.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}processTypeSpecificMessages(){return Tr(this,void 0,void 0,(function*(){return!0}))}cancelRecognition(e,t,r,i,n){this.terminateMessageLoop=!0;const o=new hr(r,n,i,void 0,e);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,o)}catch(e){}}conversationConnectImpl(e){return Tr(this,void 0,void 0,(function*(){return this.privConnectionLoop=this.startMessageLoop(),e}))}receiveConversationMessageOverride(){return Tr(this,void 0,void 0,(function*(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const e=new Q.BH;try{const t=yield this.fetchConnection(),r=yield t.read();if(this.isDisposed()||this.terminateMessageLoop)return e.resolve(),Promise.resolve();if(!r)return this.receiveConversationMessageOverride();const i=this.privConversationRequestSession.sessionId;let n=!1;try{switch(r.conversationMessageType.toLowerCase()){case"info":case"participant_command":case"command":const e=wr.fromJSON(r.textBody);switch(e.command.toLowerCase()){case"participantlist":const t=Rr.fromJSON(r.textBody),n=t.participants.map((e=>({avatar:e.avatar,displayName:e.nickname,id:e.participantId,isHost:e.ishost,isMuted:e.ismuted,isUsingTts:e.usetts,preferredLanguage:e.locale})));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new Sr(t.roomid,t.token,t.translateTo,t.profanityFilter,t.roomProfanityFilter,t.roomLocked,t.muteAll,n,i));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new yr(e.participantId,Yt,e.value,i));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new yr(e.participantId,$t,e.value,i));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new yr(e.participantId,Gt,e.value,i));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new fr(e.value,i));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new ur(e.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new yr(e.participantId,Qt,e.value,i));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new gr(e.value,i));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new yr(e.participantId,Vt,e.nickname,i));break;case"joinsession":const o=Pr.fromJSON(r.textBody),s={avatar:o.avatar,displayName:o.nickname,id:o.participantId,isHost:o.ishost,isMuted:o.ismuted,isUsingTts:o.usetts,preferredLanguage:o.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new mr(s,i));break;case"leavesession":const a={id:e.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new mr(a,i));break;case"disconnectsession":e.participantId;break;case"token":const c=new vr.w((()=>{const t=e.token;return Promise.resolve(t)}),(()=>{const t=e.token;return Promise.resolve(t)}));this.authentication=c}break;case"partial":case"final":const t=Ir.fromJSON(r.textBody),o=new dr(t.participantId,this.getTranslations(t.translations),t.language,void 0,void 0,t.recognition,void 0,void 0,r.textBody,void 0);t.isFinal?((void 0!==o.text&&o.text.length>0||t.id===this.privLastPartialUtteranceId)&&(n=!0),n&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Cr(Wt,o,i))):void 0!==o.text&&(this.privLastPartialUtteranceId=t.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Cr(Kt,o,i)));break;case"translated_message":const s=br.fromJSON(r.textBody),a=new dr(s.participantId,this.getTranslations(s.translations),s.language,void 0,void 0,s.originalText,void 0,void 0,void 0,r.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new Cr(jt,a,i))}}catch(e){}return this.receiveConversationMessageOverride()}catch(e){this.terminateMessageLoop=!0}return e.promise}))}startMessageLoop(){return Tr(this,void 0,void 0,(function*(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const e=this.receiveConversationMessageOverride();try{return yield e}catch(e){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",d._.Error,X.E.RuntimeError,e),null}}))}configConnection(){return this.isDisposed()?Promise.resolve(void 0):void 0!==this.privConnectionConfigPromise?this.privConnectionConfigPromise.then((e=>e.state()===cr.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()))):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then((e=>e)),this.privConnectionConfigPromise)}getTranslations(e){let t;if(void 0!==e){t=new ve;for(const r of e)t.set(r.lang,r.translation)}return t}}var Ar,kr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class xr{static fromConfig(e,t,r){return new Or(e,t,r)}}class Or extends q.c{constructor(e,t,r){const i=t;o.a.throwIfNull(i,"speechConfig");const n=e;o.a.throwIfNull(n,"conversationImpl"),super(r,i.properties,new ar),this.privConversation=n,this.privIsDisposed=!1,this.privProperties=i.properties.clone(),this.privConnection=ke.fromRecognizer(this),this.privSetTimeout="undefined"!=typeof Blob&&"undefined"!=typeof Worker?ir.V.setTimeout:setTimeout,this.privClearTimeout="undefined"!=typeof Blob&&"undefined"!=typeof Worker?ir.V.clearTimeout:clearTimeout}set connected(e){this.privConnection.connected=e}set disconnected(e){this.privConnection.disconnected=e}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfNullOrWhitespace(e,"token"),this.privReco.conversationTranslatorToken=e,this.resetConversationTimeout(),this.privReco.connectAsync(t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e)}}disconnect(e,t){try{o.a.throwIfDisposed(this.privIsDisposed),void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then((()=>{e&&e()}),(e=>{t&&t(e)}))}catch(e){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e);this.dispose(!0).catch((e=>{a.z.instance.onEvent(new Ge.u(e))}))}}sendRequest(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),this.sendMessage(e,t,r)}catch(e){if(r)if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e);this.dispose(!0).catch((e=>{a.z.instance.onEvent(new Ge.u(e))}))}}close(){return kr(this,void 0,void 0,(function*(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,yield this.dispose(!0))}))}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return kr(this,void 0,void 0,(function*(){this.privIsDisposed||e&&(void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new G.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new Er(e,t,r,i,this)}sendMessage(e,t,r){((e,t,r)=>{void 0!==e?e.then((()=>{try{t&&t()}catch(e){r&&r(`'Unhandled error on promise callback: ${e}'`)}}),(e=>{try{r&&r(e)}catch(e){}})):r&&r("Null promise")})(this.privReco.sendMessageAsync(e),t,r),this.resetConversationTimeout()}resetConversationTimeout(){void 0!==this.privTimeoutToken&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout((()=>{this.sendRequest(this.privConversation.getKeepAlive())}),6e4)}}class Dr extends g.${constructor(e,t,r){super(r),this.privReason=e,this.privParticipant=t}get reason(){return this.privReason}get participants(){return this.privParticipant}}!function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(Ar||(Ar={}));class _r extends m.J{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class zr{constructor(e){this.privUserId=e}get userId(){return this.privUserId}}class Lr{constructor(e,t,r,i,n,o,s,a){this.privId=e,this.privAvatar=t,this.privDisplayName=r,this.privIsHost=i,this.privIsMuted=n,this.privIsUsingTts=o,this.privPreferredLanguage=s,this.privVoice=a,this.privProperties=new L.O}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(e,t,r){return new Lr(e,"",e,!1,!1,!1,t,r)}}var Nr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Mr{constructor(){}static createConversationAsync(e,t,r,i){let n,s,a;return o.a.throwIfNullOrUndefined(e,Ut.restErrors.invalidArgs.replace("{arg}","config")),o.a.throwIfNullOrUndefined(e.region,Ut.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),e.subscriptionKey||e.getProperty(z.o[z.o.SpeechServiceAuthorization_Token])||o.a.throwIfNullOrUndefined(e.subscriptionKey,Ut.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key")),"string"==typeof t?(n=new Br(e,t),(0,Q.Kb)((()=>Nr(this,void 0,void 0,(function*(){})))(),r,i)):(n=new Br(e),s=t,a=r,n.createConversationAsync((()=>{s&&s()}),(e=>{a&&a(e)}))),n}}class Br extends Mr{constructor(e,t){if(super(),this.privErrors=Ut.restErrors,this.onConnected=e=>{var t;this.privIsConnected=!0;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStarted)&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,e)}catch(e){}},this.onDisconnected=e=>{var t;try{(null===(t=this.privConversationTranslator)||void 0===t?void 0:t.sessionStopped)&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,e)}catch(e){}finally{this.close(!1)}},this.onCanceled=(e,t)=>{var r;try{(null===(r=this.privConversationTranslator)||void 0===r?void 0:r.canceled)&&this.privConversationTranslator.canceled(this.privConversationTranslator,t)}catch(t){}},this.onParticipantUpdateCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.id);if(void 0!==e){switch(t.key){case Vt:e.displayName=t.value;break;case Qt:e.isUsingTts=t.value;break;case $t:e.profanity=t.value;break;case Gt:e.isMuted=t.value;break;case Yt:e.translateToLanguages=t.value}this.privParticipants.addOrUpdateParticipant(e),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Dr(Ar.Updated,[this.toParticipant(e)],t.sessionId))}}catch(t){}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(e,t)=>{try{this.privParticipants.participants.forEach((e=>e.isMuted=!e.isHost&&t.isMuted)),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Dr(Ar.Updated,this.toParticipants(!1),t.sessionId))}catch(t){}},this.onParticipantJoinCommandReceived=(e,t)=>{try{const e=this.privParticipants.addOrUpdateParticipant(t.participant);void 0!==e&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Dr(Ar.JoinedConversation,[this.toParticipant(e)],t.sessionId))}catch(t){}},this.onParticipantLeaveCommandReceived=(e,t)=>{try{const e=this.privParticipants.getParticipant(t.participant.id);void 0!==e&&(this.privParticipants.deleteParticipant(t.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Dr(Ar.LeftConversation,[this.toParticipant(e)],t.sessionId)))}catch(t){}},this.onTranslationReceived=(e,t)=>{try{switch(t.command){case Wt:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new _r(t.payload,void 0,t.sessionId));break;case Kt:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new _r(t.payload,void 0,t.sessionId));break;case jt:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new _r(t.payload,void 0,t.sessionId))}}catch(t){}},this.onParticipantsListReceived=(e,t)=>{var r;try{if(void 0!==t.sessionToken&&null!==t.sessionToken&&(this.privRoom.token=t.sessionToken),this.privParticipants.participants=[...t.participants],void 0!==this.privParticipants.me&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new Dr(Ar.JoinedConversation,this.toParticipants(!0),t.sessionId)),this.me.isHost){const e=null===(r=this.privConversationTranslator)||void 0===r?void 0:r.properties.getProperty(z.o.ConversationTranslator_Name);void 0!==e&&e.length>0&&e!==this.me.displayName&&this.changeNicknameAsync(e)}}catch(t){}},this.onConversationExpiration=(e,t)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,t)}catch(t){}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new L.O,this.privManager=new rr,e.getProperty(z.o[z.o.SpeechServiceConnection_RecoLanguage])||e.setProperty(z.o[z.o.SpeechServiceConnection_RecoLanguage],Ut.defaultLanguageCode),this.privLanguage=e.getProperty(z.o[z.o.SpeechServiceConnection_RecoLanguage]),t)this.privConversationId=t;else{0===e.targetLanguages.length&&e.addTargetLanguage(this.privLanguage),e.getProperty(z.o[z.o.SpeechServiceResponse_ProfanityOption])||e.setProfanity(N.P.Masked);let t=e.getProperty(z.o[z.o.ConversationTranslator_Name]);null==t&&(t="Host"),o.a.throwIfNullOrTooLong(t,"nickname",50),o.a.throwIfNullOrTooShort(t,"nickname",2),e.setProperty(z.o[z.o.ConversationTranslator_Name],t)}this.privConfig=e;const r=e;o.a.throwIfNull(r,"speechConfig"),this.privProperties=r.properties.clone(),this.privIsConnected=!1,this.privParticipants=new Ht,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var e,t;return!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)&&(null===(t=this.privParticipants.me)||void 0===t?void 0:t.isMuted)}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const e=this.conversationId,t=this.participants.map((e=>({id:e.id,preferredLanguage:e.preferredLanguage,voice:e.voice}))),r={};for(const e of Ut.transcriptionEventKeys){const t=this.properties.getProperty(e,"");""!==t&&(r[e]=t)}return{id:e,participants:t,conversationProperties:r}}get canSend(){var e;return this.privIsConnected&&!(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isMuted)}get canSendAsHost(){var e;return this.privIsConnected&&(null===(e=this.privParticipants.me)||void 0===e?void 0:e.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"authorizationToken"),this.privToken=e}set conversationTranslator(e){this.privConversationTranslator=e}createConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),this.privManager.createOrJoin(this.privProperties,void 0,(r=>{r||this.handleError(new Error(this.privErrors.permissionDeniedConnect),t),this.privRoom=r,this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}startConversationAsync(e,t){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),t),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=xr.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}addParticipantAsync(e,t,r){o.a.throwIfNullOrUndefined(e,"Participant"),(0,Q.Kb)(this.addParticipantImplAsync(e),t,r)}joinConversationAsync(e,t,r,i,n){try{o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","conversationId")),o.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),o.a.throwIfNullOrWhitespace(r,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,e,(e=>{o.a.throwIfNullOrUndefined(e,this.privErrors.permissionDeniedConnect),this.privRoom=e,this.privConfig.authorizationToken=e.cognitiveSpeechAuthToken,i&&i(e.cognitiveSpeechAuthToken)}),(e=>{this.handleError(e,n)}))}catch(e){this.handleError(e,n)}}deleteConversationAsync(e,t){(0,Q.Kb)(this.deleteConversationImplAsync(),e,t)}deleteConversationImplAsync(){return Nr(this,void 0,void 0,(function*(){o.a.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),o.a.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),yield this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}))}endConversationAsync(e,t){(0,Q.Kb)(this.endConversationImplAsync(),e,t)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(e,t){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}muteAllParticipantsAsync(e,t){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}muteParticipantAsync(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!0),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}catch(e){this.handleError(e,r)}}removeParticipantAsync(e,t,r){try{if(o.a.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&e.hasOwnProperty("id"))(0,Q.Kb)(this.removeParticipantImplAsync(e),t,r);else{o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),r);let i="";"string"==typeof e?i=e:e.hasOwnProperty("id")?i=e.id:e.hasOwnProperty("userId")&&(i=e.userId),o.a.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId")),-1===this.participants.findIndex((e=>e.id===i))&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(i),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}}catch(e){this.handleError(e,r)}}unlockConversationAsync(e,t){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}unmuteAllParticipantsAsync(e,t){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),t),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),(()=>{this.handleCallback(e,t)}),(e=>{this.handleError(e,t)}))}catch(e){this.handleError(e,t)}}unmuteParticipantAsync(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","userId")),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.me.isHost||this.me.id===e||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),r),-1===this.privParticipants.getParticipantIndex(e)&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(e,!1),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}catch(e){this.handleError(e,r)}}sendTextMessageAsync(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","message")),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),e.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(e),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}catch(e){this.handleError(e,r)}}setTranslatedLanguagesAsync(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfArrayEmptyOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","languages")),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(e),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}catch(e){this.handleError(e,r)}}changeNicknameAsync(e,t,r){try{o.a.throwIfDisposed(this.privIsDisposed),o.a.throwIfDisposed(this.privConversationRecognizer.isDisposed()),o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}","nickname")),o.a.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),r),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(e),(()=>{this.handleCallback(t,r)}),(e=>{this.handleError(e,r)}))}catch(e){this.handleError(e,r)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}connectTranscriberRecognizer(e){return Nr(this,void 0,void 0,(function*(){this.privTranscriberRecognizer&&(yield this.privTranscriberRecognizer.close()),yield e.enforceAudioGating(),this.privTranscriberRecognizer=e,this.privTranscriberRecognizer.conversation=this}))}getKeepAlive(){const e=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:e,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:"keep_alive"})}addParticipantImplAsync(e){if(void 0!==this.privParticipants.addOrUpdateParticipant(e)&&this.privTranscriberRecognizer){const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"join")}}removeParticipantImplAsync(e){this.privParticipants.deleteParticipant(e.id);const t=this.conversationInfo;return t.participants=[e],this.privTranscriberRecognizer.pushConversationEvent(t,"leave")}close(e){var t;return Nr(this,void 0,void 0,(function*(){try{this.privIsConnected=!1,yield null===(t=this.privConversationRecognizer)||void 0===t?void 0:t.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(e){throw e}e&&this.dispose()}))}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e)}toParticipants(e){const t=this.privParticipants.participants.map((e=>this.toParticipant(e)));return e?t:t.filter((e=>!1===e.isHost))}toParticipant(e){return new Lr(e.id,e.avatar,e.displayName,e.isHost,e.isMuted,e.isUsingTts,e.preferredLanguage,e.voice)}getMuteAllCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:"SetMuteAll",participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Jt,value:e})}getMuteCommand(e,t){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:Gt,participantId:e,roomid:this.privRoom.roomId,type:Jt,value:t})}getLockCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:"SetLockState",participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Jt,value:e})}getEjectCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(e,"participantId"),JSON.stringify({command:"EjectParticipant",participantId:e,roomid:this.privRoom.roomId,type:Jt})}getSetTranslateToLanguagesCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:Yt,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Jt,value:e})}getChangeNicknameCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(e,"nickname"),o.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:Vt,nickname:e,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:Jt,value:e})}getMessageCommand(e){return o.a.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),o.a.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),o.a.throwIfNullOrWhitespace(e,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:e,type:jt})}}class Fr extends j._{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(e,t,r){let i=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint,void 0);const n=e.parameters.getProperty(z.o.SpeechServiceConnection_Region,"centralus"),o="wss://transcribe."+n+".cts.speech"+j._.getHostSuffix(n)+this.multiaudioRelativeUri,s=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,o),a={};this.setQueryParams(a,e,i),i||(i=s);const c={};void 0!==t.token&&""!==t.token&&(c[t.headerName]=t.token),c[J.S.ConnectionId]=r,e.parameters.setProperty(z.o.SpeechServiceConnection_Url,i);const p="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(i,a,c,new K.D,W.i.fromRecognizerConfig(e),p,r)}setQueryParams(e,t,r){const i=t.parameters.getProperty(z.o.SpeechServiceConnection_EndpointId,void 0),n=t.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage,void 0);i&&!(he.o.CustomSpeechDeploymentId in e)&&(e[he.o.CustomSpeechDeploymentId]=i),n&&!(he.o.Language in e)&&(e[he.o.Language]=n);const o="true"===t.parameters.getProperty(z.o.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase(),s=t.parameters.getProperty(_.OutputFormatPropertyName,y.W[y.W.Simple])!==y.W[y.W.Simple];(o||s)&&(e[he.o.Format]=y.W[y.W.Detailed].toLowerCase()),this.setCommonUrlParams(t,e,r)}}class qr extends j._{constructor(e){super(),o.a.throwIfNullOrUndefined(e,"convGetter"),this.privConvGetter=e}create(e,t,r){const i="TRUE"===e.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase(),n=this.privConvGetter().room,o=n.cognitiveSpeechRegion||e.parameters.getProperty(z.o.SpeechServiceConnection_Region,""),s={hostSuffix:j._.getHostSuffix(o),path:qr.CTS_VIRT_MIC_PATH,region:encodeURIComponent(o)};s[he.o.Language]=encodeURIComponent(e.parameters.getProperty(z.o.SpeechServiceConnection_RecoLanguage,"")),s[he.o.CtsMeetingId]=encodeURIComponent(n.roomId),s[he.o.CtsDeviceId]=encodeURIComponent(n.participantId),s[he.o.CtsIsParticipant]=n.isHost?"":"&"+he.o.CtsIsParticipant;let a="";const c={},p={};if(i){a=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint),a||(a="wss://"+e.parameters.getProperty(z.o.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),a=ce.formatString(a,s);const t=new URL(a);t.searchParams.forEach(((e,t)=>{c[t]=e})),(new Fr).setQueryParams(c,e,a),c[he.o.CtsMeetingId]=s[he.o.CtsMeetingId],c[he.o.CtsDeviceId]=s[he.o.CtsDeviceId],n.isHost||(c[he.o.CtsIsParticipant]=""),he.o.Format in c||(c[he.o.Format]="simple"),t.searchParams.forEach(((e,r)=>{t.searchParams.set(r,c[r]),delete c[r]})),a=t.toString()}else{const t=new ue;a=t.getEndpointUrl(e,!0),a=ce.formatString(a,s),t.setQueryParams(c,e,a)}p[J.S.ConnectionId]=r,p[qt.configParams.token]=n.token,t.token&&(p[t.headerName]=t.token);const h="TRUE"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase();return new H.i(a,c,p,new K.D,W.i.fromRecognizerConfig(e),h,r)}}qr.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio";class Ur{constructor(e){this.privAudioConfig=e}handleCallback(e,t){if(e){try{e()}catch(e){t&&t(e)}e=void 0}}handleError(e,t){if(t)if(e instanceof Error){const r=e;t(r.name+": "+r.message)}else t(e)}}var Hr,Wr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};!function(e){e[e.Inactive=0]="Inactive",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(Hr||(Hr={}));class jr extends De{constructor(e,t,r,i){super(e,t,new qr(i)),this.privSpeechState=Hr.Inactive,r&&(this.privTranslator=r,this.sessionStarted=()=>{this.privSpeechState=Hr.Connected},this.sessionStopped=()=>{this.privSpeechState=Hr.Inactive},this.recognizing=(e,t)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,t)},this.recognized=(e,t)=>Wr(this,void 0,void 0,(function*(){var e;(null===(e=t.result)||void 0===e?void 0:e.errorDetails)?(yield this.cancelSpeech(),this.fireCancelEvent(t.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,t)})),this.canceled=()=>Wr(this,void 0,void 0,(function*(){if(this.privSpeechState!==Hr.Inactive)try{yield this.cancelSpeech()}catch(e){this.privSpeechState=Hr.Inactive}})))}get state(){return this.privSpeechState}set state(e){this.privSpeechState=e}onConnection(){this.privSpeechState=Hr.Connected}onDisconnection(){return Wr(this,void 0,void 0,(function*(){this.privSpeechState=Hr.Inactive,yield this.cancelSpeech()}))}fireCancelEvent(e){try{if(this.privTranslator.canceled){const t=new hr(d._.Error,e,X.E.RuntimeError);this.privTranslator.canceled(this.privTranslator,t)}}catch(e){}}cancelSpeech(){var e;return Wr(this,void 0,void 0,(function*(){try{this.stopContinuousRecognitionAsync(),yield null===(e=this.privReco)||void 0===e?void 0:e.disconnect(),this.privSpeechState=Hr.Inactive}catch(e){}}))}}class Kr extends Ur{constructor(e){super(e),this.privErrors=Ut.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new L.O}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var e;return null===(e=this.privConversation)||void 0===e?void 0:e.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===Hr.Connected||this.privCTRecognizer.state===Hr.Connecting||this.privConversation.isMutedByHost)}setServiceProperty(e,t){const r=JSON.parse(this.privProperties.getProperty(_.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty(_.ServicePropertiesPropertyName,JSON.stringify(r))}joinConversationAsync(e,t,r,i,n){try{if("string"==typeof e){o.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),n);let s=r;null!=s&&""!==s||(s=Ut.defaultLanguageCode),this.privSpeechTranslationConfig=B.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(N.P.Masked),this.privSpeechTranslationConfig.addTargetLanguage(s),this.privSpeechTranslationConfig.setProperty(z.o[z.o.SpeechServiceConnection_RecoLanguage],s),this.privSpeechTranslationConfig.setProperty(z.o[z.o.ConversationTranslator_Name],t);const a=[z.o.SpeechServiceConnection_Host,z.o.ConversationTranslator_Host,z.o.SpeechServiceConnection_Endpoint,z.o.SpeechServiceConnection_ProxyHostName,z.o.SpeechServiceConnection_ProxyPassword,z.o.SpeechServiceConnection_ProxyPort,z.o.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const e of a){const t=this.privProperties.getProperty(e);if(t){const r="string"==typeof e?e:z.o[e];this.privSpeechTranslationConfig.setProperty(r,t)}}const c=JSON.parse(this.privProperties.getProperty(_.ServicePropertiesPropertyName,"{}"));for(const e of Object.keys(c))this.privSpeechTranslationConfig.setServiceProperty(e,c[e],pt.UriQueryParameter);this.privConversation=new Br(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(e,t,s,(e=>{e||this.handleError(new Error(this.privErrors.permissionDeniedConnect),n),this.privSpeechTranslationConfig.authorizationToken=e,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync((()=>{this.handleCallback(i,n)}),(e=>{this.handleError(e,n)}))}),(e=>{this.handleError(e,n)}))}else"object"==typeof e?(o.a.throwIfNullOrUndefined(e,this.privErrors.invalidArgs.replace("{arg}","conversation id")),o.a.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(z.o.ConversationTranslator_Name,t),this.privConversation=e,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,o.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),o.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=e.config,this.handleCallback(r,i)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),i)}catch(e){this.handleError(e,"string"==typeof r?n:i)}}leaveConversationAsync(e,t){(0,Q.Kb)((()=>Wr(this,void 0,void 0,(function*(){yield this.cancelSpeech(),yield this.privConversation.endConversationImplAsync(),yield this.privConversation.deleteConversationImplAsync(),this.dispose()})))(),e,t)}sendTextMessageAsync(e,t,r){try{o.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.a.throwIfNullOrWhitespace(e,this.privErrors.invalidArgs.replace("{arg}",e)),this.privConversation.sendTextMessageAsync(e,t,r)}catch(e){this.handleError(e,r)}}startTranscribingAsync(e,t){(0,Q.Kb)((()=>Wr(this,void 0,void 0,(function*(){try{o.a.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),o.a.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),void 0===this.privCTRecognizer&&(yield this.connectTranslatorRecognizer()),o.a.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),t),yield this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(e){throw this.privIsSpeaking=!1,yield this.cancelSpeech(),e}})))(),e,t)}stopTranscribingAsync(e,t){(0,Q.Kb)((()=>Wr(this,void 0,void 0,(function*(){try{if(!this.privIsSpeaking)return void(yield this.cancelSpeech());this.privIsSpeaking=!1,yield new Promise(((e,t)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(e,t)}))}catch(e){yield this.cancelSpeech()}})))(),e,t)}isDisposed(){return this.privIsDisposed}dispose(e,t,r){(0,Q.Kb)((()=>Wr(this,void 0,void 0,(function*(){this.isDisposed&&!this.privIsSpeaking||(yield this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})))(),t,r)}cancelSpeech(){var e;return Wr(this,void 0,void 0,(function*(){try{this.privIsSpeaking=!1,yield null===(e=this.privCTRecognizer)||void 0===e?void 0:e.onDisconnection(),this.privCTRecognizer=void 0}catch(e){}}))}connectTranslatorRecognizer(){return Wr(this,void 0,void 0,(function*(){try{void 0===this.privAudioConfig&&(this.privAudioConfig=c.rU.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(z.o[z.o.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(z.o[z.o.SpeechServiceConnection_Key],"");const e=()=>this.privConversation;this.privCTRecognizer=new jr(this.privSpeechTranslationConfig,this.privAudioConfig,this,e)}catch(e){throw yield this.cancelSpeech(),e}}))}startContinuousRecognition(){return new Promise(((e,t)=>{this.privCTRecognizer.startContinuousRecognitionAsync(e,t)}))}}class Jr extends pr.w{}var Vr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Gr extends me{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privTranscriberRecognizer=n,this.sendPrePayloadJSONOverride=e=>this.sendTranscriptionStartJSON(e),"true"===this.privRecognizerConfig.parameters.getProperty(z.o.SpeechServiceResponse_RequestWordLevelTimestamps)&&this.privSpeechContext.setWordLevelTimings()}sendSpeechEventAsync(e,t){return Vr(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing){const r=yield this.fetchConnection();yield this.sendSpeechEvent(r,this.createSpeechEventPayload(e,t))}}))}processTypeSpecificMessages(e){return this.processSpeechMessages(e)}handleRecognizedCallback(e,t,r){try{const i=new b.m(e,t,r);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,i),this.privSuccessCallback){try{this.privSuccessCallback(e)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch(e){}}handleRecognizingCallback(e,t,r){try{const i=new b.m(e,t,r);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,i)}catch(e){}}cancelRecognition(e,t,r,i,n){const o=new L.O;if(o.setProperty(_.CancellationErrorCodePropertyName,X.E[i]),this.privTranscriberRecognizer.canceled){const t=new Jr(r,n,i,void 0,e);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new w.b(t,O.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,o);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}sendTranscriptionStartJSON(e){return Vr(this,void 0,void 0,(function*(){yield this.sendSpeechContext(e,!0);const t=this.privTranscriberRecognizer.getConversationInfo(),r=this.createSpeechEventPayload(t,"start");yield this.sendSpeechEvent(e,r),yield this.sendWaveHeader(e)}))}sendSpeechEvent(e,t){const r=JSON.stringify(t);if(r)return e.send(new st.r(Y.C.Text,"speech.event",this.privRequestSession.requestId,"application/json",r))}createSpeechEventPayload(e,t){const r={id:"meeting",name:t,meeting:e.conversationProperties};return r.meeting.id=e.id,r.meeting.attendees=e.participants,r.meeting.record="on"===e.conversationProperties.audiorecording?"true":"false",r}}var $r=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Yr extends q.c{constructor(e,t){const r=e;o.a.throwIfNull(r,"speechTranslationConfig");const i=t;o.a.throwIfNull(i,"audioConfigImpl"),o.a.throwIfNullOrWhitespace(r.speechRecognitionLanguage,z.o[z.o.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new Fr),this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return o.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}set conversation(e){o.a.throwIfNullOrUndefined(e,"Conversation"),this.privConversation=e}getConversationInfo(){return o.a.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}startContinuousRecognitionAsync(e,t){(0,Q.Kb)(this.startContinuousRecognitionAsyncImpl(G.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,Q.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}close(){return $r(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(yield this.dispose(!0))}))}pushConversationEvent(e,t){return $r(this,void 0,void 0,(function*(){const r=this.privReco;o.a.throwIfNullOrUndefined(r,"serviceRecognizer"),yield r.sendSpeechEventAsync(e,t)}))}enforceAudioGating(){return $r(this,void 0,void 0,(function*(){const e=this.audioConfig,t=(yield e.format).channels;if(1===t){if("true"!==this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase())throw new Error("Single channel audio configuration for ConversationTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(8!==t)throw new Error(`Unsupported audio configuration: Detected ${t}-channel audio`)}))}connectCallbacks(e){this.canceled=(t,r)=>{e.canceled&&e.canceled(e,r)},this.recognizing=(t,r)=>{e.transcribing&&e.transcribing(e,r)},this.recognized=(t,r)=>{e.transcribed&&e.transcribed(e,r)},this.sessionStarted=(t,r)=>{e.sessionStarted&&e.sessionStarted(e,r)},this.sessionStopped=(t,r)=>{e.sessionStopped&&e.sessionStopped(e,r)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return $r(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))}))}createRecognizerConfig(e){return new G.Xj(e,this.properties)}createServiceRecognizer(e,t,r,i){return new Gr(e,t,r,i,this)}}var Qr,Xr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class Zr{constructor(e){this.privAudioConfig=e,this.privProperties=new L.O,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return o.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(z.o.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return ke.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}joinConversationAsync(e,t,r){const i=e;o.a.throwIfNullOrUndefined(i,"Conversation"),this.privRecognizer=new Yr(e.config,this.privAudioConfig),o.a.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectCallbacks(this),(0,Q.Kb)(i.connectTranscriberRecognizer(this.privRecognizer),t,r)}startTranscribingAsync(e,t){this.privRecognizer.startContinuousRecognitionAsync(e,t)}stopTranscribingAsync(e,t){this.privRecognizer.stopContinuousRecognitionAsync(e,t)}leaveConversationAsync(e,t){this.privRecognizer.disconnectCallbacks(),(0,Q.Kb)((()=>Xr(this,void 0,void 0,(function*(){})))(),e,t)}close(e,t){o.a.throwIfDisposed(this.privDisposedRecognizer),(0,Q.Kb)(this.dispose(!0),e,t)}dispose(e){return Xr(this,void 0,void 0,(function*(){this.privDisposedRecognizer||(this.privRecognizer&&(yield this.privRecognizer.close(),this.privRecognizer=void 0),e&&(this.privDisposedRecognizer=!0))}))}}class ei{constructor(){this.synthesisUri="/cognitiveservices/websocket/v1"}create(e,t,r){let i=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint,void 0);const n=e.parameters.getProperty(z.o.SpeechServiceConnection_Region,void 0),o=j._.getHostSuffix(n),s=e.parameters.getProperty(z.o.SpeechServiceConnection_EndpointId,void 0),a=void 0===s?"tts":"voice",c=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,"wss://"+n+"."+a+".speech"+o);i||(i=c+this.synthesisUri);const p={};void 0!==t.token&&""!==t.token&&(p[t.headerName]=t.token),p[J.S.ConnectionId]=r,void 0!==s&&(p[he.o.CustomVoiceDeploymentId]=s),e.parameters.setProperty(z.o.SpeechServiceConnection_Url,i);const h="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false");return new H.i(i,{},p,new K.D,W.i.fromParameters(e.parameters),h,r)}}!function(e){e[e.Standard=0]="Standard",e[e.Custom=1]="Custom"}(Qr||(Qr={}));class ti{constructor(e,t){this.privSynthesisServiceType=Qr.Standard,this.privSpeechServiceConfig=e||new G.pu(new G._y(null)),this.privParameters=t}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(e){this.privSynthesisServiceType=e}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}var ri=r(9253);class ii{constructor(e,t){let r=e.parameters.getProperty(z.o.SpeechServiceConnection_Endpoint,void 0);if(!r){const t=e.parameters.getProperty(z.o.SpeechServiceConnection_Region,"westus"),i=j._.getHostSuffix(t);r=e.parameters.getProperty(z.o.SpeechServiceConnection_Host,`https://${t}.tts.speech${i}`)}this.privUri=`${r}/cognitiveservices/voices/list`;const i=qt.requestOptions;this.privRestAdapter=new tr(i),this.privAuthentication=t}getVoicesList(e){return this.privRestAdapter.setHeaders(J.S.ConnectionId,e),this.privAuthentication.fetch(e).then((e=>(this.privRestAdapter.setHeaders(e.headerName,e.token),this.privRestAdapter.request(Xt.Get,this.privUri))))}}var ni,oi,si=r(1543),ai=r(2651),ci=r(9402);!function(e){e[e.Unknown=0]="Unknown",e[e.Female=1]="Female",e[e.Male=2]="Male"}(ni||(ni={})),function(e){e[e.OnlineNeural=1]="OnlineNeural",e[e.OnlineStandard=2]="OnlineStandard",e[e.OfflineNeural=3]="OfflineNeural",e[e.OfflineStandard=4]="OfflineStandard"}(oi||(oi={}));class pi{constructor(e){if(this.privStyleList=[],this.privVoicePath="",e&&(this.privName=e.Name,this.privLocale=e.Locale,this.privShortName=e.ShortName,this.privLocaleName=e.LocaleName,this.privLocalName=e.LocalName,this.privVoiceType=e.VoiceType.endsWith("Standard")?oi.OnlineStandard:oi.OnlineNeural,this.privGender="Male"===e.Gender?ni.Male:"Female"===e.Gender?ni.Female:ni.Unknown,e.StyleList&&Array.isArray(e.StyleList)))for(const t of e.StyleList)this.privStyleList.push(t)}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get voicePath(){return this.privVoicePath}}class hi extends ci.A{constructor(e,t,r){if(Array.isArray(t)){super(e,O.s.VoicesListRetrieved,void 0,new L.O),this.privVoices=[];for(const e of t)this.privVoices.push(new pi(e))}else super(e,O.s.Canceled,r||"Error information unavailable",new L.O)}get voices(){return this.privVoices}}var ui=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class di{constructor(e,t){const r=e;o.a.throwIfNull(r,"speechConfig"),null!==t&&(this.audioConfig=void 0===t?"undefined"==typeof window?void 0:c.rU.fromDefaultSpeakerOutput():t),this.privProperties=r.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.privConnectionFactory=new ei,this.synthesisRequestQueue=new si.c,this.implCommonSynthesizeSetup()}get authorizationToken(){return this.properties.getProperty(z.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){o.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(z.o.SpeechServiceAuthorization_Token,e)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(z.o.SpeechServiceConnection_AutoDetectSourceLanguages)===_.AutoDetectSourceLanguagesOpenRangeOptionName}static FromConfig(e,t,r){const i=e;return t.properties.mergeTo(i.properties),new di(e,r)}buildSsml(e){let t=this.properties.getProperty(z.o.SpeechServiceConnection_SynthLanguage,"en-US"),r=this.properties.getProperty(z.o.SpeechServiceConnection_SynthVoice,""),i=di.XMLEncode(e);return this.autoDetectSourceLanguage?t="en-US":r=r||{"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-JennyNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"}[t],r&&(i=`<voice name='${r}'>${i}</voice>`),i=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${t}'>${i}</speak>`,i}speakTextAsync(e,t,r,i){this.speakImpl(e,!1,t,r,i)}speakSsmlAsync(e,t,r,i){this.speakImpl(e,!0,t,r,i)}getVoicesAsync(e=""){return ui(this,void 0,void 0,(function*(){return this.getVoices(e)}))}close(e,t){o.a.throwIfDisposed(this.privDisposed),(0,Q.Kb)(this.dispose(!0),e,t)}get internalData(){return this.privAdapter}dispose(e){return ui(this,void 0,void 0,(function*(){this.privDisposed||(e&&this.privAdapter&&(yield this.privAdapter.dispose()),this.privDisposed=!0)}))}createSynthesizerConfig(e){return new ti(e,this.privProperties)}createSynthesisAdapter(e,t,r,i){return new Pe.E(e,t,i,this,this.audioConfig)}implCommonSynthesizeSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const i=this.createSynthesizerConfig(new G.pu(new G._y(new G.OS(e,t,r)))),n=this.privProperties.getProperty(z.o.SpeechServiceConnection_Key,void 0),o=n&&""!==n?new ri.U(n):new vr.w((()=>{const e=this.privProperties.getProperty(z.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}),(()=>{const e=this.privProperties.getProperty(z.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(e)}));this.privAdapter=this.createSynthesisAdapter(o,this.privConnectionFactory,this.audioConfig,i),this.privAdapter.audioOutputFormat=$e.d.fromSpeechSynthesisOutputFormat(M.Y[this.properties.getProperty(z.o.SpeechServiceConnection_SynthOutputFormat,void 0)]),this.privRestAdapter=new ii(i,o)}speakImpl(e,t,r,i,n){try{o.a.throwIfDisposed(this.privDisposed);const s=(0,Je.Q)();let a;a=n instanceof l.y?new u.KS(n):n instanceof u.Ao?n:void 0!==n?new ai.O(n):void 0,this.synthesisRequestQueue.enqueue(new vi(s,e,t,(e=>{if(this.privSynthesizing=!1,r)try{r(e)}catch(e){i&&i(e)}r=void 0,this.adapterSpeak().catch((()=>{}))}),(e=>{i&&i(e)}),a)),this.adapterSpeak().catch((()=>{}))}catch(e){if(i)if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e);this.dispose(!0).catch((()=>{}))}}getVoices(e){return ui(this,void 0,void 0,(function*(){const t=(0,Je.Q)(),r=yield this.privRestAdapter.getVoicesList(t);if(r.ok&&Array.isArray(r.json)){let i=r.json;return e&&e.length>0&&(i=i.filter((t=>!!t.Locale&&t.Locale.toLowerCase()===e.toLowerCase()))),new hi(t,i,void 0)}return new hi(t,void 0,`Error: ${r.status}: ${r.statusText}`)}))}adapterSpeak(){return ui(this,void 0,void 0,(function*(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const e=yield this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(e.text,e.isSSML,e.requestId,e.cb,e.err,e.dataStream)}}))}static XMLEncode(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}class vi{constructor(e,t,r,i,n,o){this.requestId=e,this.text=t,this.isSSML=r,this.cb=i,this.err=n,this.dataStream=o}}var li,fi=r(6675),gi=r(9448),mi=r(6127),yi=r(6256),Si=r(7587);!function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"}(li||(li={}));var Ci,wi,Ri=r(2505);!function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"}(Ci||(Ci={})),function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"}(wi||(wi={}));class Pi{constructor(e,t=Ci.FivePoint,r=wi.Phoneme,i=!1){o.a.throwIfNullOrUndefined(e,"referenceText"),this.privProperties=new L.O,this.privProperties.setProperty(z.o.PronunciationAssessment_ReferenceText,e),this.privProperties.setProperty(z.o.PronunciationAssessment_GradingSystem,Ci[t]),this.privProperties.setProperty(z.o.PronunciationAssessment_Granularity,wi[r]),this.privProperties.setProperty(z.o.PronunciationAssessment_EnableMiscue,String(i))}static fromJSON(e){o.a.throwIfNullOrUndefined(e,"json");const t=new Pi("");return t.privProperties=new L.O,t.properties.setProperty(z.o.PronunciationAssessment_Json,e),t}toJSON(){return this.updateJson(),this.privProperties.getProperty(z.o.PronunciationAssessment_Params)}applyTo(e){this.updateJson(),e.internalData.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(z.o.PronunciationAssessment_Params))}get referenceText(){return this.properties.getProperty(z.o.PronunciationAssessment_ReferenceText)}set referenceText(e){o.a.throwIfNullOrWhitespace(e,"referenceText"),this.properties.setProperty(z.o.PronunciationAssessment_ReferenceText,e)}set phonemeAlphabet(e){o.a.throwIfNullOrWhitespace(e,"phonemeAlphabet"),this.privPhonemeAlphabet=e}set enableMiscue(e){const t=e?"true":"false";this.properties.setProperty(z.o.PronunciationAssessment_EnableMiscue,t)}get enableMiscue(){return"true"===this.properties.getProperty(z.o.PronunciationAssessment_EnableMiscue,"false").toLowerCase()}set nbestPhonemeCount(e){this.privNBestPhonemeCount=e}get properties(){return this.privProperties}updateJson(){const e=this.privProperties.getProperty(z.o.PronunciationAssessment_Json,"{}"),t=JSON.parse(e),r=this.privProperties.getProperty(z.o.PronunciationAssessment_ReferenceText);r&&(t.referenceText=r);const i=this.privProperties.getProperty(z.o.PronunciationAssessment_GradingSystem);i&&(t.gradingSystem=i);const n=this.privProperties.getProperty(z.o.PronunciationAssessment_Granularity);n&&(t.granularity=n),this.privPhonemeAlphabet&&(t.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(t.nbestPhonemeCount=this.privNBestPhonemeCount),t.dimension="Comprehensive",t.enableMiscue=this.enableMiscue,this.privProperties.setProperty(z.o.PronunciationAssessment_Params,JSON.stringify(t))}}class Ii{constructor(e){const t=JSON.parse(e);o.a.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){o.a.throwIfNullOrUndefined(e,"result");const t=e.properties.getProperty(z.o.SpeechServiceResponse_JsonResult);return o.a.throwIfNullOrUndefined(t,"json"),new Ii(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment.FluencyScore}}class bi{static SetLoggingLevel(e){this.privListener=new s(e),a.z.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(e){if("undefined"!=typeof window)throw new Error("File system logging not available in browser.");this.privListener&&(this.privListener.logPath=e)}}bi.privListener=void 0,a.z.instance.attachConsoleListener(new s)},6976:(e,t,r)=>{"use strict";r.d(t,{i:()=>n});var i=r(6845);class n{constructor(e,t,r,i){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=r,this.privProxyPassword=i}static fromParameters(e){return new n(e.getProperty(i.o.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(i.o.SpeechServiceConnection_ProxyPort),10),e.getProperty(i.o.SpeechServiceConnection_ProxyUserName),e.getProperty(i.o.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}},1569:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});class i{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privBytesPerSecond*1e-7);0!=t%2&&t++;let r=0;for(;r<this.privBuffers.length&&t>=this.privBuffers[r].chunk.buffer.byteLength;)t-=this.privBuffers[r++].chunk.buffer.byteLength;if(r<this.privBuffers.length){const e=this.privBuffers[r].chunk.buffer.slice(t);return this.privReplayOffset+=e.byteLength/this.privBytesPerSecond*1e7,r===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:e,isEnd:!1,timeReceived:this.privBuffers[r].chunk.timeReceived})}}return this.privAudioNode.read().then((e=>(e&&e.buffer&&(this.privBuffers.push(new n(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e)))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(void 0===this.privBuffers||0===this.privBuffers.length)return;this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let r=Math.round(t*this.privBytesPerSecond*1e-7),i=0;for(;i<this.privBuffers.length&&r>=this.privBuffers[i].chunk.buffer.byteLength;)r-=this.privBuffers[i++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-r/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(i)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const t of this.privBuffers){const r=t.byteOffset/this.privBytesPerSecond*1e7,i=r+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=r&&e<=i)return t.chunk.timeReceived}return 0}}class n{constructor(e,t,r){this.chunk=e,this.serial=t,this.byteOffset=r}}},6081:(e,t,r)=>{"use strict";r.d(t,{i:()=>T});var i=r(9233),n=r(7626),o=r(146),s=r(173),a=r(3108),c=r.n(a),p=r(9847),h=r.n(p),u=r(1137),d=r.n(u),v=r(4004),l=r(249),f=r(4260),g=r(4588),m=r(1543),y=r(3114),S=r(6898);class C{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}var w=r(2919),R=r(6450),P=r(4438),I=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class b{constructor(e,t,r,n,o,s){if(!e)throw new i.Do("uri");if(!r)throw new i.Do("messageFormatter");this.proxyInfo=n,this.privConnectionEvents=new l.n,this.privConnectionId=t,this.privMessageFormatter=r,this.privConnectionState=f.e.None,this.privUri=e,this.privHeaders=o,this.privEnableCompression=s,this.privHeaders[v.S.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===f.e.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new g.BH,this.privCertificateValidatedDeferral=new g.BH,this.privConnectionState=f.e.Connecting;try{if("undefined"==typeof WebSocket||b.forceNpmWebSocket){const e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve(),e.agent=this.getAgent();let t=new URL(this.privUri).protocol;"wss:"===(null==t?void 0:t.toLocaleLowerCase())?t="https:":"ws:"===(null==t?void 0:t.toLocaleLowerCase())&&(t="http:"),e.agent.protocol=t,this.privWebsocketClient=new(d())(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new m.c,this.privDisconnectDeferral=new g.BH,this.privSendMessageQueue=new m.c,this.processSendQueue().catch((e=>{y.z.instance.onEvent(new S.u(e))}))}catch(e){return this.privConnectionEstablishDeferral.resolve(new C(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new w.YF(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then((()=>{this.privConnectionState=f.e.Connected,this.onEvent(new w.Zk(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new C(200,""))}),(e=>{this.privConnectionEstablishDeferral.reject(e)}))},this.privWebsocketClient.onerror=e=>{this.onEvent(new w.K4(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===f.e.Connecting?(this.privConnectionState=f.e.Disconnected,this.privConnectionEstablishDeferral.resolve(new C(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=f.e.Disconnected,this.privWebsocketClient=null,this.onEvent(new w.PE(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch((e=>{y.z.instance.onEvent(new S.u(e))}))},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===f.e.Connected){const r=new g.BH;if(this.privReceivingMessageQueue.enqueueFromPromise(r.promise),e.data instanceof ArrayBuffer){const i=new R.S(P.C.Binary,e.data);this.privMessageFormatter.toConnectionMessage(i).then((e=>{this.onEvent(new w.Qz(this.privConnectionId,t,e)),r.resolve(e)}),(e=>{r.reject(`Invalid binary message format. Error: ${e}`)}))}else{const i=new R.S(P.C.Text,e.data);this.privMessageFormatter.toConnectionMessage(i).then((e=>{this.onEvent(new w.Qz(this.privConnectionId,t,e)),r.resolve(e)}),(e=>{r.reject(`Invalid text message format. Error: ${e}`)}))}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==f.e.Connected)return Promise.reject(`Cannot send on connection that is in ${f.e[this.privConnectionState]} state`);const t=new g.BH,r=new g.BH;return this.privSendMessageQueue.enqueueFromPromise(r.promise),this.privMessageFormatter.fromConnectionMessage(e).then((i=>{r.resolve({Message:e,RawWebsocketMessage:i,sendStatusDeferral:t})}),(e=>{r.reject(`Error formatting the message. ${e}`)})),t.promise}read(){return this.privConnectionState!==f.e.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){return this.privWebsocketClient?(this.privConnectionState!==f.e.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(e){try{return e?(this.onEvent(new w.w2(this.privConnectionId,(new Date).toISOString(),e.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(e.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+(new Error).stack)):Promise.resolve()}catch(e){return Promise.reject(`websocket send error: ${e}`)}}onClose(e,t){return I(this,void 0,void 0,(function*(){const r=`Connection closed. ${e}: ${t}`;this.privConnectionState=f.e.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose((()=>{}),r),yield this.privSendMessageQueue.drainAndDispose((e=>{e.sendStatusDeferral.reject(r)}),r)}))}processSendQueue(){return I(this,void 0,void 0,(function*(){for(;;){const e=this.privSendMessageQueue.dequeue(),t=yield e;if(!t)return;try{yield this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(e){t.sendStatusDeferral.reject(e)}}}))}onEvent(e){this.privConnectionEvents.onEvent(e),y.z.instance.onEvent(e)}getAgent(){const e=new(c().Agent)(this.createConnection);return void 0!==this.proxyInfo&&void 0!==this.proxyInfo.HostName&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){const t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${void 0===e.Password?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new(h())(t)}createConnection(e,t){let r;if(t=Object.assign(Object.assign({},t),{requestOCSP:!0,servername:t.host}),this.proxyInfo){const i=b.GetProxyAgent(this.proxyInfo);r=new Promise(((r,n)=>{i.callback(e,t,((e,t)=>{e?n(e):r(t)}))}))}else r=t.secureEndpoint?Promise.resolve(s.connect(t)):Promise.resolve(o.connect(t));return r}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}b.forceNpmWebSocket=!1;class T{constructor(e,t,r,o,s,a=!1,c){if(this.privIsDisposed=!1,!e)throw new i.Do("uri");if(!o)throw new i.Do("messageFormatter");this.privMessageFormatter=o;let p="",h=0;if(t)for(const r in t)if(r){p+=0===h&&-1===e.indexOf("?")?"?":"&",p+=encodeURIComponent(r);let i=t[r];i&&(i=encodeURIComponent(i),p+=`=${i}`),h++}if(r)for(const t in r)t&&(p+=0===h&&-1===e.indexOf("?")?"?":"&",p+=`${t}=${encodeURIComponent(r[t])}`,h++);this.privUri=e+p,this.privId=c||(0,n.Q)(),this.privConnectionMessageAdapter=new b(this.privUri,this.id,this.privMessageFormatter,s,r,a)}dispose(){return e=this,t=void 0,i=function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())},new((r=void 0)||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}));var e,t,r,i}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}},7030:(e,t,r)=>{"use strict";r.d(t,{H:()=>i});class i{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}},9253:(e,t,r)=>{"use strict";r.d(t,{U:()=>s});var i=r(9233),n=r(4004),o=r(2818);class s{constructor(e){if(!e)throw new i.Do("subscriptionKey");this.privAuthInfo=new o.G(n.S.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}}},9228:(e,t,r)=>{"use strict";r.d(t,{w:()=>s});var i=r(9233),n=r(2818),o=r(4004);class s{constructor(e,t){if(!e)throw new i.Do("fetchCallback");if(!t)throw new i.Do("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then((e=>new n.G(o.S.Authorization,void 0===e?void 0:s.privTokenPrefix+e)))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then((e=>new n.G(o.S.Authorization,void 0===e?void 0:s.privTokenPrefix+e)))}}s.privTokenPrefix="bearer "},872:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var i=r(4484),n=r(6845),o=r(5587);class s{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,r){new Map([[n.o.Speech_SegmentationSilenceTimeoutMs,o.o.SegmentationSilenceTimeoutMs],[n.o.SpeechServiceConnection_EnableAudioLogging,o.o.EnableAudioLogging],[n.o.SpeechServiceConnection_EndSilenceTimeoutMs,o.o.EndSilenceTimeoutMs],[n.o.SpeechServiceConnection_InitialSilenceTimeoutMs,o.o.InitialSilenceTimeoutMs],[n.o.SpeechServiceResponse_PostProcessingOption,o.o.Postprocessing],[n.o.SpeechServiceResponse_ProfanityOption,o.o.Profanity],[n.o.SpeechServiceResponse_RequestWordLevelTimestamps,o.o.EnableWordLevelTimestamps],[n.o.SpeechServiceResponse_StablePartialResultThreshold,o.o.StableIntermediateThreshold]]).forEach(((i,n)=>{this.setUrlParameter(n,i,e,t,r)}));const s=JSON.parse(e.parameters.getProperty(i.ServicePropertiesPropertyName,"{}"));Object.keys(s).forEach((e=>{t[e]=s[e]}))}setUrlParameter(e,t,r,i,n){const o=r.parameters.getProperty(e,void 0);!o||n&&-1!==n.search(t)||(i[t]=o.toLocaleLowerCase())}}},7569:(e,t,r)=>{"use strict";r.d(t,{o:()=>a});var i=r(2543),n=r(8328),o=r(3198),s=r(1508);class a{static implTranslateRecognitionResult(e){let t=i.s.Canceled;switch(e){case s.T.Success:t=i.s.RecognizedSpeech;break;case s.T.NoMatch:case s.T.InitialSilenceTimeout:case s.T.BabbleTimeout:case s.T.EndOfDictation:t=i.s.NoMatch;break;case s.T.Error:case s.T.BadRequest:case s.T.Forbidden:default:t=i.s.Canceled}return t}static implTranslateCancelResult(e){let t=n._.EndOfStream;switch(e){case s.T.Success:case s.T.EndOfDictation:case s.T.NoMatch:t=n._.EndOfStream;break;case s.T.InitialSilenceTimeout:case s.T.BabbleTimeout:case s.T.Error:case s.T.BadRequest:case s.T.Forbidden:default:t=n._.Error}return t}static implTranslateCancelErrorCode(e){let t=o.E.NoError;switch(e){case s.T.Error:t=o.E.ServiceError;break;case s.T.TooManyRequests:t=o.E.TooManyRequests;break;case s.T.BadRequest:t=o.E.BadRequestParameters;break;case s.T.Forbidden:t=o.E.Forbidden;break;default:t=o.E.NoError}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case o.E.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case o.E.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case o.E.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return t}}},4484:(e,t,r)=>{"use strict";r.d(t,{AutoDetectSourceLanguagesOpenRangeOptionName:()=>a,CancellationErrorCodePropertyName:()=>n,ForceDictationPropertyName:()=>s,OutputFormatPropertyName:()=>i,ServicePropertiesPropertyName:()=>o});const i="OutputFormat",n="CancellationErrorCode",o="ServiceProperties",s="ForceDictation",a="OpenRange"},4004:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});class i{}i.AuthKey="Ocp-Apim-Subscription-Key",i.Authorization="Authorization",i.SpIDAuthKey="Apim-Subscription-Id",i.ConnectionId="X-ConnectionId",i.ContentType="Content-Type",i.CustomCommandsAppId="X-CommandsAppId",i.Path="Path",i.RequestId="X-RequestId",i.RequestStreamId="X-StreamId",i.RequestTimestamp="X-Timestamp"},2818:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});class i{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}},5587:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});class i{}i.BotId="botid",i.CustomSpeechDeploymentId="cid",i.CustomVoiceDeploymentId="deploymentId",i.EnableAudioLogging="storeAudio",i.EnableLanguageId="lidEnabled",i.EnableWordLevelTimestamps="wordLevelTimestamps",i.EndSilenceTimeoutMs="endSilenceTimeoutMs",i.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",i.Format="format",i.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",i.Language="language",i.Profanity="profanity",i.RequestBotStatusMessages="enableBotMessageStatus",i.StableIntermediateThreshold="stableIntermediateThreshold",i.StableTranslation="stableTranslation",i.TestHooks="testhooks",i.Postprocessing="postprocessing",i.CtsMeetingId="meetingId",i.CtsDeviceId="deviceId",i.CtsIsParticipant="isParticipant"},4435:(e,t,r)=>{"use strict";r.d(t,{OS:()=>d,Xj:()=>c,_y:()=>h,dt:()=>s,jf:()=>i,pu:()=>p,wF:()=>o});var i,n,o,s,a=r(6845);!function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(i||(i={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(n||(n={}));class c{constructor(e,t){this.privSpeechServiceConfig=e||new p(new h(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(a.o.SpeechServiceConnection_LanguageIdMode,void 0)}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===i.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=i[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==i.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(a.o.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(a.o.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const e=[];let t=!1;if(void 0!==this.autoDetectSourceLanguages)for(const r of this.autoDetectSourceLanguages.split(",")){const i=r+a.o.SpeechServiceConnection_EndpointId.toString(),n=this.parameters.getProperty(i,void 0);void 0!==n?(e.push({language:r,endpoint:n}),t=!0):e.push({language:r,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}}class p{constructor(e){this.context=e}serialize(){return JSON.stringify(this,((e,t)=>{if(t&&"object"==typeof t){const e={};for(const r in t)Object.hasOwnProperty.call(t,r)&&(e[r&&r.charAt(0).toLowerCase()+r.substring(1)]=t[r]);return e}return t}))}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class h{constructor(e){this.system=new u,this.os=e}}class u{constructor(){this.name="SpeechSDK",this.version="1.29.0",this.build="JavaScript",this.lang="JavaScript"}}class d{constructor(e,t,r){this.platform=e,this.name=t,this.version=r}}!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(o||(o={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(s||(s={}))},414:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var i=r(1508);class n{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=i.T[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new n(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(const e of this.privDetailedSpeechPhrase.NBest)if(e.Words&&e.Words[0]){t=e.Words[0].Offset;break}if(t&&t<e){const r=e-t;for(const e of this.privDetailedSpeechPhrase.NBest){if(e.Words)for(const t of e.Words)t.Offset+=r;if(e.DisplayWords)for(const t of e.DisplayWords)t.Offset+=r}}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}},1508:(e,t,r)=>{"use strict";var i,n;r.d(t,{T:()=>n,g:()=>i}),function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(i||(i={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"}(n||(n={}))},2642:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var i=r(1508);class n{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=i.T[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new n(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}},8072:(e,t,r)=>{"use strict";r.d(t,{s:()=>i});class i{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new i(e)}get Offset(){return this.privSpeechStartDetected.Offset}}},1089:(e,t,r)=>{"use strict";r.d(t,{r:()=>i});class i{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new i(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}},149:(e,t,r)=>{"use strict";r.d(t,{q:()=>N});var i,n=r(1569),o=r(9233),s=r(249),a=r(2088),c=r(4438),p=r(2919),h=r(4260),u=r(7626),d=r(8328),v=r(3198),l=r(6845),f=r(1610),g=r(7602),m=r(4588),y=r(3114),S=r(7552);class C extends S.A{constructor(e,t,r,i=S.t.Info){super(e,i),this.privRequestId=t,this.privSessionId=r}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class w extends C{constructor(e,t,r,i){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class R extends C{constructor(e,t,r,i){super("ListeningStartedEvent",e,t),this.privAudioSourceId=r,this.privAudioNodeId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class P extends C{constructor(e,t,r){super("ConnectingToServiceEvent",e,r),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class I extends C{constructor(e,t,r,i,n){super("RecognitionStartedEvent",e,n),this.privAudioSourceId=t,this.privAudioNodeId=r,this.privAuthFetchEventId=i}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(i||(i={}));var b=r(2148);class T{constructor(e,t,r){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=r,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){if(!this.privIsDisposed&&(e instanceof w&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof b.i5&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof b.sQ&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof b.n0&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof b.hA&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof b.He&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof P&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof p.YF&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof p.Zk&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof p.xz&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof p.Qz&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path)){this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array);const t=50;this.privReceivedMessages[e.message.headers.path].length<t&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)}}getTelemetry(){const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},r=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],r}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}}var E=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class A{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=(0,u.Q)(),this.privAudioNodeId=(0,u.Q)(),this.privTurnDeferral=new m.BH,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new T(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new w(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return E(this,void 0,void 0,(function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new R(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}))}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new P(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return E(this,void 0,void 0,(function*(){e&&(yield this.onComplete())}))}onConnectionEstablishCompleted(e,t){return E(this,void 0,void 0,(function*(){if(200===e)return this.onEvent(new I(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&(yield this.onComplete())}))}onServiceTurnEndResponse(e){return E(this,void 0,void 0,(function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}))}onSpeechContext(){this.privRequestId=(0,u.Q)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new m.BH}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return E(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}))}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return E(this,void 0,void 0,(function*(){yield this.onComplete()}))}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),y.z.instance.onEvent(e)}onComplete(){return E(this,void 0,void 0,(function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())}))}detachAudioNode(){return E(this,void 0,void 0,(function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))}))}}class k{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e=>{t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}}class x{constructor(e){this.privContext={},this.privDynamicGrammar=e}getSection(e){return this.privContext[e]||{}}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e){void 0===this.privContext.phraseDetection&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),-1===this.privContext.phraseOutput.detailed.options.indexOf("SNR")&&this.privContext.phraseOutput.detailed.options.push("SNR")}setWordLevelTimings(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",-1===this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}}var O=r(7030),D=r(4435),_=r(8072),z=r(5407),L=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class N{constructor(e,t,r,i,n){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new o.Do("authentication");if(!t)throw new o.Do("connectionFactory");if(!r)throw new o.Do("audioSource");if(!i)throw new o.Do("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=r,this.privRecognizerConfig=i,this.privIsDisposed=!1,this.privRecognizer=n,this.privRequestSession=new A(this.privAudioSource.id()),this.privConnectionEvents=new s.n,this.privServiceEvents=new s.n,this.privDynamicGrammar=new k,this.privSpeechContext=new x(this.privDynamicGrammar),this.privAgentConfig=new O.H,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=a.V.setTimeout),this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;(1003===t.statusCode||1007===t.statusCode||1002===t.statusCode||4e3===t.statusCode||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(d._.Error,1007===t.statusCode?v.E.BadRequestParameters:v.E.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}));const c={};if(void 0!==i.autoDetectSourceLanguages){const e=i.autoDetectSourceLanguages.split(",");let t;t="Continuous"===i.languageIdMode?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:e,mode:t,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const r=i.sourceLanguageModels;void 0!==r&&(c.customModels=r,c.onInterim={action:"None"},c.onSuccess={action:"None"})}(e=>{for(const t in e)return!1;return!0})(c)||this.privSpeechContext.setSection("phraseDetection",c)}setSpeechSegmentationTimeout(){const e=this.privRecognizerConfig.parameters.getProperty(l.o.Speech_SegmentationSilenceTimeoutMs,void 0);if(void 0!==e){const t=this.recognitionMode===D.jf.Conversation?"CONVERSATION":this.recognitionMode===D.jf.Dictation?"DICTATION":"INTERACTIVE",r=parseInt(e,10),i=this.privSpeechContext.getSection("phraseDetection");i.mode=t,i[t]={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:r}},this.privSpeechContext.setSection("phraseDetection",i)}}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(l.o.ConversationTranslator_Token,e)}set voiceProfileType(e){this.privRecognizerConfig.parameters.setProperty(l.o.SpeechServiceConnection_SpeakerIdMode,e)}set authentication(e){this.privAuthentication=this.authentication}isDisposed(){return this.privIsDisposed}dispose(e){return L(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privConnectionConfigurationPromise)try{const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}catch(e){return}}))}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,r){return L(this,void 0,void 0,(function*(){if(void 0!==this.recognizeOverride)return void(yield this.recognizeOverride(e,t,r));this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.setSpeechSegmentationTimeout(),this.privSuccessCallback=t,this.privErrorCallback=r,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const i=this.connectImpl();let o;try{const e=yield this.audioSource.attach(this.privRequestSession.audioNodeId),t=yield this.audioSource.format,r=yield this.audioSource.deviceInfo;this.privIsLiveAudio=r.type&&r.type===D.dt.Microphones,o=new n.C(e,t.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(o,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:r}}catch(e){throw yield this.privRequestSession.onStopRecognizing(),e}try{yield i}catch(e){return void(yield this.cancelRecognitionLocal(d._.Error,v.E.ConnectionFailure,e))}const s=new f.$(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,s),this.receiveMessage(),this.sendAudio(o).catch((e=>L(this,void 0,void 0,(function*(){yield this.cancelRecognitionLocal(d._.Error,v.E.RuntimeError,e)}))))}))}stopRecognizing(){return L(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}}))}connect(){return L(this,void 0,void 0,(function*(){return yield this.connectImpl(),Promise.resolve()}))}connectAsync(e,t){this.connectImpl().then((()=>{try{e&&e()}catch(e){t&&t(e)}}),(e=>{try{t&&t(e)}catch(e){}}))}disconnect(){return L(this,void 0,void 0,(function*(){if(yield this.cancelRecognitionLocal(d._.Error,v.E.NoError,"Disconnecting"),void 0!==this.disconnectOverride&&(yield this.disconnectOverride()),void 0!==this.privConnectionPromise)try{yield(yield this.privConnectionPromise).dispose()}catch(e){}this.privConnectionPromise=void 0}))}sendMessage(e){}sendNetworkMessage(e,t){return L(this,void 0,void 0,(function*(){const r="string"==typeof t?c.C.Text:c.C.Binary,i="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new z.r(r,e,this.privRequestSession.requestId,i,t))}))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return L(this,void 0,void 0,(function*(){const e=this.privRequestSession.getTelemetry();if(!0!==N.telemetryDataEnabled||this.privIsDisposed||null===e)return;if(N.telemetryData)try{N.telemetryData(e)}catch(e){}const t=yield this.fetchConnection();yield t.send(new z.r(c.C.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}))}cancelRecognitionLocal(e,t,r){return L(this,void 0,void 0,(function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,r))}))}receiveMessage(){return L(this,void 0,void 0,(function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection();const t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(!t)return this.privRequestSession.isRecognizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const r=z.r.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const t=_.s.fromJSON(r.textBody),i=new g.J(t.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,i);break;case"speech.enddetected":let n;n=r.textBody.length>0?r.textBody:"{ Offset: 0 }";const o=_.s.fromJSON(n),s=new g.J(o.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,s);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(d._.EndOfStream,v.E.NoError,void 0));const a=new f.$(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,a));e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(r))||this.privServiceEvents&&this.serviceEvents.onEvent(new p.e2(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch(e){return null}}))}sendSpeechContext(e,t){const r=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),r)return e.send(new z.r(c.C.Text,"speech.context",this.privRequestSession.requestId,"application/json",r))}noOp(){}sendPrePayloadJSON(e,t=!0){return L(this,void 0,void 0,(function*(){if(void 0!==this.sendPrePayloadJSONOverride)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)}))}sendWaveHeader(e){return L(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;return e.send(new z.r(c.C.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))}))}connectImpl(){return void 0!==this.privConnectionPromise?this.privConnectionPromise.then((e=>e.state()===h.e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()))):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch((()=>{})),void 0!==this.postConnectImplOverride?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,r){if(t.onSpeechContext(),!0!==N.telemetryDataEnabled){const e={context:{system:JSON.parse(r).context.system}};r=JSON.stringify(e)}if("true"===this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()){const e=JSON.parse(r);e.context.DisableReferenceChannel="True",e.context.MicSpec="1_0_0",r=JSON.stringify(e)}if(r)return e.send(new z.r(c.C.Text,"speech.config",t.requestId,"application/json",r))}fetchConnection(){return L(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===h.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}sendAudio(e){return L(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;let r=Date.now();const i=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),n=t.avgBytesPerSec/1e3*parseInt(i,10),o=this.privRequestSession.recogNumber,s=()=>L(this,void 0,void 0,(function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){const i=yield this.fetchConnection(),a=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let p,h;if(!a||a.isEnd?(p=null,h=0):(p=a.buffer,this.privRequestSession.onAudioSent(p.byteLength),h=n>=this.privRequestSession.bytesSent?0:Math.max(0,r-Date.now())),0!==h&&(yield this.delay(h)),null!==p&&(r=Date.now()+1e3*p.byteLength/(2*t.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===o){if(i.send(new z.r(c.C.Binary,"audio",this.privRequestSession.requestId,null,p)).catch((()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch((()=>{}))})),!(null==a?void 0:a.isEnd))return s();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}}));return s()}))}retryableConnect(){return L(this,void 0,void 0,(function*(){let e=!1;this.privAuthFetchEventId=(0,u.Q)();const t=this.privRequestSession.sessionId;this.privConnectionId=void 0!==t?t:(0,u.Q)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let r=0,i="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),n=yield t;yield this.privRequestSession.onAuthCompleted(!1);const o=this.privConnectionFactory.create(this.privRecognizerConfig,n,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(o.events),o.events.attach((e=>{this.connectionEvents.onEvent(e)}));const s=yield o.open();if(200===s.statusCode)return yield this.privRequestSession.onConnectionEstablishCompleted(s.statusCode),Promise.resolve(o);1006===s.statusCode&&(e=!0),r=s.statusCode,i=s.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(r,i),Promise.reject(`Unable to contact server. StatusCode: ${r}, ${this.privRecognizerConfig.parameters.getProperty(l.o.SpeechServiceConnection_Endpoint)} Reason: ${i}`)}))}delay(e){return new Promise((t=>this.privSetTimeout(t,e)))}writeBufferToConsole(e){let t="Buffer Size: ";if(null===e)t+="null";else{const r=new Uint8Array(e);t+=`${e.byteLength}\r\n`;for(let i=0;i<e.byteLength;i++)t+=r[i].toString(16).padStart(2,"0")+" ",(i+1)%16==0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return L(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();yield e.send(new z.r(c.C.Binary,"audio",this.privRequestSession.requestId,null,null))}))}configureConnection(){return L(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)}))}}N.telemetryDataEnabled=!0},5407:(e,t,r)=>{"use strict";r.d(t,{r:()=>s});var i=r(4438),n=r(9233),o=r(4004);class s extends i.H{constructor(e,t,r,i,s,a,c,p){if(!t)throw new n.Do("path");if(!r)throw new n.Do("requestId");const h={};if(h[o.S.Path]=t,h[o.S.RequestId]=r,h[o.S.RequestTimestamp]=(new Date).toISOString(),i&&(h[o.S.ContentType]=i),a&&(h[o.S.RequestStreamId]=a),c)for(const e in c)e&&(h[e]=c[e]);p?super(e,s,h,p):super(e,s,h),this.privPath=t,this.privRequestId=r,this.privContentType=i,this.privStreamId=a,this.privAdditionalHeaders=c}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,r=null,i=null,n=null;const a={};if(e.headers)for(const s in e.headers)s&&(s.toLowerCase()===o.S.Path.toLowerCase()?t=e.headers[s]:s.toLowerCase()===o.S.RequestId.toLowerCase()?r=e.headers[s]:s.toLowerCase()===o.S.ContentType.toLowerCase()?i=e.headers[s]:s.toLowerCase()===o.S.RequestStreamId.toLowerCase()?n=e.headers[s]:a[s]=e.headers[s]);return new s(e.messageType,t,r,i,e.body,n,a,e.id)}}},8985:(e,t,r)=>{"use strict";r.d(t,{E:()=>N});var i,n=r(9233),o=r(249),s=r(4438),a=r(2919),c=r(4260),p=r(7626),h=r(8328),u=r(3198),d=r(9448),v=r(6675),l=r(2543),f=r(2935),g=r(6127),m=r(6256),y=r(7587),S=r(6845),C=r(4588),w=r(3114),R=r(5857);!function(e){e.WordBoundary="WordBoundary",e.Bookmark="Bookmark",e.Viseme="Viseme",e.SentenceBoundary="SentenceBoundary",e.SessionEnd="SessionEnd"}(i||(i={}));class P{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new P(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}var I=r(7552);class b extends I.A{constructor(e,t,r=I.t.Info){super(e,r),this.privRequestId=t}get requestId(){return this.privRequestId}}class T extends b{constructor(e,t,r){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=r}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class E extends b{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class A extends b{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}var k=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class x{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,p.Q)(),this.privTurnDeferral=new C.BH,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}getAllReceivedAudio(){return k(this,void 0,void 0,(function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}))}getAllReceivedAudioWithHeader(){return k(this,void 0,void 0,(function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=N.addHeader(e,this.audioOutputFormat),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}))}startNewSynthesis(e,t,r,i){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=r,this.privAudioOutputStream=new R.NO,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",void 0!==i&&(this.privTurnAudioDestination=i,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new T(this.requestId,void 0,void 0===i?void 0:i.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new E(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(200===e)return this.onEvent(new A(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===e&&this.onComplete()}onServiceResponseMessage(e){const t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new C.BH}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){void 0!==e.Data.AnimationChunk&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){w.z.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&"<"===e[0]&&">"===e[e.length-1]}updateTextOffset(e,t){t===i.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!x.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!x.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return k(this,void 0,void 0,(function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}}))}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}}class O{constructor(e){this.privContext={},this.privSpeechSynthesizer=e}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){const e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,punctuationBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestPunctuationBoundary,!!this.privSpeechSynthesizer.wordBoundary),sentenceBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(S.o.SpeechServiceResponse_RequestWordBoundary,!!this.privSpeechSynthesizer.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}}var D=r(7030),_=r(4484),z=r(5407),L=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class N{constructor(e,t,r,i,s){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new n.Do("authentication");if(!t)throw new n.Do("connectionFactory");if(!r)throw new n.Do("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=r,this.privIsDisposed=!1,this.privSpeechSynthesizer=i,this.privSessionAudioDestination=s,this.privSynthesisTurn=new x,this.privConnectionEvents=new o.n,this.privServiceEvents=new o.n,this.privSynthesisContext=new O(this.privSpeechSynthesizer),this.privAgentConfig=new D.H,this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;1e3!==t.statusCode&&this.cancelSynthesisLocal(h._.Error,1007===t.statusCode?u.E.BadRequestParameters:u.E.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}))}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)}static addHeader(e,t){if(!t.hasHeader)return e;t.updateHeader(e.byteLength);const r=new Uint8Array(e.byteLength+t.header.byteLength);return r.set(new Uint8Array(t.header),0),r.set(new Uint8Array(e),t.header.byteLength),r.buffer}isDisposed(){return this.privIsDisposed}dispose(e){return L(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),void 0!==this.privConnectionConfigurationPromise){const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}}))}connect(){return L(this,void 0,void 0,(function*(){yield this.connectImpl()}))}sendNetworkMessage(e,t){return L(this,void 0,void 0,(function*(){const r="string"==typeof t?s.C.Text:s.C.Binary,i="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new z.r(r,e,this.privSynthesisTurn.requestId,i,t))}))}Speak(e,t,r,i,n,o){return L(this,void 0,void 0,(function*(){let s;if(s=t?e:this.privSpeechSynthesizer.buildSsml(e),void 0!==this.speakOverride)return this.speakOverride(s,r,i,n);this.privSuccessCallback=i,this.privErrorCallback=n,this.privSynthesisTurn.startNewSynthesis(r,e,t,o);try{yield this.connectImpl();const e=yield this.fetchConnection();yield this.sendSynthesisContext(e),yield this.sendSsmlMessage(e,s,r);const t=new d.c(new v.P(r,l.s.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t),this.receiveMessage()}catch(e){return this.cancelSynthesisLocal(h._.Error,u.E.ConnectionFailure,e),Promise.reject(e)}}))}cancelSynthesis(e,t,r,i){const n=new f.O;n.setProperty(_.CancellationErrorCodePropertyName,u.E[r]);const o=new v.P(e,l.s.Canceled,void 0,i,n);if(this.privSpeechSynthesizer.SynthesisCanceled){const e=new d.c(o);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,e)}catch(e){}}if(this.privSuccessCallback)try{this.privSuccessCallback(o)}catch(e){}}cancelSynthesisLocal(e,t,r){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,r))}processTypeSpecificMessages(e){return!0}receiveMessage(){return L(this,void 0,void 0,(function*(){try{const e=yield this.fetchConnection(),t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const r=z.r.fromConnectionMessage(t);if(r.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(r.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(r.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===r.streamId.toLowerCase()&&r.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(r.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const e=N.addHeader(r.binaryBody,this.privSynthesisTurn.audioOutputFormat),t=new d.c(new v.P(this.privSynthesisTurn.requestId,l.s.SynthesizingAudio,e));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,t)}catch(e){}void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(r.binaryBody)}break;case"audio.metadata":const e=P.fromJSON(r.textBody).Metadata;for(const t of e)switch(t.Type){case i.WordBoundary:case i.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(t);const e=new g.G(t.Data.Offset,t.Data.Duration,t.Data.text.Text,t.Data.text.Length,t.Type===i.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,t.Data.text.BoundaryType);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch(e){}break;case i.Bookmark:const r=new m.i(t.Data.Offset,t.Data.Bookmark);if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,r)}catch(e){}break;case i.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(t),t.Data.IsLastAnimation){const e=new y.w(t.Data.Offset,t.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch(e){}}break;case i.SessionEnd:this.privSynthesisTurn.onSessionEnd(t)}break;case"turn.end":let t;this.privSynthesisTurn.onServiceTurnEndResponse();try{const e=yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();t=new v.P(this.privSynthesisTurn.requestId,l.s.SynthesizingAudioCompleted,e,void 0,void 0,this.privSynthesisTurn.audioDuration),this.privSuccessCallback&&this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new d.c(t))}catch(e){}break;default:this.processTypeSpecificMessages(r)||this.privServiceEvents&&this.serviceEvents.onEvent(new a.e2(r.path.toLowerCase(),r.textBody))}return this.receiveMessage()}catch(e){}}))}sendSynthesisContext(e){const t=this.synthesisContext.toJSON();if(t)return e.send(new z.r(s.C.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}connectImpl(e=!1){if(null!=this.privConnectionPromise)return this.privConnectionPromise.then((e=>e.state()===c.e.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl())));this.privAuthFetchEventId=(0,p.Q)(),this.privConnectionId=(0,p.Q)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then((t=>L(this,void 0,void 0,(function*(){this.privSynthesisTurn.onAuthCompleted(!1);const r=this.privConnectionFactory.create(this.privSynthesizerConfig,t,this.privConnectionId);r.events.attach((e=>{this.connectionEvents.onEvent(e)}));const i=yield r.open();return 200===i.statusCode?(this.privSynthesisTurn.onConnectionEstablishCompleted(i.statusCode),Promise.resolve(r)):403!==i.statusCode||e?(this.privSynthesisTurn.onConnectionEstablishCompleted(i.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${i.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(S.o.SpeechServiceConnection_Endpoint)} Reason: ${i.reason}`)):this.connectImpl(!0)}))),(e=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(e)})),this.privConnectionPromise.catch((()=>{})),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new z.r(s.C.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,r){return e.send(new z.r(s.C.Text,"ssml",r,"application/ssml+xml",t))}fetchConnection(){return L(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===c.e.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}configureConnection(){return L(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)}))}}N.telemetryDataEnabled=!0},9957:(e,t,r)=>{"use strict";r.d(t,{D:()=>s});var i=r(4588),n=r(4438),o=r(6450);class s{toConnectionMessage(e){const t=new i.BH;try{if(e.messageType===n.C.Text){const r=e.textContent;let i={},o=null;if(r){const e=r.split("\r\n\r\n");e&&e.length>0&&(i=this.parseHeaders(e[0]),e.length>1&&(o=e[1]))}t.resolve(new n.H(e.messageType,o,i,e.id))}else if(e.messageType===n.C.Binary){const r=e.binaryContent;let i={},o=null;if(!r||r.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const s=new DataView(r),a=s.getInt16(0);if(r.byteLength<a+2)throw new Error("Invalid binary message format. Header content missing.");let c="";for(let e=0;e<a;e++)c+=String.fromCharCode(s.getInt8(e+2));i=this.parseHeaders(c),r.byteLength>a+2&&(o=r.slice(2+a)),t.resolve(new n.H(e.messageType,o,i,e.id))}}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise}fromConnectionMessage(e){const t=new i.BH;try{if(e.messageType===n.C.Text){const r=`${this.makeHeaders(e)}\r\n${e.textBody?e.textBody:""}`;t.resolve(new o.S(n.C.Text,r,e.id))}else if(e.messageType===n.C.Binary){const r=this.makeHeaders(e),i=e.binaryBody,s=this.stringToArrayBuffer(r),a=new Int8Array(s),c=a.byteLength,p=new Int8Array(2+c+(i?i.byteLength:0));if(p[0]=c>>8&255,p[1]=255&c,p.set(a,2),i){const e=new Int8Array(i);p.set(e,2+c)}const h=p.buffer;t.resolve(new o.S(n.C.Binary,h,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(const r in e.headers)r&&(t+=`${r}: ${e.headers[r]}\r\n`);return t}parseHeaders(e){const t={};if(e){const r=e.match(/[^\r\n]+/g);if(t)for(const e of r)if(e){const r=e.indexOf(":"),i=r>0?e.substr(0,r).trim().toLowerCase():e,n=r>0&&e.length>r+1?e.substr(r+1).trim():"";t[i]=n}}return t}stringToArrayBuffer(e){const t=new ArrayBuffer(e.length),r=new DataView(t);for(let t=0;t<e.length;t++)r.setUint8(t,e.charCodeAt(t));return t}}},2148:(e,t,r)=>{"use strict";r.d(t,{He:()=>d,Jl:()=>s,QZ:()=>o,hA:()=>v,i5:()=>h,ls:()=>a,n0:()=>c,sQ:()=>u});var i=r(7552);class n extends i.A{constructor(e,t,r=i.t.Info){super(e,r),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class o extends n{constructor(e){super("AudioSourceInitializingEvent",e)}}class s extends n{constructor(e){super("AudioSourceReadyEvent",e)}}class a extends n{constructor(e){super("AudioSourceOffEvent",e)}}class c extends n{constructor(e,t){super("AudioSourceErrorEvent",e,i.t.Error),this.privError=t}get error(){return this.privError}}class p extends n{constructor(e,t,r){super(e,t),this.privAudioNodeId=r}get audioNodeId(){return this.privAudioNodeId}}class h extends p{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class u extends p{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class d extends p{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class v extends p{constructor(e,t,r){super("AudioStreamNodeErrorEvent",e,t),this.privError=r}get error(){return this.privError}}},6898:(e,t,r)=>{"use strict";r.d(t,{u:()=>n});var i=r(7552);class n extends i.A{constructor(e){super("BackgroundEvent",i.t.Error),this.privError=e}get error(){return this.privError}}},6168:(e,t,r)=>{"use strict";r.d(t,{L:()=>n});var i=r(1359);class n extends i.F{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const r=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),i=new Uint8Array(this.privNextBufferToWrite),n=new Uint8Array(e.buffer.slice(t,r+t));i.set(n,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=r,t+=r,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}},2919:(e,t,r)=>{"use strict";r.d(t,{K4:()=>p,PE:()=>c,Qz:()=>u,YF:()=>s,Zk:()=>a,e2:()=>n,w2:()=>d,xz:()=>h});var i=r(7552);class n extends i.A{constructor(e,t,r=i.t.Info){super(e,r),this.privJsonResult=t}get jsonString(){return this.privJsonResult}}class o extends i.A{constructor(e,t,r=i.t.Info){super(e,r),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class s extends o{constructor(e,t,r){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=r}get uri(){return this.privUri}get headers(){return this.privHeaders}}class a extends o{constructor(e){super("ConnectionEstablishedEvent",e)}}class c extends o{constructor(e,t,r){super("ConnectionClosedEvent",e,i.t.Debug),this.privReason=r,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class p extends o{constructor(e,t,r){super("ConnectionErrorEvent",e,i.t.Debug),this.privMessage=t,this.privType=r}get message(){return this.privMessage}get type(){return this.privType}}class h extends o{constructor(e,t,r){super("ConnectionEstablishErrorEvent",e,i.t.Error),this.privStatusCode=t,this.privReason=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class u extends o{constructor(e,t,r){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=r}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class d extends o{constructor(e,t,r){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=r}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}},4438:(e,t,r)=>{"use strict";r.d(t,{C:()=>i,H:()=>s});var i,n=r(9233),o=r(7626);!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(i||(i={}));class s{constructor(e,t,r,s){if(this.privBody=null,e===i.Text&&t&&"string"!=typeof t)throw new n.$2("Payload must be a string");if(e===i.Binary&&t&&!(t instanceof ArrayBuffer))throw new n.$2("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=r||{},this.privId=s||(0,o.Q)(),this.messageType){case i.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case i.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===i.Binary)throw new n.$2("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===i.Text)throw new n.$2("Not supported for text message");return this.privBody}get id(){return this.privId}}},9233:(e,t,r)=>{"use strict";r.d(t,{$2:()=>n,Do:()=>i,IV:()=>o});class i extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class n extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class o extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}},249:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var i=r(9233),n=r(7626);class o{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new i.IV("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){const t=(0,n.Q)();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach((t=>e.onEvent(t)))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach((t=>e.onEvent(t))),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}},3114:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});var i=r(9233),n=r(249);class o{static setEventSource(e){if(!e)throw new i.Do("eventSource");o.privInstance=e}static get instance(){return o.privInstance}}o.privInstance=new n.n},7626:(e,t,r)=>{"use strict";r.d(t,{c:()=>p,Q:()=>h});const i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const o=new Uint8Array(16);function s(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));const c=function(e,t,r){if(i.randomUUID&&!t&&!e)return i.randomUUID();const n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}(n)},p=()=>c(),h=()=>p().replace(new RegExp("-","g"),"").toUpperCase()},4260:(e,t,r)=>{"use strict";var i;r.d(t,{e:()=>i}),function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(i||(i={}))},7552:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,t:()=>i});var i,n=r(7626);!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.None=4]="None"}(i||(i={}));class o{constructor(e,t){this.privName=e,this.privEventId=(0,n.Q)(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}},4588:(e,t,r)=>{"use strict";var i;r.d(t,{BH:()=>n,Kb:()=>o}),function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(i||(i={}));class n{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise(((e,t)=>{this.privResolve=e,this.privReject=t}))}get promise(){return this.privPromise}}function o(e,t,r){e.then((e=>{try{t&&t(e)}catch(e){if(r)try{if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e)}catch(e){}}}),(e=>{if(r)try{if(e instanceof Error){const t=e;r(t.name+": "+t.message)}else r(e)}catch(e){}}))}},1543:(e,t,r)=>{"use strict";r.d(t,{c:()=>c});var i=r(9233);class n{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(const t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();const r=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),r}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){const e=Array();return this.privList.forEach((t=>{e.push(t)})),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();const t=[];for(let r=0;r<this.privList.length;r++)t.push(e(this.privList[r],r));return new n(t)}where(e){this.throwIfDisposed();const t=new n;for(let r=0;r<this.privList.length;r++)e(this.privList[r],r)&&t.add(this.privList[r]);return t}orderBy(e){this.throwIfDisposed();const t=this.toArray().sort(e);return new n(t)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy(((t,r)=>e(r,t)))}clone(){return this.throwIfDisposed(),new n(this.toArray())}concat(e){return this.throwIfDisposed(),new n(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new n(this.privList.concat(e))}isDisposed(){return null==this.privList}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new i.IV("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(const t in e)t&&e[t]()}}var o,s=r(4588),a=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(o||(o={}));class c{constructor(e){this.privPromiseStore=new n,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new n,this.privDetachables=[],this.privSubscribers=new n,this.privDetachables.push(this.privList.onAdded((()=>this.drain())))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise((t=>t(e))))}enqueueFromPromise(e){this.throwIfDispose(),e.then((e=>{this.privList.add(e)}),(()=>{}))}dequeue(){this.throwIfDispose();const e=new s.BH;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();const e=new s.BH;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:o.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return null==this.privSubscribers}drainAndDispose(e,t){return a(this,void 0,void 0,(function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const r=this.privSubscribers;if(r){for(;r.length()>0;)r.removeFirst().deferral.resolve(void 0);this.privSubscribers===r&&(this.privSubscribers=r)}for(const e of this.privDetachables)yield e.detach();if(this.privPromiseStore.length()>0&&e){const t=[];return this.privPromiseStore.toArray().forEach((e=>{t.push(e)})),Promise.all(t).finally((()=>{this.privSubscribers=null,this.privList.forEach((t=>{e(t)})),this.privList=null})).then()}this.privSubscribers=null,this.privList=null}}))}dispose(e){return a(this,void 0,void 0,(function*(){yield this.drainAndDispose(null,e)}))}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const r=e.removeFirst();if(r.type===o.Peek)r.deferral.resolve(t.first());else{const e=t.removeFirst();r.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed()){if(this.privDisposeReason)throw new i.$2(this.privDisposeReason);throw new i.IV("Queue")}if(this.privIsDisposing)throw new i.$2("Queue disposing")}}},6450:(e,t,r)=>{"use strict";r.d(t,{S:()=>s});var i=r(4438),n=r(9233),o=r(7626);class s{constructor(e,t,r){if(this.privPayload=null,!t)throw new n.Do("payload");if(e===i.C.Binary&&"ArrayBuffer"!==t.__proto__.constructor.name)throw new n.$2("Payload must be ArrayBuffer");if(e===i.C.Text&&"string"!=typeof t)throw new n.$2("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=r||(0,o.Q)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===i.C.Binary)throw new n.$2("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===i.C.Text)throw new n.$2("Not supported for text message");return this.privPayload}get id(){return this.privId}}},1359:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});var i=r(9233),n=r(7626),o=r(1543);class s{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||(0,n.Q)(),this.privReaderQueue=new o.c}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(e){}}read(){if(this.privIsReadEnded)throw new i.$2("Stream read has already finished");return this.privReaderQueue.dequeue().then((e=>{return t=this,r=void 0,n=function*(){return(void 0===e||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e},new((i=void 0)||(i=Promise))((function(e,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}c((n=n.apply(t,r||[])).next())}));var t,r,i,n}))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new o.c)}throwIfClosed(){if(this.privIsWriteEnded)throw new i.$2("Stream closed")}}},2088:(e,t,r)=>{"use strict";r.d(t,{V:()=>i});class i{static load(){const e=new Map([[0,()=>{}]]),t=new Map,r="data:text/javascript;base64,"+btoa('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'),n=new Worker(r);return n.addEventListener("message",(({data:r})=>{if(i.isCallNotification(r)){const{params:{timerId:i}}=r,n=e.get(i);if("number"==typeof n){const e=t.get(n);if(void 0===e||e!==i)throw new Error("The timer is in an undefined state.")}else{if(void 0===n)throw new Error("The timer is in an undefined state.");n(),e.delete(i)}}else{if(!i.isClearResponse(r)){const{error:{message:e}}=r;throw new Error(e)}{const{id:i}=r,n=t.get(i);if(void 0===n)throw new Error("The timer is in an undefined state.");t.delete(i),e.delete(n)}}})),{clearTimeout:r=>{const i=Math.random();t.set(i,r),e.set(r,i),n.postMessage({id:i,method:"clear",params:{timerId:r}})},setTimeout:(t,r)=>{const i=Math.random();return e.set(i,t),n.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:i}}),i}}}static loadWorkerTimers(){return()=>(null!==i.workerTimers||(i.workerTimers=i.load()),i.workerTimers)}static isCallNotification(e){return void 0!==e.method&&"call"===e.method}static isClearResponse(e){return null===e.error&&"number"==typeof e.id}}i.workerTimers=null,i.clearTimeout=e=>i.timers().clearTimeout(e),i.setTimeout=(e,t)=>i.timers().setTimeout(e,t),i.timers=i.loadWorkerTimers()},6402:(e,t,r)=>{"use strict";r.d(t,{rU:()=>I});class i{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){const t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;const r=2*t.length,i=new ArrayBuffer(r),n=new DataView(i);return this.floatTo16BitPCM(n,0,t),i}setString(e,t,r){for(let i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))}floatTo16BitPCM(e,t,r){for(let i=0;i<r.length;i++,t+=2){const n=Math.max(-1,Math.min(1,r[i]));e.setInt16(t,n<0?32768*n:32767*n,!0)}}downSampleAudioFrame(e,t,r){if(!e)return null;if(r===t||r>t)return e;const i=t/r,n=Math.round(e.length/i),o=new Float32Array(n);let s=0,a=0;for(;a<n;){const t=Math.round((a+1)*i);let r=0,n=0;for(;s<t&&s<e.length;)r+=e[s++],n++;o[a++]=r/n}return o}}class n{constructor(e){this.privStopInputOnRelease=e}record(e,t,r){const n=new i(e.sampleRate,16e3),o=e.createMediaStreamSource(t),s=()=>{const i=(()=>{let t=0;try{return e.createScriptProcessor(t,1,1)}catch(r){t=2048;let i=e.sampleRate;for(;t<16384&&i>=32e3;)t<<=1,i>>=1;return e.createScriptProcessor(t,1,1)}})();i.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(r&&!r.isClosed){const e=n.encode(t);e&&r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},o.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:o,stream:t}};if(e.audioWorklet){if(!this.privSpeechProcessorScript){const e=new Blob(["class SP extends AudioWorkletProcessor {\n                    constructor(options) {\n                      super(options);\n                    }\n                    process(inputs, outputs) {\n                      const input = inputs[0];\n                      const output = [];\n                      for (let channel = 0; channel < input.length; channel += 1) {\n                        output[channel] = input[channel];\n                      }\n                      this.port.postMessage(output[0]);\n                      return true;\n                    }\n                  }\n                  registerProcessor('speech-processor', SP);"],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(e)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{const i=new AudioWorkletNode(e,"speech-processor");i.port.onmessage=e=>{const t=e.data;if(r&&!r.isClosed){const e=n.encode(t);e&&r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},o.connect(i),i.connect(e.destination),this.privMediaResources={scriptProcessorNode:i,source:o,stream:t}})).catch((()=>{s()}))}else try{s()}catch(e){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${e}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach((e=>e.stop())),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}}var o=r(4435),s=r(7626),a=r(249),c=r(4588),p=r(2148),h=r(6168),u=r(3114),d=r(4746),v=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class l{constructor(e,t,r,i){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=l.AUDIOFORMAT.avgBytesPerSec/10,this.privId=r||(0,s.Q)(),this.privEvents=new a.n,this.privMediaStream=i||null,this.privIsClosing=!1}get format(){return Promise.resolve(l.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new c.BH;try{this.createAudioContext()}catch(e){if(e instanceof Error){const t=e;this.privInitializeDeferral.reject(t.name+": "+t.message)}else this.privInitializeDeferral.reject(e);return this.privInitializeDeferral.promise}const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,r,i)=>{e.mediaDevices.getUserMedia(t).then(r).catch(i)}),t){const e=()=>{this.onEvent(new p.QZ(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new p.Jl(this.privId)),this.privInitializeDeferral.resolve()):t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},(e=>{this.privMediaStream=e,this.onEvent(new p.Jl(this.privId)),this.privInitializeDeferral.resolve()}),(e=>{const t=`Error occurred during microphone initialization: ${e}`;this.privInitializeDeferral.reject(t),this.onEvent(new p.n0(this.privId,t))}))};"suspended"===this.privContext.state?this.privContext.resume().then(e).catch((e=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${e}`)})):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new p.n0(e,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new p.i5(this.privId,e)),this.listen(e).then((t=>(this.onEvent(new p.sQ(this.privId,e)),{detach:()=>v(this,void 0,void 0,(function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new p.He(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()})))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new p.He(this.privId,e)))}turnOff(){return v(this,void 0,void 0,(function*(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}this.onEvent(new p.ls(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()}))}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then((e=>({bitspersample:l.AUDIOFORMAT.bitsPerSample,channelcount:l.AUDIOFORMAT.channels,connectivity:o.wF.Unknown,manufacturer:"Speech SDK",model:e,samplerate:l.AUDIOFORMAT.samplesPerSec,type:o.dt.Microphones})))}setProperty(e,t){if("MICROPHONE-WorkletSourceUrl"!==e)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){const e="microphone";if(void 0!==this.privMicrophoneLabel)return Promise.resolve(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;const t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return Promise.resolve(this.privMicrophoneLabel);const r=new c.BH;return navigator.mediaDevices.enumerateDevices().then((e=>{for(const r of e)if(r.deviceId===t){this.privMicrophoneLabel=r.label;break}r.resolve(this.privMicrophoneLabel)}),(()=>r.resolve(this.privMicrophoneLabel))),r.promise}listen(e){return v(this,void 0,void 0,(function*(){yield this.turnOn();const t=new h.L(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(t){throw this.onEvent(new p.hA(this.privId,e,t)),t}return t}))}onEvent(e){this.privEvents.onEvent(e),u.z.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=d.Bm.getAudioContext(l.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return v(this,void 0,void 0,(function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):null!==this.privContext&&"running"===this.privContext.state&&(yield this.privContext.suspend())}))}}l.AUDIOFORMAT=d.HT.getDefaultInputFormat();var f=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class g{constructor(e,t,r){this.privStreams={},this.privHeaderEnd=44,this.privId=r||(0,s.Q)(),this.privEvents=new a.n,this.privSource=e,"undefined"!=typeof window&&"undefined"!=typeof Blob&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new p.n0(e,"")),Promise.reject(e)}this.onEvent(new p.QZ(this.privId)),this.onEvent(new p.Jl(this.privId))}id(){return this.privId}attach(e){return f(this,void 0,void 0,(function*(){this.onEvent(new p.i5(this.privId,e));const t=yield this.upload(e);return this.onEvent(new p.sQ(this.privId,e)),Promise.resolve({detach:()=>f(this,void 0,void 0,(function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new p.He(this.privId,e)),yield this.turnOff()})),id:()=>e,read:()=>t.read()})}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new p.He(this.privId,e)))}turnOff(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new p.ls(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then((e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:o.wF.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:o.dt.File})))}readHeader(){const e=this.privSource.slice(0,4296),t=new c.BH,r=e=>{const r=new DataView(e),i=e=>String.fromCharCode(r.getUint8(e),r.getUint8(e+1),r.getUint8(e+2),r.getUint8(e+3));if("RIFF"!==i(0))return void t.reject("Invalid WAV header in file, RIFF was not found");if("WAVE"!==i(8)||"fmt "!==i(12))return void t.reject("Invalid WAV header in file, WAVEfmt was not found");const n=r.getInt32(16,!0),o=r.getUint16(22,!0),s=r.getUint32(24,!0),a=r.getUint16(34,!0);let c=36+Math.max(n-16,0);for(;"data"!==i(c);c+=2)if(c>4288)return void t.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=c+8,t.resolve(d.HT.getWaveFormatPCM(s,a,o))};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&e instanceof Blob){const t=new FileReader;t.onload=e=>{const t=e.target.result;r(t)},t.readAsArrayBuffer(e)}else{const t=e;r(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength))}return t.promise}upload(e){return f(this,void 0,void 0,(function*(){const t=t=>{const r=`Error occurred while processing '${this.privFilename}'. ${t}`;throw this.onEvent(new p.hA(this.privId,e,r)),new Error(r)};try{yield this.turnOn();const r=yield this.privAudioFormatPromise,i=new h.L(r.avgBytesPerSec/10,e);this.privStreams[e]=i;const n=this.privSource.slice(this.privHeaderEnd),o=e=>{i.isClosed||(i.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),i.close())};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&n instanceof Blob){const e=new FileReader;e.onerror=e=>t(e.toString()),e.onload=e=>{const t=e.target.result;o(t)},e.readAsArrayBuffer(n)}else{const e=n;o(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}return i}catch(e){t(e)}}))}onEvent(e){this.privEvents.onEvent(e),u.z.instance.onEvent(e)}}var m=r(5282),y=r(8857),S=r(1389),C=r(2505),w=r(9542),R=r(5857),P=r(2651);class I{static fromDefaultMicrophoneInput(){const e=new n(!0);return new b(new l(e))}static fromMicrophoneInput(e){const t=new n(!0);return new b(new l(t,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new b(new g(e,t))}static fromStreamInput(e){if(e instanceof y.W)return new b(new S.fB(e));if(e instanceof S.yk)return new b(e);if("undefined"!=typeof MediaStream&&e instanceof MediaStream){const t=new n(!1);return new b(new l(t,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new T(new C.K)}static fromSpeakerOutput(e){if(void 0===e)return I.fromDefaultSpeakerOutput();if(e instanceof C.K)return new T(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new T(new P.O(e))}static fromStreamOutput(e){if(e instanceof w.y)return new T(new R.KS(e));if(e instanceof R.XO)return new T(e);if(e instanceof R.Ao)return new T(e);throw new Error("Not Supported Type")}}class b extends I{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then((()=>{e&&e()}),(e=>{t&&t(e)}))}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(m.a.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class T extends I{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}},2651:(e,t,r)=>{"use strict";r.d(t,{O:()=>o});var i=r(592),n=r(5282);class o{constructor(e){n.a.throwIfNullOrUndefined(i.openSync,"\nFile System access not available, please use Push or PullAudioOutputStream"),this.privFd=i.openSync(e,"w")}set format(e){n.a.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=i.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){n.a.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",(()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),i.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),i.closeSync(this.privFd),this.privFd=void 0})),this.privWriteStream.end())}id(){return this.privId}}},1389:(e,t,r)=>{"use strict";r.d(t,{ZT:()=>d,fB:()=>f,kv:()=>l,yk:()=>u});var i=r(4435),n=r(249),o=r(6168),s=r(2148),a=r(3114),c=r(7626),p=r(4746),h=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class u{constructor(){}static createPushStream(e){return d.create(e)}static createPullStream(e,t){return l.create(e,t)}}class d extends u{static create(e){return new v(e)}}class v extends d{constructor(e){super(),this.privFormat=void 0===e?p.Bm.getDefaultInputFormat():e,this.privEvents=new n.n,this.privId=(0,c.Q)(),this.privStream=new o.L(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new s.QZ(this.privId)),this.onEvent(new s.Jl(this.privId))}attach(e){return h(this,void 0,void 0,(function*(){this.onEvent(new s.i5(this.privId,e)),yield this.turnOn();const t=this.privStream;return this.onEvent(new s.sQ(this.privId,e)),{detach:()=>h(this,void 0,void 0,(function*(){return this.onEvent(new s.He(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()}}))}detach(e){this.onEvent(new s.He(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:i.wF.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:i.dt.Stream})}onEvent(e){this.privEvents.onEvent(e),a.z.instance.onEvent(e)}toBuffer(e){const t=Buffer.alloc(e.byteLength),r=new Uint8Array(e);for(let e=0;e<t.length;++e)t[e]=r[e];return t}}class l extends u{constructor(){super()}static create(e,t){return new f(e,t)}}class f extends l{constructor(e,t){super(),this.privFormat=void 0===t?p.HT.getDefaultInputFormat():t,this.privEvents=new n.n,this.privId=(0,c.Q)(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new s.QZ(this.privId)),this.onEvent(new s.Jl(this.privId))}attach(e){return h(this,void 0,void 0,(function*(){return this.onEvent(new s.i5(this.privId,e)),yield this.turnOn(),this.onEvent(new s.sQ(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new s.He(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let e,t=0;for(;t<this.privBufferSize;){const r=new ArrayBuffer(this.privBufferSize-t),i=this.privCallback.read(r);if(void 0===e?e=r:new Int8Array(e).set(new Int8Array(r),t),0===i)break;t+=i}return Promise.resolve({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}}))}detach(e){this.onEvent(new s.He(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:i.wF.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:i.dt.Stream})}onEvent(e){this.privEvents.onEvent(e),a.z.instance.onEvent(e)}}},7455:(e,t,r)=>{"use strict";r.d(t,{d:()=>o});var i=r(8735),n=r(4746);class o extends n.Bm{constructor(e,t,r,i,n,o,s,a,c){super(r,o,t,e),this.formatTag=e,this.avgBytesPerSec=i,this.blockAlign=n,this.priAudioFormatString=s,this.priRequestAudioFormatString=a,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return void 0===e?o.getDefaultOutputFormat():o.fromSpeechSynthesisOutputFormatString(o.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new o(n.WY.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new o(n.WY.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new o(n.WY.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new o(n.WY.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new o(n.WY.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new o(n.WY.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new o(n.WY.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new o(n.WY.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new o(n.WY.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new o(n.WY.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new o(n.WY.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new o(n.WY.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new o(n.WY.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new o(n.WY.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new o(n.WY.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new o(n.WY.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new o(n.WY.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new o(n.WY.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new o(n.WY.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new o(n.WY.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new o(n.WY.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new o(n.WY.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new o(n.WY.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new o(n.WY.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new o(n.WY.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new o(n.WY.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new o(n.WY.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new o(n.WY.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new o(n.WY.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new o(n.WY.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new o(n.WY.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new o(n.WY.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new o(n.WY.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new o(n.WY.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new o(n.WY.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new o(n.WY.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new o(n.WY.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new o(n.WY.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);default:return new o(n.WY.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return o.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){const t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}}o.SpeechSynthesisOutputFormatToString={[i.Y.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[i.Y.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[i.Y.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[i.Y.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[i.Y.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[i.Y.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[i.Y.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[i.Y.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[i.Y.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[i.Y.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[i.Y.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[i.Y.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[i.Y.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[i.Y.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[i.Y.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[i.Y.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[i.Y.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[i.Y.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[i.Y.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[i.Y.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[i.Y.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[i.Y.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[i.Y.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[i.Y.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[i.Y.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[i.Y.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[i.Y.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[i.Y.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[i.Y.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[i.Y.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[i.Y.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[i.Y.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[i.Y.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[i.Y.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[i.Y.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[i.Y.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[i.Y.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"}},5857:(e,t,r)=>{"use strict";r.d(t,{Ao:()=>c,J4:()=>a,KS:()=>u,NO:()=>p,XO:()=>h});var i=r(7626),n=r(1359),o=r(5282),s=r(7455);class a{constructor(){}static createPullStream(){return c.create()}}class c extends a{static create(){return new p}}class p extends c{constructor(){super(),this.privId=(0,i.Q)(),this.privStream=new n.F}set format(e){null==e&&(this.privFormat=s.d.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return t=this,r=void 0,n=function*(){const t=new Int8Array(e);let r=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),r=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;r<e.byteLength&&!this.privStream.isReadEnded;){const i=yield this.privStream.read();if(void 0===i||i.isEnd)this.privStream.readEnded();else{let n;i.buffer.byteLength>e.byteLength-r?(n=i.buffer.slice(0,e.byteLength-r),this.privLastChunkView=new Int8Array(i.buffer.slice(e.byteLength-r))):n=i.buffer,t.set(new Int8Array(n),r),r+=n.byteLength}}return r},new((i=void 0)||(i=Promise))((function(e,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}c((n=n.apply(t,r||[])).next())}));var t,r,i,n}write(e){o.a.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class h extends a{constructor(){super()}static create(e){return new u(e)}}class u extends h{constructor(e){super(),this.privId=(0,i.Q)(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}},4746:(e,t,r)=>{"use strict";var i;r.d(t,{Bm:()=>o,HT:()=>n,WY:()=>i}),function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.OGG_OPUS=6]="OGG_OPUS",e[e.WEBM_OPUS=7]="WEBM_OPUS",e[e.ALaw=8]="ALaw",e[e.FLAC=9]="FLAC",e[e.OPUS=10]="OPUS"}(i||(i={}));class n{static getDefaultInputFormat(){return o.getDefaultInputFormat()}static getWaveFormat(e,t,r,i){return new o(e,t,r,i)}static getWaveFormatPCM(e,t,r){return new o(e,t,r)}}class o extends n{constructor(e=16e3,t=16,r=1,n=i.PCM){super();let o=!0;switch(n){case i.PCM:this.formatTag=1;break;case i.ALaw:this.formatTag=6;break;case i.MuLaw:this.formatTag=7;break;default:o=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=r,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),o){this.privHeader=new ArrayBuffer(44);const e=new DataView(this.privHeader);this.setString(e,0,"RIFF"),e.setUint32(4,0,!0),this.setString(e,8,"WAVEfmt "),e.setUint32(16,16,!0),e.setUint16(20,this.formatTag,!0),e.setUint16(22,this.channels,!0),e.setUint32(24,this.samplesPerSec,!0),e.setUint32(28,this.avgBytesPerSec,!0),e.setUint16(32,this.channels*(this.bitsPerSample/8),!0),e.setUint16(34,this.bitsPerSample,!0),this.setString(e,36,"data"),e.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new o}static getAudioContext(e){const t=window.AudioContext||window.webkitAudioContext||!1;if(t)return void 0!==e&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,r){for(let i=0;i<r.length;i++)e.setUint8(t+i,r.charCodeAt(i))}}},8857:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});class i{}},9542:(e,t,r)=>{"use strict";r.d(t,{y:()=>i});class i{}},2505:(e,t,r)=>{"use strict";r.d(t,{K:()=>u});var i=r(8985),n=r(7626),o=r(3114),s=r(6898),a=r(5857),c=r(4746),p=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};const h={[c.WY.PCM]:"audio/wav",[c.WY.MuLaw]:"audio/x-wav",[c.WY.MP3]:"audio/mpeg",[c.WY.OGG_OPUS]:"audio/ogg",[c.WY.WEBM_OPUS]:"audio/webm; codecs=opus",[c.WY.ALaw]:"audio/x-wav",[c.WY.FLAC]:"audio/flac"};class u{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||(0,n.Q)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,r){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then((()=>{t&&t()}),(e=>{r&&r(e)}))):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd().then((()=>{e&&e()}),(e=>{t&&t(e)}));else if(void 0!==this.privAudioOutputStream&&"undefined"!=typeof window)if(this.privFormat.formatTag!==c.WY.PCM&&this.privFormat.formatTag!==c.WY.MuLaw&&this.privFormat.formatTag!==c.WY.ALaw||!1!==this.privFormat.hasHeader){let r=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(r).then((()=>{r=i.E.addHeader(r,this.privFormat);const n=new Blob([r],{type:h[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(n),this.notifyPlayback().then((()=>{e&&e()}),(e=>{t&&t(e)}))}),(e=>{t&&t(e)}))}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if("undefined"!=typeof AudioContext||"undefined"!=typeof window&&void 0!==window.webkitAudioContext){this.privFormat=e;const t=h[this.privFormat.formatTag];void 0===t?console.warn(`Unknown mimeType for format ${c.WY[this.privFormat.formatTag]}; playback is not supported.`):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch((e=>{o.z.instance.onEvent(new s.u(e))}))},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch((e=>{o.z.instance.onEvent(new s.u(e))}))},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch((e=>{o.z.instance.onEvent(new s.u(e))}))):(console.warn(`Format ${c.WY[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new a.NO,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var e,t;return null!==(t=null===(e=this.privAudio)||void 0===e?void 0:e.volume)&&void 0!==t?t:-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return p(this,void 0,void 0,(function*(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch(t){return this.privAudioBuffer.unshift(e),void console.log("buffer filled, pausing addition of binaries until space is made")}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())}))}handleSourceBufferUpdateEnd(){return p(this,void 0,void 0,(function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())}))}notifyPlayback(){return p(this,void 0,void 0,(function*(){this.privPlaybackStarted||void 0===this.privAudio||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))}))}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}},3198:(e,t,r)=>{"use strict";var i;r.d(t,{E:()=>i}),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"}(i||(i={}))},7875:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var i=r(7602);class n extends i.J{constructor(e,t,r,i,n){super(i,n),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=r}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}},8328:(e,t,r)=>{"use strict";var i;r.d(t,{_:()=>i}),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(i||(i={}))},5282:(e,t,r)=>{"use strict";r.d(t,{a:()=>i});class i{static throwIfNullOrUndefined(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfNullOrTooLong(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length>r)throw new Error("throwIfNullOrTooLong:"+t+" (more than "+r.toString()+" characters)")}static throwIfNullOrTooShort(e,t,r){if(i.throwIfNullOrUndefined(e,t),(""+e).length<r)throw new Error("throwIfNullOrTooShort:"+t+" (less than "+r.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(i.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const r of e)i.throwIfNullOrWhitespace(r,t)}static throwIfFileDoesNotExist(e,t){i.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)}}},1002:(e,t,r)=>{"use strict";var i;r.d(t,{W:()=>i}),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(i||(i={}))},4122:(e,t,r)=>{"use strict";var i;r.d(t,{P:()=>i}),function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(i||(i={}))},2935:(e,t,r)=>{"use strict";r.d(t,{O:()=>n});var i=r(6845);class n{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let r;r="string"==typeof e?e:i.o[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return this.privValues[e];if(void 0!==t)return String(t)}setProperty(e,t){let r;r="string"==typeof e?e:i.o[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===r)return void(this.privValues[e]=t);this.privKeys.push(r),this.privValues.push(t)}clone(){const e=new n;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach((t=>{if(void 0===e.getProperty(t,void 0)){const r=this.getProperty(t);e.setProperty(t,r)}}))}get keys(){return this.privKeys}}},6845:(e,t,r)=>{"use strict";var i;r.d(t,{o:()=>i}),function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceConnection_SpeakerIdMode=36]="SpeechServiceConnection_SpeakerIdMode",e[e.SpeechServiceResponse_ProfanityOption=37]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=38]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=39]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=40]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=41]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=42]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=43]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=44]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=45]="SpeechServiceResponse_RequestSentenceBoundary",e[e.Conversation_ApplicationId=46]="Conversation_ApplicationId",e[e.Conversation_DialogType=47]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=48]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=49]="Conversation_From_Id",e[e.Conversation_Conversation_Id=50]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=51]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=52]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=53]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=54]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=55]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=56]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=57]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=58]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=59]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=60]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=61]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=62]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=63]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=64]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=65]="PronunciationAssessment_Params",e[e.SpeakerRecognition_Api_Version=66]="SpeakerRecognition_Api_Version"}(i||(i={}))},7602:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});var i=r(1610);class n extends i.${constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}},1984:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});class i{constructor(e,t,r,i,n,o,s,a,c,p){this.privResultId=e,this.privReason=t,this.privText=r,this.privDuration=i,this.privOffset=n,this.privLanguage=o,this.privLanguageDetectionConfidence=s,this.privErrorDetails=a,this.privJson=c,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}},8123:(e,t,r)=>{"use strict";r.d(t,{c:()=>d});var i=r(149),n=r(4435),o=r(9253),s=r(9228),a=r(4588),c=r(5282),p=r(6402),h=r(6845),u=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class d{constructor(e,t,r){this.audioConfig=void 0!==e?e:p.rU.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=r,this.implCommonRecognizerSetup()}close(e,t){c.a.throwIfDisposed(this.privDisposed),(0,a.Kb)(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return u(this,void 0,void 0,(function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))}))}static get telemetryEnabled(){return i.q.telemetryDataEnabled}static enableTelemetry(e){i.q.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",r="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,r=navigator.appVersion);const i=this.createRecognizerConfig(new n.pu(new n._y(new n.OS(e,t,r))));this.privReco=this.createServiceRecognizer(d.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,i)}recognizeOnceAsyncImpl(e){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed);const t=new a.BH;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);const r=yield t.promise;return yield this.implRecognizerStop(),r}))}startContinuousRecognitionAsyncImpl(e){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)}))}stopContinuousRecognitionAsyncImpl(){return u(this,void 0,void 0,(function*(){c.a.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()}))}implRecognizerStop(){return u(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}static getAuthFromProperties(e){const t=e.getProperty(h.o.SpeechServiceConnection_Key,void 0);return t&&""!==t?new o.U(t):new s.w((()=>{const t=e.getProperty(h.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}),(()=>{const t=e.getProperty(h.o.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}))}}},2543:(e,t,r)=>{"use strict";var i;r.d(t,{s:()=>i}),function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile",e[e.VoicesListRetrieved=18]="VoicesListRetrieved"}(i||(i={}))},1610:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});class i{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}},7395:(e,t,r)=>{"use strict";r.d(t,{c:()=>h,z:()=>u});var i=r(4484),n=r(5282),o=r(6845),s=r(2935),a=r(1002),c=r(4122),p=r(8735);class h{constructor(){}static fromSubscription(e,t){n.a.throwIfNullOrWhitespace(e,"subscriptionKey"),n.a.throwIfNullOrWhitespace(t,"region");const r=new u;return r.setProperty(o.o.SpeechServiceConnection_Region,t),r.setProperty(o.o.SpeechServiceConnection_IntentRegion,t),r.setProperty(o.o.SpeechServiceConnection_Key,e),r}static fromEndpoint(e,t){n.a.throwIfNull(e,"endpoint");const r=new u;return r.setProperty(o.o.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&r.setProperty(o.o.SpeechServiceConnection_Key,t),r}static fromHost(e,t){n.a.throwIfNull(e,"hostName");const r=new u;return r.setProperty(o.o.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&r.setProperty(o.o.SpeechServiceConnection_Key,t),r}static fromAuthorizationToken(e,t){n.a.throwIfNull(e,"authorizationToken"),n.a.throwIfNullOrWhitespace(t,"region");const r=new u;return r.setProperty(o.o.SpeechServiceConnection_Region,t),r.setProperty(o.o.SpeechServiceConnection_IntentRegion,t),r.authorizationToken=e,r}close(){}}class u extends h{constructor(){super(),this.privProperties=new s.O,this.speechRecognitionLanguage="en-US",this.outputFormat=a.W.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(o.o.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(o.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(o.o.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return a.W[this.privProperties.getProperty(i.OutputFormatPropertyName,void 0)]}set outputFormat(e){this.privProperties.setProperty(i.OutputFormatPropertyName,a.W[e])}get endpointId(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){n.a.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,r,i){this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyHostName],e),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyPort],t),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyUserName],r),this.setProperty(o.o[o.o.SpeechServiceConnection_ProxyPassword],i)}setServiceProperty(e,t){const r=JSON.parse(this.privProperties.getProperty(i.ServicePropertiesPropertyName,"{}"));r[e]=t,this.privProperties.setProperty(i.ServicePropertiesPropertyName,JSON.stringify(r))}setProfanity(e){this.privProperties.setProperty(o.o.SpeechServiceResponse_ProfanityOption,c.P[e])}enableAudioLogging(){this.privProperties.setProperty(o.o.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(o.o.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(i.ForceDictationPropertyName,"true")}clone(){const e=new u;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(o.o.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return p.Y[this.privProperties.getProperty(o.o.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(o.o.SpeechServiceConnection_SynthOutputFormat,p.Y[e])}}},5809:(e,t,r)=>{"use strict";r.d(t,{n:()=>n});var i=r(7875);class n extends i.w{}},2855:(e,t,r)=>{"use strict";r.d(t,{d:()=>o,m:()=>n});var i=r(7602);class n extends i.J{constructor(e,t,r){super(t,r),this.privResult=e}get result(){return this.privResult}}class o extends n{}},7263:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});var i=r(1984);class n extends i.p{constructor(e,t,r,i,n,o,s,a,c,p,h){super(e,t,r,i,n,o,s,c,p,h),this.privSpeakerId=a}get speakerId(){return this.privSpeakerId}}},1277:(e,t,r)=>{"use strict";r.d(t,{F:()=>x});var i=r(6081),n=r(6976),o=r(4484),s=r(6845),a=r(1002),c=r(872),p=r(4435),h=r(9957),u=r(4004),d=r(5587);class v extends c._{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,r){let v=e.parameters.getProperty(s.o.SpeechServiceConnection_Endpoint,void 0);const l=e.parameters.getProperty(s.o.SpeechServiceConnection_Region,void 0),f=c._.getHostSuffix(l),g=e.parameters.getProperty(s.o.SpeechServiceConnection_Host,"wss://"+l+".stt.speech"+f),m={},y=e.parameters.getProperty(s.o.SpeechServiceConnection_EndpointId,void 0),S=e.parameters.getProperty(s.o.SpeechServiceConnection_RecoLanguage,void 0);if(y?v&&-1!==v.search(d.o.CustomSpeechDeploymentId)||(m[d.o.CustomSpeechDeploymentId]=y):S&&(v&&-1!==v.search(d.o.Language)||(m[d.o.Language]=S)),v&&-1!==v.search(d.o.Format)||(m[d.o.Format]=e.parameters.getProperty(o.OutputFormatPropertyName,a.W[a.W.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(m[d.o.EnableLanguageId]="true"),this.setCommonUrlParams(e,m,v),!v)switch(e.recognitionMode){case p.jf.Conversation:v="true"===e.parameters.getProperty(o.ForceDictationPropertyName,"false")?g+this.dictationRelativeUri:void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${g}${this.universalUri}${e.recognitionEndpointVersion}`:g+this.conversationRelativeUri;break;case p.jf.Dictation:v=g+this.dictationRelativeUri;break;default:v=void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${g}${this.universalUri}${e.recognitionEndpointVersion}`:g+this.interactiveRelativeUri}const C={};void 0!==t.token&&""!==t.token&&(C[t.headerName]=t.token),C[u.S.ConnectionId]=r;const w="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),R=new i.i(v,m,C,new h.D,n.i.fromRecognizerConfig(e),w,r),P=R.uri;return e.parameters.setProperty(s.o.SpeechServiceConnection_Url,P),R}}var l=r(2935),f=r(7263),g=r(2543),m=r(2855),y=r(3198),S=r(5809),C=r(149),w=r(1089),R=r(2642),P=r(7569),I=r(1508),b=r(414);class T extends C.q{constructor(e,t,r,i,n){super(e,t,r,i,n),this.privSpeechRecognizer=n}processTypeSpecificMessages(e){return t=this,r=void 0,n=function*(){let t;const r=new l.O;r.setProperty(s.o.SpeechServiceResponse_JsonResult,e.textBody);let i=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const n=w.r.fromJSON(e.textBody),s=n.Offset+this.privRequestSession.currentTurnAudioOffset;t=new f.b(this.privRequestSession.requestId,g.s.RecognizingSpeech,n.Text,n.Duration,s,n.Language,n.LanguageDetectionConfidence,void 0,void 0,e.textBody,r),this.privRequestSession.onHypothesis(s);const c=new m.m(t,n.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch(e){}i=!0;break;case"speech.phrase":const p=R.n.fromJSON(e.textBody),h=P.o.implTranslateRecognitionResult(p.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+p.Offset+p.Duration),g.s.Canceled===h){const e=P.o.implTranslateCancelResult(p.RecognitionStatus),t=P.o.implTranslateCancelErrorCode(p.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,P.o.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||h!==g.s.NoMatch||p.RecognitionStatus===I.T.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(o.OutputFormatPropertyName)===a.W[a.W.Simple])t=new f.b(this.privRequestSession.requestId,h,p.DisplayText,p.Duration,p.Offset+this.privRequestSession.currentTurnAudioOffset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,e.textBody,r);else{const i=b.u.fromJSON(e.textBody),n=i.Offset+this.privRequestSession.currentTurnAudioOffset,o=i.getJsonWithCorrectedOffsets(n);t=new f.b(this.privRequestSession.requestId,h,i.RecognitionStatus===I.T.Success?i.NBest[0].Display:void 0,i.Duration,n,i.Language,i.LanguageDetectionConfidence,void 0,void 0,o,r)}const i=new m.m(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,i)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0}return i},new((i=void 0)||(i=Promise))((function(e,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,a)}c((n=n.apply(t,r||[])).next())}));var t,r,i,n}cancelRecognition(e,t,r,i,n){const s=new l.O;if(s.setProperty(o.CancellationErrorCodePropertyName,y.E[i]),this.privSpeechRecognizer.canceled){const t=new S.n(r,n,i,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new f.b(t,g.s.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,s);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}var E=r(4588),A=r(5282),k=r(8123);class x extends k.c{constructor(e,t){const r=e;A.a.throwIfNull(r,"speechConfig"),A.a.throwIfNullOrWhitespace(r.properties.getProperty(s.o.SpeechServiceConnection_RecoLanguage),s.o[s.o.SpeechServiceConnection_RecoLanguage]),super(t,r.properties,new v),this.privDisposedRecognizer=!1}static FromConfig(e,t,r){const i=e;return t.properties.mergeTo(i.properties),new x(e,r)}get endpointId(){return A.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.o.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(s.o.SpeechServiceAuthorization_Token)}set authorizationToken(e){A.a.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(s.o.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return A.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.o.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return A.a.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(o.OutputFormatPropertyName,a.W[a.W.Simple])===a.W[a.W.Simple]?a.W.Simple:a.W.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){(0,E.Kb)(this.recognizeOnceAsyncImpl(p.jf.Interactive),e,t)}startContinuousRecognitionAsync(e,t){(0,E.Kb)(this.startContinuousRecognitionAsyncImpl(p.jf.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){(0,E.Kb)(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,r){A.a.throwIfNull(e,"model"),r&&r("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){A.a.throwIfDisposed(this.privDisposedRecognizer),(0,E.Kb)(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return r=this,i=void 0,o=function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,a)}c((o=o.apply(r,i||[])).next())}));var r,i,n,o}createRecognizerConfig(e){return new p.Xj(e,this.privProperties)}createServiceRecognizer(e,t,r,i){return new T(e,t,r,i,this)}}},6256:(e,t,r)=>{"use strict";r.d(t,{i:()=>i});class i{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}},9448:(e,t,r)=>{"use strict";r.d(t,{c:()=>i});class i{constructor(e){this.privResult=e}get result(){return this.privResult}}},8735:(e,t,r)=>{"use strict";var i;r.d(t,{Y:()=>i}),function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"}(i||(i={}))},6675:(e,t,r)=>{"use strict";r.d(t,{P:()=>n});var i=r(9402);class n extends i.A{constructor(e,t,r,i,n,o){super(e,t,i,n),this.privAudioData=r,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}},7587:(e,t,r)=>{"use strict";r.d(t,{w:()=>i});class i{constructor(e,t,r){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=r}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}},6127:(e,t,r)=>{"use strict";r.d(t,{G:()=>i});class i{constructor(e,t,r,i,n,o){this.privAudioOffset=e,this.privDuration=t,this.privText=r,this.privWordLength=i,this.privTextOffset=n,this.privBoundaryType=o}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}},9402:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});class i{constructor(e,t,r,i){this.privResultId=e,this.privReason=t,this.privErrorDetails=r,this.privProperties=i}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}},5905:(e,t,r)=>{const i=r(7778),n=r(6747);e.exports=class{mediaRecorder;stream;__data;async start(e={audio:!0,video:!1}){if("recording"===this.mediaRecorder?.state)return!0;const t=e||{audio:!0,video:!1};try{this.stream=await navigator.mediaDevices.getUserMedia(t),this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.ondataavailable=e=>this.__data=e.data}catch(e){return console.error(e),!1}return this.mediaRecorder?.start(),!0}stop(){if("recording"!==this.mediaRecorder?.state)return!0;this.mediaRecorder.stop(),this.mediaRecorder.onstop=()=>{this.stream.getTracks().forEach((e=>e.stop())),this.mediaRecorder=void 0,this.stream=void 0}}async download(e=null,t=!1,r=void 0){if(this.__data)return await n(this.__data,t,e,r)}async getBlob(e=!1,t=void 0){if(this.__data)return await i(this.__data,e,t)}}},6747:(e,t,r)=>{const i=r(7778);e.exports=async function(e,t,r=null,n=void 0){const o=await i(e,t,n),s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=r||`recording('${t?"32bit":"16bit"}).wav`,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}},6190:(e,t,r)=>{r(5905),e.exports.getWaveBlob=r(7778),r(6747)},7778:e=>{function t(e,t,r){for(let i=0;i<e.length;++i)t[r+i]=e.charCodeAt(i)}function r(e,t,r){e=Math.floor(e),t[r+0]=255&e,t[r+1]=e>>8&255}function i(e,t,r){e=Math.floor(e),t[r+0]=255&e,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255}function n(e){const t=new ArrayBuffer(4);return new Float32Array(t)[0]=e,0|new Uint32Array(t)[0]}e.exports=async function(e,o,s=void 0){const a=await async function(e,t){let r=e;r instanceof Blob||(r=new Blob([e]));const i=URL.createObjectURL(r),n=await fetch(i),o=await n.arrayBuffer(),s=new AudioContext(t);return await s.decodeAudioData(o)}(e,s),c=a.length,p=a.numberOfChannels,h=a.sampleRate,u=o?32:16,d=h*p*u/8,v=p*u/8,l=c*p*(u/8),f=new Uint8Array(44+l),g=l,m=28+(8+g);return t("RIFF",f,0),i(m,f,4),t("WAVE",f,8),t("fmt ",f,12),i(16,f,16),r(o?3:1,f,20),r(p,f,22),i(h,f,24),i(d,f,28),r(v,f,32),i(u,f,34),t("data",f,36),i(g,f,40),function(e,t,o,s){let a=0,c=0;const p=e.length,h=e.numberOfChannels;let u,d;for(a=0;a<p;++a)for(c=0;c<h;++c)if(u=e.getChannelData(c),16===s)d=32768*u[a],d<-32768?d=-32768:d>32767&&(d=32767),r(d,t,o),o+=2;else{if(32!==s)return void console.log("Invalid bit depth for PCM encoding.");d=n(u[a]),i(d,t,o),o+=4}}(a,f,44,u),new Blob([f],{type:"audio/wave"})}},9681:(e,t,r)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===i(o)?o:String(o)),n)}var o}r.d(t,{Z:()=>o});const o=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state="init",this.start=t,this.stop=r}var t,r;return t=e,(r=[{key:"toInit",value:function(){switch(this.state){case"init":return!0;case"rec":case"shot":return this.stop()?(this.state="init",!0):(this.state="err",!1);default:return this.state="err",!1}}},{key:"toTrans",value:function(){return"init"===this.state&&this.start()?(this.state="trans",!0):(this.state="err",!1)}},{key:"toRec",value:function(){return"trans"===this.state?(this.state="rec",!0):(this.state="err",!1)}},{key:"toShot",value:function(){return"trans"===this.state?(this.state="shot",!0):(this.state="err",!1)}},{key:"isRecording",value:function(){switch(this.state){case"init":case"err":return!1;case"trans":case"rec":case"shot":return!0}}},{key:"isErr",value:function(){return"err"==this.state}},{key:"reset",value:function(){this.state="init"}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},5655:(e,t,r)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===i(o)?o:String(o)),n)}var o}r.d(t,{Z:()=>o});const o=function(){function e(t,r,i,n){var o=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:500;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.button=t,this.thTime=s,this.isDown=!1,this.downTime=0,this.isTouch=!1;var a=function(e){e.preventDefault(),o.isDown||(o.isDown=!0,o.downTime=(new Date).getTime(),r(),setTimeout((function(){o.isLongDown()&&i()}),o.thTime))},c=function(e){e.preventDefault(),o.isDown&&(o.isDown=!1,n())};void 0===t.ontouchstart?(t.onmousedown=a,t.onmouseup=c):(t.ontouchstart=a,t.ontouchend=c)}var t,r;return t=e,(r=[{key:"isShortDown",value:function(){return!!this.isDown&&(new Date).getTime()-this.downTime<this.thTime}},{key:"isLongDown",value:function(){return!!this.isDown&&(new Date).getTime()-this.downTime>=this.thTime}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()},2175:(e,t,r)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function n(){n=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var n=t&&t.prototype instanceof l?t:l,s=Object.create(n.prototype),a=new E(i||[]);return o(s,"_invoke",{value:P(e,r,a)}),s}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var v={};function l(){}function f(){}function g(){}var m={};h(m,a,(function(){return this}));var y=Object.getPrototypeOf,S=y&&y(y(A([])));S&&S!==t&&r.call(S,a)&&(m=S);var C=g.prototype=l.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(o,s,a,c){var p=d(e[o],e,s);if("throw"!==p.type){var h=p.arg,u=h.value;return u&&"object"==i(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(u).then((function(e){h.value=e,a(h)}),(function(e){return n("throw",e,a,c)}))}c(p.arg)}var s;o(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return s=s?s.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===v)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=d(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var n=d(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=g,o(C,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:f,configurable:!0}),f.displayName=h(g,p,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,h(e,p,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},w(R.prototype),h(R.prototype,c,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new R(u(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(C),h(C,p,"Generator"),h(C,a,(function(){return this})),h(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),v}},e}function o(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var s=e.apply(t,r);function a(e){o(s,i,n,a,c,"next",e)}function c(e){o(s,i,n,a,c,"throw",e)}a(void 0)}))}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===i(o)?o:String(o)),n)}var o}function c(e){var t="function"==typeof Map?new Map:void 0;return c=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return p(e,arguments,d(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u(i,e)},c(e)}function p(e,t,r){return p=h()?Reflect.construct.bind():function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&u(n,r.prototype),n},p.apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function v(e){return new Promise((function(t,r){e.onsuccess=function(e){return t(e.target.transaction)},e.onerror=r}))}r.d(t,{Z:()=>N});var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(S,e);var t,r,o,c,p,v,l,f,g,m,y=(g=S,m=h(),function(){var e,t=d(g);if(m){var r=d(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function S(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),(r=y.call(this)).name=e,r.version=t,r.db=null,r}return t=S,r=[{key:"ready",value:function(){return!(null===this.db)}},{key:"destroy",value:function(){if(!S.available())throw new Error("IndexedDB is not available");window.indexedDB.deleteDatabase(this.name)}},{key:"connect",value:(f=s(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){S.available()||i(new Error("IndexedDB is not available"));var n=window.indexedDB.open(r.name,r.version);n.onupgradeneeded=function(e){var r=e.target.result,i=e.target.transaction;t.migrate(e.oldVersion,e.newVersion,r,i)},n.onsuccess=function(t){var i=t.target.result;r.db=i,e(i)},n.onerror=i})));case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"add",value:(l=s(n().mark((function e(t,r){var i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o=i.db.transaction(t,"readwrite").objectStore(t).add(r);o.onsuccess=function(t){t.stopPropagation(),e(t)},o.onerror=function(e){e.stopPropagation(),n(e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return l.apply(this,arguments)})},{key:"get",value:(v=s(n().mark((function e(t,r){var i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o=i.db.transaction(t,"readwrite").objectStore(t).get(r);o.onsuccess=function(t){t.stopPropagation(),e(o.result)},o.onerror=function(e){e.stopPropagation(),n(e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"getAll",value:(p=s(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var n=r.db.transaction(t,"readwrite").objectStore(t).getAll();n.onsuccess=function(t){t.stopPropagation(),e(n.result)},n.onerror=function(e){e.stopPropagation(),i(e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"delete",value:(c=s(n().mark((function e(t,r){var i=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o=i.db.transaction(t,"readwrite").objectStore(t).delete(r);o.onsuccess=function(t){t.stopPropagation(),e(t)},o.onerror=function(e){e.stopPropagation(),n(e)}})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return c.apply(this,arguments)})}],o=[{key:"available",value:function(){return!(void 0===window.indexedDB)}}],r&&a(t.prototype,r),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),S}(c(EventTarget));const f=l;function g(){g=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),a=new E(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var u={};function d(){}function v(){}function l(){}var f={};c(f,o,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(A([])));y&&y!==t&&r.call(y,o)&&(f=y);var S=l.prototype=d.prototype=Object.create(f);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var p=c.arg,u=p.value;return u&&"object"==C(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=h(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=h(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return v.prototype=l,i(S,"constructor",{value:l,configurable:!0}),i(l,"constructor",{value:v,configurable:!0}),v.displayName=c(l,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,c(e,a,"GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},w(R.prototype),c(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new R(p(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(S),c(S,a,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function S(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==C(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===C(n)?n:String(n)),i)}var n}function P(e,t,r){return t&&R(e.prototype,t),r&&R(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var I=function(){function e(){w(this,e),this.map={}}return P(e,[{key:"add",value:function(e,t,r){this.map[e]=this.map[e]||{},this.map[e][t]=r}},{key:"trace",value:function(e,t){for(var r=[{ps:[e],vs:[]}];r.length>0;){var i=r.shift(),n=i.ps,o=i.vs,s=n.slice(-1)[0];for(var a in this.map[s]){var c=this.map[s][a];if(a==t)return o.concat([c]);n.includes(a)||r.push({ps:n.concat([a]),vs:o.concat([c])})}}return null}}]),e}();function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function T(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,A(i.key),i)}}function E(e,t,r){return(t=A(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===b(t)?t:String(t)}function k(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function O(){O=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,s=Object.create(o.prototype),a=new T(n||[]);return i(s,"_invoke",{value:w(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var u={};function d(){}function v(){}function l(){}var f={};c(f,o,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(E([])));m&&m!==t&&r.call(m,o)&&(f=m);var y=l.prototype=d.prototype=Object.create(f);function S(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var p=c.arg,u=p.value;return u&&"object"==b(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function w(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=R(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=h(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function R(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,R(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=h(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:A}}function A(){return{value:void 0,done:!0}}return v.prototype=l,i(y,"constructor",{value:l,configurable:!0}),i(l,"constructor",{value:v,configurable:!0}),v.displayName=c(l,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,c(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},S(C.prototype),c(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new C(p(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=E,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;I(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function D(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(e){D(o,i,n,s,a,"next",e)}function a(e){D(o,i,n,s,a,"throw",e)}s(void 0)}))}}var z=new(function(){function e(){w(this,e),this.updates=new I}var t,r;return P(e,[{key:"add",value:function(e,t,r){this.updates.add(e,t,(function(i,n){return console.log("Migrating from ".concat(e," to ").concat(t,".")),r(i,n)}))}},{key:"migrate",value:(t=g().mark((function e(t,r,i,n){var o,s,a,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(o=this.updates.trace(t,r))){e.next=3;break}throw new Error("Migration path is not found: from ".concat(t," to ").concat(r,"."));case 3:s=m(o),e.prev=4,s.s();case 6:if((a=s.n()).done){e.next=13;break}return c=a.value,e.next=10,c(i,n);case 10:n=e.sent;case 11:e.next=6;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),s.e(e.t0);case 18:return e.prev=18,s.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,this,[[4,15,18,21]])})),r=function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function s(e){S(o,i,n,s,a,"next",e)}function a(e){S(o,i,n,s,a,"throw",e)}s(void 0)}))},function(e,t,i,n){return r.apply(this,arguments)})}]),e}());z.add(0,1,function(){var e=_(O().mark((function e(t,r){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.createObjectStore("records",{autoIncrement:!0}),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),z.add(1,2,function(){var e=_(O().mark((function e(t,r){var i,n,o,s,a,c,p,h;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.objectStore("records").getAll(),e.next=3,v(i);case 3:r=e.sent,n=i.result,t.deleteObjectStore("records"),t.createObjectStore("records",{autoIncrement:!0}),o=[],s=k(n);try{for(s.s();!(a=s.n()).done;)c=a.value,p={blob:c,script:null},i=r.objectStore("records").add(p),o.push(v(i))}catch(e){s.e(e)}finally{s.f()}return e.next=12,Promise.all(o);case 12:return(h=e.sent).push(r),e.abrupt("return",h[0]);case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),z.add(0,2,function(){var e=_(O().mark((function e(t,r){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.createObjectStore("records",{autoIncrement:!0}),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var L=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.db=new f(e.name,e.version)}var t,r,i,n,o,s,a;return t=e,r=[{key:"connect",value:(a=_(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.db.connect(z);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"get",value:(s=_(O().mark((function t(r){return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.get(e.store,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(e){return s.apply(this,arguments)})},{key:"list",value:(o=_(O().mark((function t(){return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.getAll(e.store);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"save",value:(n=_(O().mark((function t(r){return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.add(e.store,r);case 2:case"end":return t.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"delete",value:(i=_(O().mark((function t(r){return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.db.delete(e.store,r);case 2:case"end":return t.stop()}}),t,this)}))),function(e){return i.apply(this,arguments)})}],r&&T(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();E(L,"name","BouncyDB"),E(L,"version",2),E(L,"store","records");const N=L},7927:(e,t,r)=>{"use strict";r.d(t,{Z:()=>S});var i=r(7395),n=r(6402),o=r(1277),s=r(1406),a=r.n(s);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==c(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===c(n)?n:String(n)),i)}var n}const u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t}var t,r,i;return t=e,i=[{key:"available",value:function(){return!(void 0===localStorage)}}],(r=[{key:"store",value:function(e,t){var r=[e,t],i=a().AES.encrypt(JSON.stringify(r),t).toString();localStorage.setItem(this.key,i)}},{key:"load",value:function(e){var t,r,i=localStorage.getItem(this.key),n=a().AES.decrypt(i,e);try{var o=(t=JSON.parse(n.toString(a().enc.Utf8)),r=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o,s,a=[],c=!0,p=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(i=o.call(r)).done)&&(a.push(i.value),a.length!==t);c=!0);}catch(e){p=!0,n=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(p)throw n}}return a}}(t,r)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=o[0];return e==o[1]?s:null}catch(e){return null}}},{key:"login",value:function(e){return!!this.load(e)}},{key:"exists",value:function(){return!!localStorage.getItem(this.key)}}])&&h(t.prototype,r),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(){v=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var o=t&&t.prototype instanceof l?t:l,s=Object.create(o.prototype),a=new E(n||[]);return i(s,"_invoke",{value:P(e,r,a)}),s}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=p;var u={};function l(){}function f(){}function g(){}var m={};c(m,o,(function(){return this}));var y=Object.getPrototypeOf,S=y&&y(y(A([])));S&&S!==t&&r.call(S,o)&&(m=S);var C=g.prototype=l.prototype=Object.create(m);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(i,o,s,a){var c=h(e[i],e,o);if("throw"!==c.type){var p=c.arg,u=p.value;return u&&"object"==d(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function P(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var s=r.delegate;if(s){var a=I(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var c=h(e,t,r);if("normal"===c.type){if(i=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,i=e.iterator[r];if(void 0===i)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=h(i,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=g,i(C,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:f,configurable:!0}),f.displayName=c(g,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},w(R.prototype),c(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var s=new R(p(t,r,i,n),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(C),c(C,a,"Generator"),c(C,o,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;T(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function l(e,t,r,i,n,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function f(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(void 0,n=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,"string");if("object"!==d(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(i.key),"symbol"===d(n)?n:String(n)),i)}var n}var g,m,y=r(1682);const S=(g=void 0,m=void 0,function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.credential_key=new u("key"),this.credential_region=new u("region")}var t,r,s,a;return t=e,r=[{key:"init",value:function(){var e=this.credential_key.load(g),t=this.credential_region.load(g);(m=i.c.fromSubscription(e,t)).speechRecognitionLanguage="ja-JP"}},{key:"ready",value:function(){return!!m}},{key:"signup",value:function(e,t,r){this.credential_key.store(e,r),this.credential_region.store(t,r),g=r,this.init()}},{key:"logout",value:function(){g=void 0,m=void 0}},{key:"login",value:function(e){return!!this.credential_key.login(e)&&!!this.credential_region.login(e)&&(g=e,this.init(),!0)}},{key:"loggedin",value:function(){return!!g&&this.login(g)}},{key:"exists",value:function(){return!!this.credential_key.exists()&&!!this.credential_region.exists()}},{key:"recognize",value:(s=v().mark((function e(t){var r,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ready()){e.next=2;break}return e.abrupt("return",null);case 2:return r=n.rU.fromWavFileInput(t),i=new o.F(m,r),e.abrupt("return",new Promise((function(e,t){i.recognizeOnceAsync((function(r){switch(r.reason){case y.ResultReason.RecognizedSpeech:e(r.text);break;case y.ResultReason.NoMatch:console.log("NOMATCH: Speech could not be recognized."),t(r);break;case y.ResultReason.Canceled:var n=y.CancellationDetails.fromResult(r);console.log("CANCELED: Reason=".concat(n.reason)),n.reason==y.CancellationReason.Error&&(console.log("CANCELED: ErrorCode=".concat(n.ErrorCode)),console.log("CANCELED: ErrorDetails=".concat(n.errorDetails)),console.log("CANCELED: Did you set the speech resource key and region values?")),t(r)}i.close()}))})));case 5:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,i){var n=s.apply(e,t);function o(e){l(n,r,i,o,a,"next",e)}function a(e){l(n,r,i,o,a,"throw",e)}o(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"debug",value:function(){if(!this.loggedin())return null;this.credential_key.load(g),this.credential_region.load(g)}}],r&&f(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}())},7039:()=>{},2480:()=>{},3108:()=>{},3034:()=>{},9847:()=>{},146:()=>{},173:()=>{},1137:()=>{},592:()=>{}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return s[e].call(r.exports,r,r.exports,c),r.exports}c.m=s,e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",i=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},c.a=(n,o,s)=>{var a;s&&((a=[]).d=1);var c,p,h,u=new Set,d=n.exports,v=new Promise(((e,t)=>{h=t,p=e}));v[t]=d,v[e]=e=>(a&&e(a),u.forEach(e),v.catch((e=>{}))),n.exports=v,o((n=>{var o;c=(n=>n.map((n=>{if(null!==n&&"object"==typeof n){if(n[e])return n;if(n.then){var o=[];o.d=0,n.then((e=>{s[t]=e,i(o)}),(e=>{s[r]=e,i(o)}));var s={};return s[e]=e=>e(o),s}}var a={};return a[e]=e=>{},a[t]=n,a})))(n);var s=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),p=new Promise((t=>{(o=()=>t(s)).r=0;var r=e=>e!==a&&!u.has(e)&&(u.add(e),e&&!e.d&&(o.r++,e.push(o)));c.map((t=>t[e](r)))}));return o.r?p:s()}),(e=>(e?h(v[r]=e):p(d),i(a)))),a&&(a.d=0)},c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,r)=>(c.f[r](e,t),t)),[])),c.u=e=>e+".js",c.miniCssF=e=>{},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o="my-webpack-project:",c.l=(e,t,r,i)=>{if(n[e])n[e].push(t);else{var s,a;if(void 0!==r)for(var p=document.getElementsByTagName("script"),h=0;h<p.length;h++){var u=p[h];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+r){s=u;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.setAttribute("data-webpack",o+r),s.src=e),n[e]=[t];var d=(t,r)=>{s.onerror=s.onload=null,clearTimeout(v);var i=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(r))),t)return t(r)},v=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),a&&document.head.appendChild(s)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;c.g.importScripts&&(e=c.g.location+"");var t=c.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&!e;)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=e})(),(()=>{var e={179:0};c.f.j=(t,r)=>{var i=c.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var n=new Promise(((r,n)=>i=e[t]=[r,n]));r.push(i[2]=n);var o=c.p+c.u(t),s=new Error;c.l(o,(r=>{if(c.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var n=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+n+": "+o+")",s.name="ChunkLoadError",s.type=n,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,n,[o,s,a]=r,p=0;if(o.some((t=>0!==e[t]))){for(i in s)c.o(s,i)&&(c.m[i]=s[i]);a&&a(c)}for(t&&t(r);p<o.length;p++)n=o[p],c.o(e,n)&&e[n]&&e[n][0](),e[n]=0},r=self.webpackChunkmy_webpack_project=self.webpackChunkmy_webpack_project||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),c(1045),c(7039)})();